[01;32msrijans@abzuser-virtual-machine[00m:[01;34m~[00m$ ls
[0m[01;34menv[0m  examples.desktop  screenlog.0
[01;32msrijans@abzuser-virtual-machine[00m:[01;34m~[00m$ . env/bin/activate
(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~[00m$ mv screenlog.0 .train/
(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~[00m$ c [Kd .train/
(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~/.train[00m$ ls
CHANGELOG.md     Dockerfile  README.md         [0m[01;34mconfig[0m  [01;34mdocs[0m       floyd_requirements.txt                    [01;34monmt[0m           requirements.opt.txt  screenlog.0  setup.py  [01;34mtools[0m     [01;34mtransformer_model[0m
CONTRIBUTING.md  LICENSE.md  [01;34mavailable_models[0m  [01;34mdata[0m    floyd.yml  github_deploy_key_opennmt_opennmt_py.enc  [01;32mpreprocess.py[0m  requirements.txt      [01;32mserver.py[0m    [01;34mtemp[0m      [01;32mtrain.py[0m  [01;32mtranslate.py[0m
(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~/.train[00m$ ls ../
[0m[01;34menv[0m  examples.desktop  screenlog.0
(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~/.train[00m$ python  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -word_vec_size 512 -transformer_ff 2048 -heads 8          -encode r_type transformer -decoder_type transformer -position_encoding         -train_steps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -acc um_count 2         -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot         -label_smoothing 0.1 -valid_step s 10000 -save_checkpoint_steps 10000         -world_size 1 -gpu_ranks 0  -valid_batch_size 16[1P[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[K[K8
[2019-09-08 08:29:03,044 INFO]  * src vocab size = 50002
[2019-09-08 08:29:03,044 INFO]  * tgt vocab size = 50004
[2019-09-08 08:29:03,044 INFO] Building model...
[2019-09-08 08:29:09,016 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(50002, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(50004, 512, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=512, out_features=512, bias=True)
          (linear_values): Linear(in_features=512, out_features=512, bias=True)
          (linear_query): Linear(in_features=512, out_features=512, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=512, out_features=512, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=512, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=512, bias=True)
          (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=512, out_features=50004, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-09-08 08:29:09,019 INFO] encoder: 44516352
[2019-09-08 08:29:09,019 INFO] decoder: 76479316
[2019-09-08 08:29:09,019 INFO] * number of parameters: 120995668
[2019-09-08 08:29:09,022 INFO] Starting training on GPU: [0]
[2019-09-08 08:29:09,022 INFO] Start training loop and validate every 10000 steps...
[2019-09-08 08:29:09,023 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 08:29:22,650 INFO] number of examples: 947346
[2019-09-08 08:30:13,788 INFO] Step 50/10000000; acc:   0.00; ppl: 12233.02; xent: 9.41; lr: 0.00000; 2443/2715 tok/s;     65 sec
[2019-09-08 08:31:01,692 INFO] Step 100/10000000; acc:   0.00; ppl: 11963.03; xent: 9.39; lr: 0.00000; 3269/3717 tok/s;    113 sec
[2019-09-08 08:31:50,130 INFO] Step 150/10000000; acc:   1.58; ppl: 11453.16; xent: 9.35; lr: 0.00000; 3415/3675 tok/s;    161 sec
[2019-09-08 08:32:38,559 INFO] Step 200/10000000; acc:   7.39; ppl: 10756.61; xent: 9.28; lr: 0.00000; 3207/3747 tok/s;    210 sec
[2019-09-08 08:33:26,696 INFO] Step 250/10000000; acc:   8.06; ppl: 10105.91; xent: 9.22; lr: 0.00000; 3212/3738 tok/s;    258 sec
[2019-09-08 08:34:15,654 INFO] Step 300/10000000; acc:   6.54; ppl: 9669.43; xent: 9.18; lr: 0.00000; 3355/3698 tok/s;    307 sec
[2019-09-08 08:35:03,415 INFO] Step 350/10000000; acc:   7.15; ppl: 9125.83; xent: 9.12; lr: 0.00000; 3351/3729 tok/s;    354 sec
[2019-09-08 08:35:50,657 INFO] Step 400/10000000; acc:   9.61; ppl: 8347.64; xent: 9.03; lr: 0.00000; 3299/3706 tok/s;    402 sec
[2019-09-08 08:36:39,712 INFO] Step 450/10000000; acc:   7.09; ppl: 8251.28; xent: 9.02; lr: 0.00000; 3292/3793 tok/s;    451 sec
[2019-09-08 08:37:27,587 INFO] Step 500/10000000; acc:   9.37; ppl: 7565.27; xent: 8.93; lr: 0.00000; 3157/3762 tok/s;    499 sec
[2019-09-08 08:38:15,241 INFO] Step 550/10000000; acc:   8.93; ppl: 7193.23; xent: 8.88; lr: 0.00000; 3264/3710 tok/s;    546 sec
[2019-09-08 08:39:04,147 INFO] Step 600/10000000; acc:   7.67; ppl: 6982.50; xent: 8.85; lr: 0.00000; 3147/3752 tok/s;    595 sec
[2019-09-08 08:39:52,486 INFO] Step 650/10000000; acc:   7.03; ppl: 6665.26; xent: 8.80; lr: 0.00000; 3131/3757 tok/s;    643 sec
[2019-09-08 08:40:40,948 INFO] Step 700/10000000; acc:   7.59; ppl: 6152.32; xent: 8.72; lr: 0.00000; 3259/3749 tok/s;    692 sec
[2019-09-08 08:41:28,947 INFO] Step 750/10000000; acc:   7.80; ppl: 5712.02; xent: 8.65; lr: 0.00000; 3311/3733 tok/s;    740 sec
[2019-09-08 08:42:17,367 INFO] Step 800/10000000; acc:   6.80; ppl: 5452.61; xent: 8.60; lr: 0.00000; 3314/3722 tok/s;    788 sec
[2019-09-08 08:43:05,496 INFO] Step 850/10000000; acc:   7.13; ppl: 5026.88; xent: 8.52; lr: 0.00000; 3228/3821 tok/s;    836 sec
[2019-09-08 08:43:54,204 INFO] Step 900/10000000; acc:   6.82; ppl: 4655.73; xent: 8.45; lr: 0.00000; 3338/3696 tok/s;    885 sec
[2019-09-08 08:44:42,565 INFO] Step 950/10000000; acc:   7.77; ppl: 4182.48; xent: 8.34; lr: 0.00000; 3211/3735 tok/s;    934 sec
[2019-09-08 08:45:30,256 INFO] Step 1000/10000000; acc:   7.18; ppl: 3912.48; xent: 8.27; lr: 0.00000; 3301/3694 tok/s;    981 sec
[2019-09-08 08:45:32,683 INFO] Saving checkpoint ./transformer_model_step_1000.pt
[2019-09-08 08:46:24,113 INFO] Step 1050/10000000; acc:   8.20; ppl: 3529.15; xent: 8.17; lr: 0.00000; 2923/3312 tok/s;   1035 sec
[2019-09-08 08:47:11,517 INFO] Step 1100/10000000; acc:   8.12; ppl: 3190.46; xent: 8.07; lr: 0.00000; 3319/3747 tok/s;   1082 sec
[2019-09-08 08:48:00,007 INFO] Step 1150/10000000; acc:   7.72; ppl: 2952.67; xent: 7.99; lr: 0.00000; 3245/3732 tok/s;   1131 sec
[2019-09-08 08:48:51,463 INFO] Step 1200/10000000; acc:   6.23; ppl: 2735.36; xent: 7.91; lr: 0.00000; 3121/3577 tok/s;   1182 sec
[2019-09-08 08:49:39,850 INFO] Step 1250/10000000; acc:   8.29; ppl: 2402.62; xent: 7.78; lr: 0.00000; 3182/3759 tok/s;   1231 sec
[2019-09-08 08:50:27,659 INFO] Step 1300/10000000; acc:   8.13; ppl: 2180.85; xent: 7.69; lr: 0.00001; 3278/3733 tok/s;   1279 sec
[2019-09-08 08:51:16,318 INFO] Step 1350/10000000; acc:   7.50; ppl: 1994.42; xent: 7.60; lr: 0.00001; 3221/3725 tok/s;   1327 sec
[2019-09-08 08:52:04,468 INFO] Step 1400/10000000; acc:   7.12; ppl: 1827.69; xent: 7.51; lr: 0.00001; 3380/3718 tok/s;   1375 sec
[2019-09-08 08:52:52,610 INFO] Step 1450/10000000; acc:   7.33; ppl: 1669.09; xent: 7.42; lr: 0.00001; 3373/3761 tok/s;   1424 sec
[2019-09-08 08:53:40,614 INFO] Step 1500/10000000; acc:   8.15; ppl: 1498.27; xent: 7.31; lr: 0.00001; 3135/3777 tok/s;   1472 sec
[2019-09-08 08:54:28,645 INFO] Step 1550/10000000; acc:   8.06; ppl: 1353.27; xent: 7.21; lr: 0.00001; 3323/3748 tok/s;   1520 sec
[2019-09-08 08:55:17,149 INFO] Step 1600/10000000; acc:   6.98; ppl: 1261.35; xent: 7.14; lr: 0.00001; 3351/3735 tok/s;   1568 sec
[2019-09-08 08:56:05,720 INFO] Step 1650/10000000; acc:   7.40; ppl: 1145.56; xent: 7.04; lr: 0.00001; 3236/3767 tok/s;   1617 sec
[2019-09-08 08:56:53,269 INFO] Step 1700/10000000; acc:   7.92; ppl: 1080.06; xent: 6.98; lr: 0.00001; 3330/3740 tok/s;   1664 sec
[2019-09-08 08:57:39,530 INFO] Step 1750/10000000; acc:  10.46; ppl: 919.19; xent: 6.82; lr: 0.00001; 3274/3621 tok/s;   1711 sec
[2019-09-08 08:58:28,555 INFO] Step 1800/10000000; acc:   7.19; ppl: 890.45; xent: 6.79; lr: 0.00001; 3227/3742 tok/s;   1760 sec
[2019-09-08 08:59:17,887 INFO] Step 1850/10000000; acc:   6.54; ppl: 838.45; xent: 6.73; lr: 0.00001; 3272/3695 tok/s;   1809 sec
[2019-09-08 09:00:05,755 INFO] Step 1900/10000000; acc:   8.36; ppl: 764.34; xent: 6.64; lr: 0.00001; 3294/3678 tok/s;   1857 sec
[2019-09-08 09:00:55,040 INFO] Step 1950/10000000; acc:   6.66; ppl: 739.00; xent: 6.61; lr: 0.00001; 3336/3666 tok/s;   1906 sec
[2019-09-08 09:01:43,473 INFO] Step 2000/10000000; acc:   8.15; ppl: 655.83; xent: 6.49; lr: 0.00001; 3198/3686 tok/s;   1954 sec
[2019-09-08 09:01:46,204 INFO] Saving checkpoint ./transformer_model_step_2000.pt
[2019-09-08 09:02:38,071 INFO] Step 2050/10000000; acc:   6.67; ppl: 656.09; xent: 6.49; lr: 0.00001; 2814/3254 tok/s;   2009 sec
[2019-09-08 09:03:25,651 INFO] Step 2100/10000000; acc:   8.49; ppl: 609.93; xent: 6.41; lr: 0.00001; 3250/3681 tok/s;   2057 sec
[2019-09-08 09:04:13,338 INFO] Step 2150/10000000; acc:   8.99; ppl: 571.07; xent: 6.35; lr: 0.00001; 3255/3833 tok/s;   2104 sec
[2019-09-08 09:05:00,806 INFO] Step 2200/10000000; acc:   7.78; ppl: 571.05; xent: 6.35; lr: 0.00001; 3327/3668 tok/s;   2152 sec
[2019-09-08 09:05:48,816 INFO] Step 2250/10000000; acc:   9.09; ppl: 517.83; xent: 6.25; lr: 0.00001; 3258/3750 tok/s;   2200 sec
[2019-09-08 09:06:36,964 INFO] Step 2300/10000000; acc:   7.49; ppl: 516.60; xent: 6.25; lr: 0.00001; 3228/3759 tok/s;   2248 sec
[2019-09-08 09:07:26,612 INFO] Step 2350/10000000; acc:   8.42; ppl: 518.18; xent: 6.25; lr: 0.00001; 3145/3670 tok/s;   2298 sec
[2019-09-08 09:08:14,576 INFO] Step 2400/10000000; acc:   9.14; ppl: 499.41; xent: 6.21; lr: 0.00001; 3359/3733 tok/s;   2346 sec
[2019-09-08 09:09:02,892 INFO] Step 2450/10000000; acc:   8.72; ppl: 499.12; xent: 6.21; lr: 0.00001; 3299/3715 tok/s;   2394 sec
[2019-09-08 09:09:50,680 INFO] Step 2500/10000000; acc:  10.52; ppl: 478.34; xent: 6.17; lr: 0.00001; 3328/3750 tok/s;   2442 sec
[2019-09-08 09:10:39,602 INFO] Step 2550/10000000; acc:  10.11; ppl: 462.50; xent: 6.14; lr: 0.00001; 3163/3733 tok/s;   2491 sec
[2019-09-08 09:11:26,860 INFO] Step 2600/10000000; acc:  11.72; ppl: 441.74; xent: 6.09; lr: 0.00001; 3333/3747 tok/s;   2538 sec
[2019-09-08 09:12:14,551 INFO] Step 2650/10000000; acc:  11.80; ppl: 447.27; xent: 6.10; lr: 0.00001; 3236/3739 tok/s;   2586 sec
[2019-09-08 09:13:02,276 INFO] Step 2700/10000000; acc:  10.04; ppl: 465.47; xent: 6.14; lr: 0.00001; 3308/3629 tok/s;   2633 sec
[2019-09-08 09:13:51,082 INFO] Step 2750/10000000; acc:  10.20; ppl: 456.58; xent: 6.12; lr: 0.00001; 3258/3744 tok/s;   2682 sec
[2019-09-08 09:14:39,063 INFO] Step 2800/10000000; acc:  11.64; ppl: 423.14; xent: 6.05; lr: 0.00001; 3344/3733 tok/s;   2730 sec
[2019-09-08 09:15:28,196 INFO] Step 2850/10000000; acc:  10.29; ppl: 448.14; xent: 6.11; lr: 0.00001; 3133/3736 tok/s;   2779 sec
[2019-09-08 09:16:17,601 INFO] Step 2900/10000000; acc:  10.68; ppl: 431.37; xent: 6.07; lr: 0.00001; 3159/3723 tok/s;   2829 sec
[2019-09-08 09:17:05,603 INFO] Step 2950/10000000; acc:  12.25; ppl: 393.73; xent: 5.98; lr: 0.00001; 3223/3810 tok/s;   2877 sec
[2019-09-08 09:17:53,433 INFO] Step 3000/10000000; acc:  10.73; ppl: 432.12; xent: 6.07; lr: 0.00001; 3186/3702 tok/s;   2924 sec
[2019-09-08 09:17:56,391 INFO] Saving checkpoint ./transformer_model_step_3000.pt
[2019-09-08 09:18:48,003 INFO] Step 3050/10000000; acc:  11.87; ppl: 401.43; xent: 6.00; lr: 0.00001; 2869/3325 tok/s;   2979 sec
[2019-09-08 09:19:35,893 INFO] Step 3100/10000000; acc:  11.63; ppl: 392.70; xent: 5.97; lr: 0.00001; 3398/3671 tok/s;   3027 sec
[2019-09-08 09:20:24,602 INFO] Step 3150/10000000; acc:  12.17; ppl: 376.51; xent: 5.93; lr: 0.00001; 3254/3724 tok/s;   3076 sec
[2019-09-08 09:21:13,249 INFO] Step 3200/10000000; acc:  11.84; ppl: 373.73; xent: 5.92; lr: 0.00001; 3187/3758 tok/s;   3124 sec
[2019-09-08 09:22:01,535 INFO] Step 3250/10000000; acc:  11.58; ppl: 378.35; xent: 5.94; lr: 0.00001; 3241/3771 tok/s;   3173 sec
[2019-09-08 09:22:49,320 INFO] Step 3300/10000000; acc:  14.13; ppl: 338.35; xent: 5.82; lr: 0.00001; 3224/3658 tok/s;   3220 sec
[2019-09-08 09:23:37,597 INFO] Step 3350/10000000; acc:  12.35; ppl: 344.38; xent: 5.84; lr: 0.00001; 3316/3693 tok/s;   3269 sec
[2019-09-08 09:24:26,248 INFO] Step 3400/10000000; acc:  13.19; ppl: 334.20; xent: 5.81; lr: 0.00001; 3221/3702 tok/s;   3317 sec
[2019-09-08 09:24:43,186 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 09:24:58,865 INFO] number of examples: 805546
[2019-09-08 09:25:36,562 INFO] Step 3450/10000000; acc:  13.39; ppl: 371.59; xent: 5.92; lr: 0.00001; 2271/2597 tok/s;   3388 sec
[2019-09-08 09:26:24,993 INFO] Step 3500/10000000; acc:  16.66; ppl: 341.82; xent: 5.83; lr: 0.00001; 3261/3712 tok/s;   3436 sec
[2019-09-08 09:27:13,943 INFO] Step 3550/10000000; acc:  15.87; ppl: 335.99; xent: 5.82; lr: 0.00001; 3353/3745 tok/s;   3485 sec
[2019-09-08 09:28:03,554 INFO] Step 3600/10000000; acc:  15.00; ppl: 334.83; xent: 5.81; lr: 0.00001; 3268/3803 tok/s;   3535 sec
[2019-09-08 09:28:51,207 INFO] Step 3650/10000000; acc:  17.22; ppl: 288.72; xent: 5.67; lr: 0.00001; 3360/3760 tok/s;   3582 sec
[2019-09-08 09:29:39,240 INFO] Step 3700/10000000; acc:  16.79; ppl: 281.38; xent: 5.64; lr: 0.00001; 3382/3748 tok/s;   3630 sec
[2019-09-08 09:30:27,267 INFO] Step 3750/10000000; acc:  17.02; ppl: 285.03; xent: 5.65; lr: 0.00001; 3342/3749 tok/s;   3678 sec
[2019-09-08 09:31:16,043 INFO] Step 3800/10000000; acc:  18.24; ppl: 263.02; xent: 5.57; lr: 0.00001; 3275/3758 tok/s;   3727 sec
[2019-09-08 09:32:04,119 INFO] Step 3850/10000000; acc:  16.87; ppl: 270.81; xent: 5.60; lr: 0.00002; 3404/3765 tok/s;   3775 sec
[2019-09-08 09:32:52,114 INFO] Step 3900/10000000; acc:  20.19; ppl: 231.47; xent: 5.44; lr: 0.00002; 3202/3793 tok/s;   3823 sec
[2019-09-08 09:33:40,588 INFO] Step 3950/10000000; acc:  15.69; ppl: 278.37; xent: 5.63; lr: 0.00002; 3373/3747 tok/s;   3872 sec
[2019-09-08 09:34:29,110 INFO] Step 4000/10000000; acc:  17.47; ppl: 250.44; xent: 5.52; lr: 0.00002; 3446/3776 tok/s;   3920 sec
[2019-09-08 09:34:32,536 INFO] Saving checkpoint ./transformer_model_step_4000.pt
[2019-09-08 09:35:29,556 INFO] Step 4050/10000000; acc:  18.11; ppl: 241.67; xent: 5.49; lr: 0.00002; 2645/2952 tok/s;   3981 sec
[2019-09-08 09:36:18,334 INFO] Step 4100/10000000; acc:  18.19; ppl: 237.52; xent: 5.47; lr: 0.00002; 3335/3722 tok/s;   4029 sec
[2019-09-08 09:37:06,800 INFO] Step 4150/10000000; acc:  17.98; ppl: 225.74; xent: 5.42; lr: 0.00002; 3275/3780 tok/s;   4078 sec
[2019-09-08 09:37:55,877 INFO] Step 4200/10000000; acc:  16.31; ppl: 248.38; xent: 5.51; lr: 0.00002; 3334/3717 tok/s;   4127 sec
[2019-09-08 09:38:43,827 INFO] Step 4250/10000000; acc:  19.75; ppl: 207.35; xent: 5.33; lr: 0.00002; 3262/3694 tok/s;   4175 sec
[2019-09-08 09:39:32,112 INFO] Step 4300/10000000; acc:  19.26; ppl: 212.42; xent: 5.36; lr: 0.00002; 3255/3752 tok/s;   4223 sec
[2019-09-08 09:40:20,891 INFO] Step 4350/10000000; acc:  18.93; ppl: 212.61; xent: 5.36; lr: 0.00002; 3246/3789 tok/s;   4272 sec
[2019-09-08 09:41:09,502 INFO] Step 4400/10000000; acc:  18.10; ppl: 215.70; xent: 5.37; lr: 0.00002; 3283/3782 tok/s;   4320 sec
[2019-09-08 09:41:58,483 INFO] Step 4450/10000000; acc:  17.85; ppl: 225.11; xent: 5.42; lr: 0.00002; 3391/3728 tok/s;   4369 sec
[2019-09-08 09:42:47,152 INFO] Step 4500/10000000; acc:  17.56; ppl: 217.32; xent: 5.38; lr: 0.00002; 3375/3768 tok/s;   4418 sec
[2019-09-08 09:43:36,560 INFO] Step 4550/10000000; acc:  17.88; ppl: 210.27; xent: 5.35; lr: 0.00002; 3267/3737 tok/s;   4468 sec
[2019-09-08 09:44:27,350 INFO] Step 4600/10000000; acc:  18.39; ppl: 204.19; xent: 5.32; lr: 0.00002; 3155/3545 tok/s;   4518 sec
[2019-09-08 09:45:15,718 INFO] Step 4650/10000000; acc:  18.51; ppl: 196.64; xent: 5.28; lr: 0.00002; 3266/3760 tok/s;   4567 sec
[2019-09-08 09:46:04,502 INFO] Step 4700/10000000; acc:  17.70; ppl: 201.09; xent: 5.30; lr: 0.00002; 3324/3825 tok/s;   4615 sec
[2019-09-08 09:46:52,809 INFO] Step 4750/10000000; acc:  18.28; ppl: 200.87; xent: 5.30; lr: 0.00002; 3391/3695 tok/s;   4664 sec
[2019-09-08 09:47:39,901 INFO] Step 4800/10000000; acc:  21.51; ppl: 171.42; xent: 5.14; lr: 0.00002; 3275/3776 tok/s;   4711 sec
[2019-09-08 09:48:28,612 INFO] Step 4850/10000000; acc:  19.23; ppl: 189.26; xent: 5.24; lr: 0.00002; 3386/3722 tok/s;   4760 sec
[2019-09-08 09:49:17,381 INFO] Step 4900/10000000; acc:  18.69; ppl: 189.87; xent: 5.25; lr: 0.00002; 3343/3690 tok/s;   4808 sec
[2019-09-08 09:50:05,851 INFO] Step 4950/10000000; acc:  21.37; ppl: 170.11; xent: 5.14; lr: 0.00002; 3246/3744 tok/s;   4857 sec
[2019-09-08 09:50:54,383 INFO] Step 5000/10000000; acc:  18.80; ppl: 187.81; xent: 5.24; lr: 0.00002; 3413/3761 tok/s;   4905 sec
[2019-09-08 09:50:58,307 INFO] Saving checkpoint ./transformer_model_step_5000.pt
[2019-09-08 09:51:54,902 INFO] Step 5050/10000000; acc:  18.60; ppl: 178.10; xent: 5.18; lr: 0.00002; 2612/3024 tok/s;   4966 sec
[2019-09-08 09:52:44,028 INFO] Step 5100/10000000; acc:  18.10; ppl: 190.94; xent: 5.25; lr: 0.00002; 3422/3768 tok/s;   5015 sec
[2019-09-08 09:53:33,142 INFO] Step 5150/10000000; acc:  19.07; ppl: 180.91; xent: 5.20; lr: 0.00002; 3289/3837 tok/s;   5064 sec
[2019-09-08 09:54:22,335 INFO] Step 5200/10000000; acc:  18.14; ppl: 181.55; xent: 5.20; lr: 0.00002; 3303/3687 tok/s;   5113 sec
[2019-09-08 09:55:11,540 INFO] Step 5250/10000000; acc:  20.30; ppl: 165.50; xent: 5.11; lr: 0.00002; 3237/3767 tok/s;   5163 sec
[2019-09-08 09:56:00,734 INFO] Step 5300/10000000; acc:  19.08; ppl: 175.91; xent: 5.17; lr: 0.00002; 3279/3793 tok/s;   5212 sec
[2019-09-08 09:56:48,934 INFO] Step 5350/10000000; acc:  19.39; ppl: 174.53; xent: 5.16; lr: 0.00002; 3396/3727 tok/s;   5260 sec
[2019-09-08 09:57:37,960 INFO] Step 5400/10000000; acc:  19.56; ppl: 165.99; xent: 5.11; lr: 0.00002; 3170/3689 tok/s;   5309 sec
[2019-09-08 09:58:25,542 INFO] Step 5450/10000000; acc:  21.06; ppl: 160.32; xent: 5.08; lr: 0.00002; 3351/3654 tok/s;   5357 sec
[2019-09-08 09:59:14,244 INFO] Step 5500/10000000; acc:  20.30; ppl: 159.59; xent: 5.07; lr: 0.00002; 3236/3772 tok/s;   5405 sec
[2019-09-08 10:00:03,001 INFO] Step 5550/10000000; acc:  20.06; ppl: 162.27; xent: 5.09; lr: 0.00002; 3295/3730 tok/s;   5454 sec
[2019-09-08 10:00:50,469 INFO] Step 5600/10000000; acc:  21.45; ppl: 153.69; xent: 5.03; lr: 0.00002; 3377/3757 tok/s;   5501 sec
[2019-09-08 10:01:38,397 INFO] Step 5650/10000000; acc:  22.28; ppl: 145.41; xent: 4.98; lr: 0.00002; 3228/3790 tok/s;   5549 sec
[2019-09-08 10:02:26,857 INFO] Step 5700/10000000; acc:  20.09; ppl: 158.06; xent: 5.06; lr: 0.00002; 3293/3670 tok/s;   5598 sec
[2019-09-08 10:03:17,010 INFO] Step 5750/10000000; acc:  19.57; ppl: 160.96; xent: 5.08; lr: 0.00002; 3297/3732 tok/s;   5648 sec
[2019-09-08 10:04:05,540 INFO] Step 5800/10000000; acc:  21.37; ppl: 146.26; xent: 4.99; lr: 0.00002; 3264/3684 tok/s;   5697 sec
[2019-09-08 10:04:54,134 INFO] Step 5850/10000000; acc:  18.90; ppl: 160.28; xent: 5.08; lr: 0.00002; 3245/3667 tok/s;   5745 sec
[2019-09-08 10:05:42,205 INFO] Step 5900/10000000; acc:  22.86; ppl: 133.93; xent: 4.90; lr: 0.00002; 3216/3739 tok/s;   5793 sec
[2019-09-08 10:06:31,093 INFO] Step 5950/10000000; acc:  19.47; ppl: 160.13; xent: 5.08; lr: 0.00002; 3271/3625 tok/s;   5842 sec
[2019-09-08 10:07:20,992 INFO] Step 6000/10000000; acc:  18.65; ppl: 161.56; xent: 5.08; lr: 0.00002; 3341/3655 tok/s;   5892 sec
[2019-09-08 10:07:25,262 INFO] Saving checkpoint ./transformer_model_step_6000.pt
[2019-09-08 10:08:21,509 INFO] Step 6050/10000000; acc:  20.82; ppl: 144.20; xent: 4.97; lr: 0.00002; 2582/2999 tok/s;   5952 sec
[2019-09-08 10:09:09,676 INFO] Step 6100/10000000; acc:  21.07; ppl: 145.34; xent: 4.98; lr: 0.00002; 3258/3682 tok/s;   6001 sec
[2019-09-08 10:09:58,121 INFO] Step 6150/10000000; acc:  21.70; ppl: 141.19; xent: 4.95; lr: 0.00002; 3352/3647 tok/s;   6049 sec
[2019-09-08 10:10:46,995 INFO] Step 6200/10000000; acc:  22.61; ppl: 131.34; xent: 4.88; lr: 0.00002; 3110/3691 tok/s;   6098 sec
[2019-09-08 10:11:35,728 INFO] Step 6250/10000000; acc:  20.77; ppl: 143.22; xent: 4.96; lr: 0.00002; 3349/3704 tok/s;   6147 sec
[2019-09-08 10:12:25,064 INFO] Step 6300/10000000; acc:  20.87; ppl: 138.25; xent: 4.93; lr: 0.00002; 3215/3671 tok/s;   6196 sec
[2019-09-08 10:12:38,735 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 10:12:57,282 INFO] number of examples: 947346
[2019-09-08 10:13:36,836 INFO] Step 6350/10000000; acc:  19.01; ppl: 189.17; xent: 5.24; lr: 0.00002; 2168/2468 tok/s;   6268 sec
[2019-09-08 10:14:25,121 INFO] Step 6400/10000000; acc:  17.26; ppl: 206.34; xent: 5.33; lr: 0.00003; 3293/3705 tok/s;   6316 sec
[2019-09-08 10:15:13,301 INFO] Step 6450/10000000; acc:  18.16; ppl: 187.91; xent: 5.24; lr: 0.00003; 3324/3666 tok/s;   6364 sec
[2019-09-08 10:16:01,342 INFO] Step 6500/10000000; acc:  19.87; ppl: 170.37; xent: 5.14; lr: 0.00003; 3289/3715 tok/s;   6412 sec
[2019-09-08 10:16:50,417 INFO] Step 6550/10000000; acc:  18.43; ppl: 173.08; xent: 5.15; lr: 0.00003; 3175/3743 tok/s;   6461 sec
[2019-09-08 10:17:39,085 INFO] Step 6600/10000000; acc:  18.69; ppl: 165.54; xent: 5.11; lr: 0.00003; 3295/3698 tok/s;   6510 sec
[2019-09-08 10:18:27,514 INFO] Step 6650/10000000; acc:  18.14; ppl: 158.12; xent: 5.06; lr: 0.00003; 3425/3722 tok/s;   6558 sec
[2019-09-08 10:19:14,725 INFO] Step 6700/10000000; acc:  21.03; ppl: 144.23; xent: 4.97; lr: 0.00003; 3259/3667 tok/s;   6606 sec
[2019-09-08 10:20:03,373 INFO] Step 6750/10000000; acc:  20.38; ppl: 140.76; xent: 4.95; lr: 0.00003; 3303/3777 tok/s;   6654 sec
[2019-09-08 10:20:52,103 INFO] Step 6800/10000000; acc:  19.89; ppl: 146.05; xent: 4.98; lr: 0.00003; 3173/3749 tok/s;   6703 sec
[2019-09-08 10:21:39,630 INFO] Step 6850/10000000; acc:  21.55; ppl: 132.99; xent: 4.89; lr: 0.00003; 3209/3759 tok/s;   6751 sec
[2019-09-08 10:22:27,732 INFO] Step 6900/10000000; acc:  21.24; ppl: 132.98; xent: 4.89; lr: 0.00003; 3236/3703 tok/s;   6799 sec
[2019-09-08 10:23:16,983 INFO] Step 6950/10000000; acc:  19.02; ppl: 147.42; xent: 4.99; lr: 0.00003; 3043/3746 tok/s;   6848 sec
[2019-09-08 10:24:05,236 INFO] Step 7000/10000000; acc:  20.27; ppl: 126.94; xent: 4.84; lr: 0.00003; 3299/3780 tok/s;   6896 sec
[2019-09-08 10:24:09,625 INFO] Saving checkpoint ./transformer_model_step_7000.pt
[2019-09-08 10:25:06,238 INFO] Step 7050/10000000; acc:  21.70; ppl: 126.64; xent: 4.84; lr: 0.00003; 2554/2906 tok/s;   6957 sec
[2019-09-08 10:25:55,208 INFO] Step 7100/10000000; acc:  19.03; ppl: 132.73; xent: 4.89; lr: 0.00003; 3259/3750 tok/s;   7006 sec
[2019-09-08 10:26:43,177 INFO] Step 7150/10000000; acc:  20.68; ppl: 126.64; xent: 4.84; lr: 0.00003; 3259/3781 tok/s;   7054 sec
[2019-09-08 10:27:31,743 INFO] Step 7200/10000000; acc:  20.42; ppl: 124.08; xent: 4.82; lr: 0.00003; 3314/3730 tok/s;   7103 sec
[2019-09-08 10:28:20,318 INFO] Step 7250/10000000; acc:  21.49; ppl: 116.72; xent: 4.76; lr: 0.00003; 3251/3733 tok/s;   7151 sec
[2019-09-08 10:29:08,548 INFO] Step 7300/10000000; acc:  21.15; ppl: 123.18; xent: 4.81; lr: 0.00003; 3242/3661 tok/s;   7200 sec
[2019-09-08 10:29:57,052 INFO] Step 7350/10000000; acc:  20.43; ppl: 117.78; xent: 4.77; lr: 0.00003; 3328/3713 tok/s;   7248 sec
[2019-09-08 10:30:43,950 INFO] Step 7400/10000000; acc:  23.47; ppl: 109.80; xent: 4.70; lr: 0.00003; 3283/3794 tok/s;   7295 sec
[2019-09-08 10:31:32,412 INFO] Step 7450/10000000; acc:  21.66; ppl: 112.22; xent: 4.72; lr: 0.00003; 3281/3723 tok/s;   7343 sec
[2019-09-08 10:32:23,872 INFO] Step 7500/10000000; acc:  20.68; ppl: 115.07; xent: 4.75; lr: 0.00003; 3109/3513 tok/s;   7395 sec
[2019-09-08 10:33:12,224 INFO] Step 7550/10000000; acc:  23.00; ppl: 104.15; xent: 4.65; lr: 0.00003; 3216/3755 tok/s;   7443 sec
[2019-09-08 10:33:59,928 INFO] Step 7600/10000000; acc:  23.07; ppl: 104.20; xent: 4.65; lr: 0.00003; 3260/3693 tok/s;   7491 sec
[2019-09-08 10:34:48,807 INFO] Step 7650/10000000; acc:  22.79; ppl: 101.16; xent: 4.62; lr: 0.00003; 3198/3787 tok/s;   7540 sec
[2019-09-08 10:35:37,119 INFO] Step 7700/10000000; acc:  22.77; ppl: 102.39; xent: 4.63; lr: 0.00003; 3369/3662 tok/s;   7588 sec
[2019-09-08 10:36:25,889 INFO] Step 7750/10000000; acc:  21.95; ppl: 106.06; xent: 4.66; lr: 0.00003; 3291/3770 tok/s;   7637 sec
[2019-09-08 10:37:13,276 INFO] Step 7800/10000000; acc:  24.11; ppl: 95.28; xent: 4.56; lr: 0.00003; 3157/3773 tok/s;   7684 sec
[2019-09-08 10:38:01,263 INFO] Step 7850/10000000; acc:  23.58; ppl: 98.13; xent: 4.59; lr: 0.00003; 3341/3735 tok/s;   7732 sec
[2019-09-08 10:38:50,345 INFO] Step 7900/10000000; acc:  22.53; ppl: 100.57; xent: 4.61; lr: 0.00003; 3387/3707 tok/s;   7781 sec
[2019-09-08 10:39:38,616 INFO] Step 7950/10000000; acc:  23.57; ppl: 94.47; xent: 4.55; lr: 0.00003; 3261/3811 tok/s;   7830 sec
[2019-09-08 10:40:26,459 INFO] Step 8000/10000000; acc:  23.60; ppl: 97.88; xent: 4.58; lr: 0.00003; 3266/3693 tok/s;   7877 sec
[2019-09-08 10:40:30,869 INFO] Saving checkpoint ./transformer_model_step_8000.pt
[2019-09-08 10:41:25,774 INFO] Step 8050/10000000; acc:  24.44; ppl: 91.50; xent: 4.52; lr: 0.00003; 2600/2917 tok/s;   7937 sec
[2019-09-08 10:42:13,604 INFO] Step 8100/10000000; acc:  24.54; ppl: 90.79; xent: 4.51; lr: 0.00003; 3206/3724 tok/s;   7985 sec
[2019-09-08 10:43:03,041 INFO] Step 8150/10000000; acc:  23.20; ppl: 94.02; xent: 4.54; lr: 0.00003; 3272/3722 tok/s;   8034 sec
[2019-09-08 10:43:51,239 INFO] Step 8200/10000000; acc:  23.65; ppl: 93.16; xent: 4.53; lr: 0.00003; 3310/3662 tok/s;   8082 sec
[2019-09-08 10:44:40,402 INFO] Step 8250/10000000; acc:  23.83; ppl: 90.54; xent: 4.51; lr: 0.00003; 3289/3690 tok/s;   8131 sec
[2019-09-08 10:45:28,680 INFO] Step 8300/10000000; acc:  24.85; ppl: 85.65; xent: 4.45; lr: 0.00003; 3269/3633 tok/s;   8180 sec
[2019-09-08 10:46:17,336 INFO] Step 8350/10000000; acc:  23.79; ppl: 87.99; xent: 4.48; lr: 0.00003; 3202/3735 tok/s;   8228 sec
[2019-09-08 10:47:05,190 INFO] Step 8400/10000000; acc:  25.44; ppl: 85.02; xent: 4.44; lr: 0.00003; 3202/3695 tok/s;   8276 sec
[2019-09-08 10:47:52,565 INFO] Step 8450/10000000; acc:  24.98; ppl: 84.26; xent: 4.43; lr: 0.00003; 3285/3693 tok/s;   8324 sec
[2019-09-08 10:48:40,318 INFO] Step 8500/10000000; acc:  24.96; ppl: 84.70; xent: 4.44; lr: 0.00003; 3227/3738 tok/s;   8371 sec
[2019-09-08 10:49:28,003 INFO] Step 8550/10000000; acc:  25.75; ppl: 80.30; xent: 4.39; lr: 0.00003; 3388/3720 tok/s;   8419 sec
[2019-09-08 10:50:16,410 INFO] Step 8600/10000000; acc:  25.23; ppl: 78.63; xent: 4.36; lr: 0.00003; 3154/3775 tok/s;   8467 sec
[2019-09-08 10:51:06,494 INFO] Step 8650/10000000; acc:  25.90; ppl: 79.35; xent: 4.37; lr: 0.00003; 3120/3656 tok/s;   8517 sec
[2019-09-08 10:51:54,044 INFO] Step 8700/10000000; acc:  26.15; ppl: 76.22; xent: 4.33; lr: 0.00003; 3354/3697 tok/s;   8565 sec
[2019-09-08 10:52:42,460 INFO] Step 8750/10000000; acc:  25.97; ppl: 76.66; xent: 4.34; lr: 0.00003; 3287/3786 tok/s;   8613 sec
[2019-09-08 10:53:30,341 INFO] Step 8800/10000000; acc:  26.52; ppl: 76.12; xent: 4.33; lr: 0.00003; 3334/3722 tok/s;   8661 sec
[2019-09-08 10:54:18,865 INFO] Step 8850/10000000; acc:  26.82; ppl: 72.17; xent: 4.28; lr: 0.00003; 3218/3700 tok/s;   8710 sec
[2019-09-08 10:55:06,977 INFO] Step 8900/10000000; acc:  26.91; ppl: 71.45; xent: 4.27; lr: 0.00003; 3255/3753 tok/s;   8758 sec
[2019-09-08 10:55:54,725 INFO] Step 8950/10000000; acc:  26.89; ppl: 72.66; xent: 4.29; lr: 0.00003; 3321/3710 tok/s;   8806 sec
[2019-09-08 10:56:42,347 INFO] Step 9000/10000000; acc:  25.37; ppl: 76.87; xent: 4.34; lr: 0.00004; 3244/3638 tok/s;   8853 sec
[2019-09-08 10:56:46,737 INFO] Saving checkpoint ./transformer_model_step_9000.pt
[2019-09-08 10:57:44,341 INFO] Step 9050/10000000; acc:  27.04; ppl: 69.81; xent: 4.25; lr: 0.00004; 2523/2946 tok/s;   8915 sec
[2019-09-08 10:58:33,297 INFO] Step 9100/10000000; acc:  26.69; ppl: 69.27; xent: 4.24; lr: 0.00004; 3351/3731 tok/s;   8964 sec
[2019-09-08 10:59:21,289 INFO] Step 9150/10000000; acc:  27.14; ppl: 69.26; xent: 4.24; lr: 0.00004; 3183/3715 tok/s;   9012 sec
[2019-09-08 11:00:11,086 INFO] Step 9200/10000000; acc:  26.00; ppl: 71.47; xent: 4.27; lr: 0.00004; 3179/3732 tok/s;   9062 sec
[2019-09-08 11:00:59,178 INFO] Step 9250/10000000; acc:  28.56; ppl: 63.99; xent: 4.16; lr: 0.00004; 3202/3794 tok/s;   9110 sec
[2019-09-08 11:01:47,377 INFO] Step 9300/10000000; acc:  26.52; ppl: 70.55; xent: 4.26; lr: 0.00004; 3221/3696 tok/s;   9158 sec
[2019-09-08 11:02:34,889 INFO] Step 9350/10000000; acc:  27.18; ppl: 68.65; xent: 4.23; lr: 0.00004; 3172/3784 tok/s;   9206 sec
[2019-09-08 11:03:23,274 INFO] Step 9400/10000000; acc:  27.06; ppl: 67.03; xent: 4.21; lr: 0.00004; 3400/3704 tok/s;   9254 sec
[2019-09-08 11:04:11,670 INFO] Step 9450/10000000; acc:  28.33; ppl: 63.31; xent: 4.15; lr: 0.00004; 3286/3697 tok/s;   9303 sec
[2019-09-08 11:05:00,003 INFO] Step 9500/10000000; acc:  27.99; ppl: 64.14; xent: 4.16; lr: 0.00004; 3144/3731 tok/s;   9351 sec
[2019-09-08 11:05:48,805 INFO] Step 9550/10000000; acc:  27.91; ppl: 63.37; xent: 4.15; lr: 0.00004; 3207/3786 tok/s;   9400 sec
[2019-09-08 11:06:36,977 INFO] Step 9600/10000000; acc:  27.98; ppl: 63.61; xent: 4.15; lr: 0.00004; 3280/3695 tok/s;   9448 sec
[2019-09-08 11:07:24,362 INFO] Step 9650/10000000; acc:  29.18; ppl: 59.31; xent: 4.08; lr: 0.00004; 3251/3662 tok/s;   9495 sec
[2019-09-08 11:08:13,098 INFO] Step 9700/10000000; acc:  27.92; ppl: 62.98; xent: 4.14; lr: 0.00004; 3326/3691 tok/s;   9544 sec
[2019-09-08 11:08:43,773 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 11:09:04,771 INFO] number of examples: 805546
[2019-09-08 11:09:29,351 INFO] Step 9750/10000000; acc:  26.62; ppl: 74.58; xent: 4.31; lr: 0.00004; 2060/2448 tok/s;   9620 sec
[2019-09-08 11:10:17,644 INFO] Step 9800/10000000; acc:  24.13; ppl: 109.53; xent: 4.70; lr: 0.00004; 3277/3668 tok/s;   9669 sec
[2019-09-08 11:11:06,452 INFO] Step 9850/10000000; acc:  25.21; ppl: 98.45; xent: 4.59; lr: 0.00004; 3385/3746 tok/s;   9717 sec
[2019-09-08 11:11:56,027 INFO] Step 9900/10000000; acc:  24.60; ppl: 94.47; xent: 4.55; lr: 0.00004; 3277/3784 tok/s;   9767 sec
[2019-09-08 11:12:44,114 INFO] Step 9950/10000000; acc:  26.05; ppl: 89.45; xent: 4.49; lr: 0.00004; 3287/3813 tok/s;   9815 sec
[2019-09-08 11:13:31,840 INFO] Step 10000/10000000; acc:  25.66; ppl: 87.95; xent: 4.48; lr: 0.00004; 3396/3697 tok/s;   9863 sec
[2019-09-08 11:13:31,842 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-08 11:13:33,444 INFO] number of examples: 100000
[2019-09-08 11:20:55,825 INFO] Validation perplexity: 180.362
[2019-09-08 11:20:55,825 INFO] Validation accuracy: 22.1248
[2019-09-08 11:21:00,242 INFO] Saving checkpoint ./transformer_model_step_10000.pt
[2019-09-08 11:21:55,585 INFO] Step 10050/10000000; acc:  26.50; ppl: 84.94; xent: 4.44; lr: 0.00004; 322/355 tok/s;  10367 sec
[2019-09-08 11:22:44,490 INFO] Step 10100/10000000; acc:  25.93; ppl: 87.83; xent: 4.48; lr: 0.00004; 3268/3778 tok/s;  10415 sec
[2019-09-08 11:23:32,928 INFO] Step 10150/10000000; acc:  26.15; ppl: 84.65; xent: 4.44; lr: 0.00004; 3321/3786 tok/s;  10464 sec
[2019-09-08 11:24:20,815 INFO] Step 10200/10000000; acc:  27.30; ppl: 81.21; xent: 4.40; lr: 0.00004; 3364/3765 tok/s;  10512 sec
[2019-09-08 11:25:09,172 INFO] Step 10250/10000000; acc:  26.02; ppl: 81.76; xent: 4.40; lr: 0.00004; 3271/3764 tok/s;  10560 sec
[2019-09-08 11:25:57,642 INFO] Step 10300/10000000; acc:  26.06; ppl: 83.31; xent: 4.42; lr: 0.00004; 3416/3801 tok/s;  10609 sec
[2019-09-08 11:26:45,614 INFO] Step 10350/10000000; acc:  26.85; ppl: 81.62; xent: 4.40; lr: 0.00004; 3417/3717 tok/s;  10657 sec
[2019-09-08 11:27:34,108 INFO] Step 10400/10000000; acc:  26.72; ppl: 79.12; xent: 4.37; lr: 0.00004; 3298/3729 tok/s;  10705 sec
[2019-09-08 11:28:22,452 INFO] Step 10450/10000000; acc:  27.45; ppl: 74.98; xent: 4.32; lr: 0.00004; 3300/3770 tok/s;  10753 sec
[2019-09-08 11:29:11,450 INFO] Step 10500/10000000; acc:  25.61; ppl: 80.25; xent: 4.39; lr: 0.00004; 3322/3713 tok/s;  10802 sec
[2019-09-08 11:29:59,944 INFO] Step 10550/10000000; acc:  27.02; ppl: 74.93; xent: 4.32; lr: 0.00004; 3251/3697 tok/s;  10851 sec
[2019-09-08 11:30:47,782 INFO] Step 10600/10000000; acc:  28.98; ppl: 70.48; xent: 4.26; lr: 0.00004; 3267/3766 tok/s;  10899 sec
[2019-09-08 11:31:36,897 INFO] Step 10650/10000000; acc:  27.07; ppl: 72.75; xent: 4.29; lr: 0.00004; 3263/3772 tok/s;  10948 sec
[2019-09-08 11:32:25,072 INFO] Step 10700/10000000; acc:  27.36; ppl: 74.21; xent: 4.31; lr: 0.00004; 3258/3769 tok/s;  10996 sec
[2019-09-08 11:33:14,018 INFO] Step 10750/10000000; acc:  27.43; ppl: 71.54; xent: 4.27; lr: 0.00004; 3374/3782 tok/s;  11045 sec
[2019-09-08 11:34:02,634 INFO] Step 10800/10000000; acc:  26.52; ppl: 74.68; xent: 4.31; lr: 0.00004; 3398/3736 tok/s;  11094 sec
[2019-09-08 11:34:52,082 INFO] Step 10850/10000000; acc:  26.26; ppl: 73.24; xent: 4.29; lr: 0.00004; 3298/3749 tok/s;  11143 sec
[2019-09-08 11:35:43,318 INFO] Step 10900/10000000; acc:  26.72; ppl: 71.70; xent: 4.27; lr: 0.00004; 3126/3519 tok/s;  11194 sec
[2019-09-08 11:36:31,492 INFO] Step 10950/10000000; acc:  28.66; ppl: 65.29; xent: 4.18; lr: 0.00004; 3249/3779 tok/s;  11242 sec
[2019-09-08 11:37:20,669 INFO] Step 11000/10000000; acc:  26.68; ppl: 69.07; xent: 4.24; lr: 0.00004; 3362/3796 tok/s;  11292 sec
[2019-09-08 11:37:25,117 INFO] Saving checkpoint ./transformer_model_step_11000.pt
[2019-09-08 11:38:20,850 INFO] Step 11050/10000000; acc:  27.90; ppl: 67.37; xent: 4.21; lr: 0.00004; 2687/2990 tok/s;  11352 sec
[2019-09-08 11:39:08,448 INFO] Step 11100/10000000; acc:  29.06; ppl: 63.23; xent: 4.15; lr: 0.00004; 3324/3765 tok/s;  11399 sec
[2019-09-08 11:39:56,700 INFO] Step 11150/10000000; acc:  29.38; ppl: 62.32; xent: 4.13; lr: 0.00004; 3335/3776 tok/s;  11448 sec
[2019-09-08 11:40:45,020 INFO] Step 11200/10000000; acc:  28.74; ppl: 63.02; xent: 4.14; lr: 0.00004; 3318/3632 tok/s;  11496 sec
[2019-09-08 11:41:33,829 INFO] Step 11250/10000000; acc:  28.30; ppl: 65.31; xent: 4.18; lr: 0.00004; 3314/3734 tok/s;  11545 sec
[2019-09-08 11:42:22,139 INFO] Step 11300/10000000; acc:  29.18; ppl: 60.54; xent: 4.10; lr: 0.00004; 3369/3784 tok/s;  11593 sec
[2019-09-08 11:43:11,316 INFO] Step 11350/10000000; acc:  26.92; ppl: 66.88; xent: 4.20; lr: 0.00004; 3285/3691 tok/s;  11642 sec
[2019-09-08 11:44:00,277 INFO] Step 11400/10000000; acc:  28.60; ppl: 61.71; xent: 4.12; lr: 0.00004; 3341/3808 tok/s;  11691 sec
[2019-09-08 11:44:49,152 INFO] Step 11450/10000000; acc:  28.24; ppl: 62.42; xent: 4.13; lr: 0.00004; 3373/3796 tok/s;  11740 sec
[2019-09-08 11:45:38,425 INFO] Step 11500/10000000; acc:  28.32; ppl: 62.00; xent: 4.13; lr: 0.00004; 3233/3758 tok/s;  11789 sec
[2019-09-08 11:46:27,377 INFO] Step 11550/10000000; acc:  28.76; ppl: 59.98; xent: 4.09; lr: 0.00005; 3300/3712 tok/s;  11838 sec
[2019-09-08 11:47:17,024 INFO] Step 11600/10000000; acc:  29.50; ppl: 57.67; xent: 4.05; lr: 0.00005; 3273/3816 tok/s;  11888 sec
[2019-09-08 11:48:05,202 INFO] Step 11650/10000000; acc:  28.70; ppl: 60.43; xent: 4.10; lr: 0.00005; 3296/3744 tok/s;  11936 sec
[2019-09-08 11:48:53,512 INFO] Step 11700/10000000; acc:  29.03; ppl: 59.73; xent: 4.09; lr: 0.00005; 3240/3686 tok/s;  11984 sec
[2019-09-08 11:49:41,633 INFO] Step 11750/10000000; acc:  30.02; ppl: 56.57; xent: 4.04; lr: 0.00005; 3328/3696 tok/s;  12033 sec
[2019-09-08 11:50:29,914 INFO] Step 11800/10000000; acc:  30.02; ppl: 55.08; xent: 4.01; lr: 0.00005; 3298/3734 tok/s;  12081 sec
[2019-09-08 11:51:18,966 INFO] Step 11850/10000000; acc:  29.25; ppl: 57.06; xent: 4.04; lr: 0.00005; 3314/3725 tok/s;  12130 sec
[2019-09-08 11:52:06,933 INFO] Step 11900/10000000; acc:  30.27; ppl: 54.64; xent: 4.00; lr: 0.00005; 3322/3791 tok/s;  12178 sec
[2019-09-08 11:52:54,445 INFO] Step 11950/10000000; acc:  31.60; ppl: 52.47; xent: 3.96; lr: 0.00005; 3283/3749 tok/s;  12225 sec
[2019-09-08 11:53:42,550 INFO] Step 12000/10000000; acc:  30.25; ppl: 53.54; xent: 3.98; lr: 0.00005; 3199/3699 tok/s;  12274 sec
[2019-09-08 11:53:46,967 INFO] Saving checkpoint ./transformer_model_step_12000.pt
[2019-09-08 11:54:44,370 INFO] Step 12050/10000000; acc:  29.37; ppl: 54.08; xent: 3.99; lr: 0.00005; 2721/3004 tok/s;  12335 sec
[2019-09-08 11:55:33,269 INFO] Step 12100/10000000; acc:  30.60; ppl: 52.65; xent: 3.96; lr: 0.00005; 3247/3733 tok/s;  12384 sec
[2019-09-08 11:56:22,213 INFO] Step 12150/10000000; acc:  29.26; ppl: 54.32; xent: 3.99; lr: 0.00005; 3259/3693 tok/s;  12433 sec
[2019-09-08 11:57:09,672 INFO] Step 12200/10000000; acc:  32.43; ppl: 47.39; xent: 3.86; lr: 0.00005; 3179/3677 tok/s;  12481 sec
[2019-09-08 11:57:58,788 INFO] Step 12250/10000000; acc:  29.57; ppl: 54.06; xent: 3.99; lr: 0.00005; 3300/3638 tok/s;  12530 sec
[2019-09-08 11:58:48,455 INFO] Step 12300/10000000; acc:  29.03; ppl: 53.82; xent: 3.99; lr: 0.00005; 3361/3718 tok/s;  12579 sec
[2019-09-08 11:59:37,285 INFO] Step 12350/10000000; acc:  30.68; ppl: 50.01; xent: 3.91; lr: 0.00005; 3199/3663 tok/s;  12628 sec
[2019-09-08 12:00:25,707 INFO] Step 12400/10000000; acc:  30.76; ppl: 51.21; xent: 3.94; lr: 0.00005; 3281/3654 tok/s;  12677 sec
[2019-09-08 12:01:13,811 INFO] Step 12450/10000000; acc:  31.07; ppl: 49.62; xent: 3.90; lr: 0.00005; 3315/3647 tok/s;  12725 sec
[2019-09-08 12:02:02,673 INFO] Step 12500/10000000; acc:  32.43; ppl: 47.01; xent: 3.85; lr: 0.00005; 3232/3733 tok/s;  12774 sec
[2019-09-08 12:02:51,952 INFO] Step 12550/10000000; acc:  30.31; ppl: 50.77; xent: 3.93; lr: 0.00005; 3216/3673 tok/s;  12823 sec
[2019-09-08 12:03:40,627 INFO] Step 12600/10000000; acc:  30.68; ppl: 49.62; xent: 3.90; lr: 0.00005; 3307/3707 tok/s;  12872 sec
[2019-09-08 12:04:09,490 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 12:04:32,663 INFO] number of examples: 947346
[2019-09-08 12:04:57,609 INFO] Step 12650/10000000; acc:  30.90; ppl: 51.42; xent: 3.94; lr: 0.00005; 1989/2281 tok/s;  12949 sec
[2019-09-08 12:05:45,793 INFO] Step 12700/10000000; acc:  30.23; ppl: 52.49; xent: 3.96; lr: 0.00005; 3292/3719 tok/s;  12997 sec
[2019-09-08 12:06:34,080 INFO] Step 12750/10000000; acc:  30.95; ppl: 49.31; xent: 3.90; lr: 0.00005; 3292/3719 tok/s;  13045 sec
[2019-09-08 12:07:22,222 INFO] Step 12800/10000000; acc:  32.79; ppl: 45.09; xent: 3.81; lr: 0.00005; 3319/3658 tok/s;  13093 sec
[2019-09-08 12:08:11,599 INFO] Step 12850/10000000; acc:  32.13; ppl: 45.86; xent: 3.83; lr: 0.00005; 3201/3749 tok/s;  13143 sec
[2019-09-08 12:08:59,404 INFO] Step 12900/10000000; acc:  33.28; ppl: 42.52; xent: 3.75; lr: 0.00005; 3276/3707 tok/s;  13190 sec
[2019-09-08 12:09:47,939 INFO] Step 12950/10000000; acc:  32.77; ppl: 42.23; xent: 3.74; lr: 0.00005; 3413/3726 tok/s;  13239 sec
[2019-09-08 12:10:35,986 INFO] Step 13000/10000000; acc:  33.61; ppl: 40.68; xent: 3.71; lr: 0.00005; 3288/3699 tok/s;  13287 sec
[2019-09-08 12:10:40,397 INFO] Saving checkpoint ./transformer_model_step_13000.pt
[2019-09-08 12:11:38,398 INFO] Step 13050/10000000; acc:  35.40; ppl: 37.56; xent: 3.63; lr: 0.00005; 2502/2880 tok/s;  13349 sec
[2019-09-08 12:12:27,401 INFO] Step 13100/10000000; acc:  34.73; ppl: 37.54; xent: 3.63; lr: 0.00005; 3246/3774 tok/s;  13398 sec
[2019-09-08 12:13:14,910 INFO] Step 13150/10000000; acc:  35.53; ppl: 37.40; xent: 3.62; lr: 0.00005; 3181/3721 tok/s;  13446 sec
[2019-09-08 12:14:02,364 INFO] Step 13200/10000000; acc:  36.33; ppl: 34.81; xent: 3.55; lr: 0.00005; 3263/3784 tok/s;  13493 sec
[2019-09-08 12:14:51,701 INFO] Step 13250/10000000; acc:  33.04; ppl: 39.84; xent: 3.68; lr: 0.00005; 3065/3682 tok/s;  13543 sec
[2019-09-08 12:15:40,312 INFO] Step 13300/10000000; acc:  35.02; ppl: 35.65; xent: 3.57; lr: 0.00005; 3230/3811 tok/s;  13591 sec
[2019-09-08 12:16:28,183 INFO] Step 13350/10000000; acc:  35.16; ppl: 36.04; xent: 3.58; lr: 0.00005; 3315/3711 tok/s;  13639 sec
[2019-09-08 12:17:16,288 INFO] Step 13400/10000000; acc:  34.63; ppl: 36.44; xent: 3.60; lr: 0.00005; 3289/3746 tok/s;  13687 sec
[2019-09-08 12:18:04,897 INFO] Step 13450/10000000; acc:  35.47; ppl: 34.46; xent: 3.54; lr: 0.00005; 3259/3751 tok/s;  13736 sec
[2019-09-08 12:18:52,987 INFO] Step 13500/10000000; acc:  35.00; ppl: 35.46; xent: 3.57; lr: 0.00005; 3259/3781 tok/s;  13784 sec
[2019-09-08 12:19:41,889 INFO] Step 13550/10000000; acc:  36.53; ppl: 32.22; xent: 3.47; lr: 0.00005; 3275/3682 tok/s;  13833 sec
[2019-09-08 12:20:30,331 INFO] Step 13600/10000000; acc:  36.01; ppl: 33.06; xent: 3.50; lr: 0.00005; 3225/3717 tok/s;  13881 sec
[2019-09-08 12:21:18,289 INFO] Step 13650/10000000; acc:  35.58; ppl: 33.54; xent: 3.51; lr: 0.00005; 3334/3702 tok/s;  13929 sec
[2019-09-08 12:22:05,599 INFO] Step 13700/10000000; acc:  38.30; ppl: 30.29; xent: 3.41; lr: 0.00005; 3286/3761 tok/s;  13977 sec
[2019-09-08 12:22:53,761 INFO] Step 13750/10000000; acc:  35.98; ppl: 31.93; xent: 3.46; lr: 0.00005; 3278/3685 tok/s;  14025 sec
[2019-09-08 12:23:45,196 INFO] Step 13800/10000000; acc:  36.77; ppl: 31.05; xent: 3.44; lr: 0.00005; 3110/3547 tok/s;  14076 sec
[2019-09-08 12:24:33,859 INFO] Step 13850/10000000; acc:  37.81; ppl: 29.31; xent: 3.38; lr: 0.00005; 3239/3768 tok/s;  14125 sec
[2019-09-08 12:25:21,876 INFO] Step 13900/10000000; acc:  38.07; ppl: 29.09; xent: 3.37; lr: 0.00005; 3234/3705 tok/s;  14173 sec
[2019-09-08 12:26:10,154 INFO] Step 13950/10000000; acc:  37.87; ppl: 29.24; xent: 3.38; lr: 0.00005; 3182/3741 tok/s;  14221 sec
[2019-09-08 12:26:59,023 INFO] Step 14000/10000000; acc:  38.20; ppl: 28.04; xent: 3.33; lr: 0.00005; 3297/3750 tok/s;  14270 sec
[2019-09-08 12:27:03,446 INFO] Saving checkpoint ./transformer_model_step_14000.pt
[2019-09-08 12:28:00,083 INFO] Step 14050/10000000; acc:  37.98; ppl: 28.83; xent: 3.36; lr: 0.00005; 2675/2889 tok/s;  14331 sec
[2019-09-08 12:28:48,242 INFO] Step 14100/10000000; acc:  38.26; ppl: 28.29; xent: 3.34; lr: 0.00006; 3160/3783 tok/s;  14379 sec
[2019-09-08 12:29:36,080 INFO] Step 14150/10000000; acc:  39.14; ppl: 26.84; xent: 3.29; lr: 0.00006; 3296/3800 tok/s;  14427 sec
[2019-09-08 12:30:25,020 INFO] Step 14200/10000000; acc:  38.57; ppl: 27.34; xent: 3.31; lr: 0.00006; 3372/3729 tok/s;  14476 sec
[2019-09-08 12:31:13,044 INFO] Step 14250/10000000; acc:  39.46; ppl: 26.20; xent: 3.27; lr: 0.00006; 3263/3744 tok/s;  14524 sec
[2019-09-08 12:32:01,859 INFO] Step 14300/10000000; acc:  39.22; ppl: 26.20; xent: 3.27; lr: 0.00006; 3259/3736 tok/s;  14573 sec
[2019-09-08 12:32:48,874 INFO] Step 14350/10000000; acc:  40.52; ppl: 25.32; xent: 3.23; lr: 0.00006; 3242/3638 tok/s;  14620 sec
[2019-09-08 12:33:36,310 INFO] Step 14400/10000000; acc:  39.06; ppl: 26.55; xent: 3.28; lr: 0.00006; 3253/3702 tok/s;  14667 sec
[2019-09-08 12:34:24,964 INFO] Step 14450/10000000; acc:  39.78; ppl: 25.21; xent: 3.23; lr: 0.00006; 3340/3723 tok/s;  14716 sec
[2019-09-08 12:35:14,020 INFO] Step 14500/10000000; acc:  38.06; ppl: 27.62; xent: 3.32; lr: 0.00006; 3208/3700 tok/s;  14765 sec
[2019-09-08 12:36:02,632 INFO] Step 14550/10000000; acc:  40.34; ppl: 24.26; xent: 3.19; lr: 0.00006; 3350/3697 tok/s;  14814 sec
[2019-09-08 12:36:51,326 INFO] Step 14600/10000000; acc:  40.23; ppl: 24.55; xent: 3.20; lr: 0.00006; 3208/3616 tok/s;  14862 sec
[2019-09-08 12:37:39,956 INFO] Step 14650/10000000; acc:  39.28; ppl: 25.24; xent: 3.23; lr: 0.00006; 3300/3720 tok/s;  14911 sec
[2019-09-08 12:38:27,845 INFO] Step 14700/10000000; acc:  40.21; ppl: 24.64; xent: 3.20; lr: 0.00006; 3139/3673 tok/s;  14959 sec
[2019-09-08 12:39:15,369 INFO] Step 14750/10000000; acc:  39.94; ppl: 24.75; xent: 3.21; lr: 0.00006; 3294/3685 tok/s;  15006 sec
[2019-09-08 12:40:03,162 INFO] Step 14800/10000000; acc:  41.09; ppl: 23.19; xent: 3.14; lr: 0.00006; 3226/3782 tok/s;  15054 sec
[2019-09-08 12:40:51,397 INFO] Step 14850/10000000; acc:  40.61; ppl: 23.70; xent: 3.17; lr: 0.00006; 3370/3649 tok/s;  15102 sec
[2019-09-08 12:41:39,197 INFO] Step 14900/10000000; acc:  41.21; ppl: 22.65; xent: 3.12; lr: 0.00006; 3096/3801 tok/s;  15150 sec
[2019-09-08 12:42:27,931 INFO] Step 14950/10000000; acc:  40.47; ppl: 23.23; xent: 3.15; lr: 0.00006; 3303/3759 tok/s;  15199 sec
[2019-09-08 12:43:16,943 INFO] Step 15000/10000000; acc:  43.11; ppl: 20.79; xent: 3.03; lr: 0.00006; 3211/3583 tok/s;  15248 sec
[2019-09-08 12:43:21,373 INFO] Saving checkpoint ./transformer_model_step_15000.pt
[2019-09-08 12:44:19,696 INFO] Step 15050/10000000; acc:  41.66; ppl: 21.78; xent: 3.08; lr: 0.00006; 2542/2882 tok/s;  15311 sec
[2019-09-08 12:45:08,294 INFO] Step 15100/10000000; acc:  42.50; ppl: 20.93; xent: 3.04; lr: 0.00006; 3282/3741 tok/s;  15359 sec
[2019-09-08 12:45:56,379 INFO] Step 15150/10000000; acc:  42.65; ppl: 20.59; xent: 3.02; lr: 0.00006; 3280/3731 tok/s;  15407 sec
[2019-09-08 12:46:44,878 INFO] Step 15200/10000000; acc:  42.77; ppl: 20.32; xent: 3.01; lr: 0.00006; 3164/3767 tok/s;  15456 sec
[2019-09-08 12:47:32,589 INFO] Step 15250/10000000; acc:  43.04; ppl: 20.25; xent: 3.01; lr: 0.00006; 3376/3727 tok/s;  15504 sec
[2019-09-08 12:48:20,007 INFO] Step 15300/10000000; acc:  41.24; ppl: 22.27; xent: 3.10; lr: 0.00006; 3199/3614 tok/s;  15551 sec
[2019-09-08 12:49:08,415 INFO] Step 15350/10000000; acc:  42.94; ppl: 20.03; xent: 3.00; lr: 0.00006; 3299/3756 tok/s;  15599 sec
[2019-09-08 12:49:57,279 INFO] Step 15400/10000000; acc:  42.44; ppl: 20.20; xent: 3.01; lr: 0.00006; 3301/3739 tok/s;  15648 sec
[2019-09-08 12:50:45,171 INFO] Step 15450/10000000; acc:  43.18; ppl: 19.93; xent: 2.99; lr: 0.00006; 3277/3680 tok/s;  15696 sec
[2019-09-08 12:51:34,694 INFO] Step 15500/10000000; acc:  42.04; ppl: 20.41; xent: 3.02; lr: 0.00006; 3111/3737 tok/s;  15746 sec
[2019-09-08 12:52:23,406 INFO] Step 15550/10000000; acc:  43.82; ppl: 18.99; xent: 2.94; lr: 0.00006; 3170/3800 tok/s;  15794 sec
[2019-09-08 12:53:11,706 INFO] Step 15600/10000000; acc:  41.89; ppl: 20.81; xent: 3.04; lr: 0.00006; 3186/3717 tok/s;  15843 sec
[2019-09-08 12:53:59,081 INFO] Step 15650/10000000; acc:  43.53; ppl: 19.36; xent: 2.96; lr: 0.00006; 3253/3745 tok/s;  15890 sec
[2019-09-08 12:54:46,795 INFO] Step 15700/10000000; acc:  42.94; ppl: 19.53; xent: 2.97; lr: 0.00006; 3400/3707 tok/s;  15938 sec
[2019-09-08 12:55:36,077 INFO] Step 15750/10000000; acc:  42.97; ppl: 19.23; xent: 2.96; lr: 0.00006; 3247/3665 tok/s;  15987 sec
[2019-09-08 12:56:24,499 INFO] Step 15800/10000000; acc:  43.61; ppl: 19.08; xent: 2.95; lr: 0.00006; 3170/3744 tok/s;  16035 sec
[2019-09-08 12:57:13,080 INFO] Step 15850/10000000; acc:  44.44; ppl: 17.96; xent: 2.89; lr: 0.00006; 3197/3812 tok/s;  16084 sec
[2019-09-08 12:58:01,354 INFO] Step 15900/10000000; acc:  43.59; ppl: 18.44; xent: 2.91; lr: 0.00006; 3301/3710 tok/s;  16132 sec
[2019-09-08 12:58:49,238 INFO] Step 15950/10000000; acc:  44.72; ppl: 18.01; xent: 2.89; lr: 0.00006; 3181/3652 tok/s;  16180 sec
[2019-09-08 12:59:37,245 INFO] Step 16000/10000000; acc:  44.39; ppl: 17.79; xent: 2.88; lr: 0.00006; 3368/3729 tok/s;  16228 sec
[2019-09-08 12:59:41,647 INFO] Saving checkpoint ./transformer_model_step_16000.pt
[2019-09-08 13:00:36,238 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 13:00:54,411 INFO] number of examples: 805546
[2019-09-08 13:01:04,297 INFO] Step 16050/10000000; acc:  42.07; ppl: 20.08; xent: 3.00; lr: 0.00006; 1842/2113 tok/s;  16315 sec
[2019-09-08 13:01:52,511 INFO] Step 16100/10000000; acc:  33.58; ppl: 42.57; xent: 3.75; lr: 0.00006; 3257/3694 tok/s;  16363 sec
[2019-09-08 13:02:41,270 INFO] Step 16150/10000000; acc:  34.53; ppl: 39.10; xent: 3.67; lr: 0.00006; 3275/3717 tok/s;  16412 sec
[2019-09-08 13:03:31,408 INFO] Step 16200/10000000; acc:  34.21; ppl: 37.04; xent: 3.61; lr: 0.00006; 3324/3778 tok/s;  16462 sec
[2019-09-08 13:04:19,728 INFO] Step 16250/10000000; acc:  35.07; ppl: 36.23; xent: 3.59; lr: 0.00006; 3292/3795 tok/s;  16511 sec
[2019-09-08 13:05:07,412 INFO] Step 16300/10000000; acc:  35.64; ppl: 34.78; xent: 3.55; lr: 0.00006; 3383/3717 tok/s;  16558 sec
[2019-09-08 13:05:55,154 INFO] Step 16350/10000000; acc:  36.58; ppl: 32.73; xent: 3.49; lr: 0.00006; 3362/3721 tok/s;  16606 sec
[2019-09-08 13:06:43,641 INFO] Step 16400/10000000; acc:  36.26; ppl: 33.06; xent: 3.50; lr: 0.00006; 3284/3784 tok/s;  16655 sec
[2019-09-08 13:07:32,408 INFO] Step 16450/10000000; acc:  35.43; ppl: 34.68; xent: 3.55; lr: 0.00006; 3311/3769 tok/s;  16703 sec
[2019-09-08 13:08:20,752 INFO] Step 16500/10000000; acc:  35.80; ppl: 33.40; xent: 3.51; lr: 0.00006; 3441/3774 tok/s;  16752 sec
[2019-09-08 13:09:08,834 INFO] Step 16550/10000000; acc:  38.29; ppl: 29.48; xent: 3.38; lr: 0.00006; 3199/3760 tok/s;  16800 sec
[2019-09-08 13:09:57,530 INFO] Step 16600/10000000; acc:  35.56; ppl: 33.62; xent: 3.52; lr: 0.00006; 3312/3804 tok/s;  16849 sec
[2019-09-08 13:10:45,406 INFO] Step 16650/10000000; acc:  36.69; ppl: 31.83; xent: 3.46; lr: 0.00007; 3455/3725 tok/s;  16896 sec
[2019-09-08 13:11:34,042 INFO] Step 16700/10000000; acc:  36.66; ppl: 31.44; xent: 3.45; lr: 0.00007; 3327/3729 tok/s;  16945 sec
[2019-09-08 13:12:22,889 INFO] Step 16750/10000000; acc:  36.35; ppl: 31.26; xent: 3.44; lr: 0.00007; 3338/3720 tok/s;  16994 sec
[2019-09-08 13:13:11,277 INFO] Step 16800/10000000; acc:  37.12; ppl: 29.71; xent: 3.39; lr: 0.00007; 3261/3729 tok/s;  17042 sec
[2019-09-08 13:13:59,987 INFO] Step 16850/10000000; acc:  36.79; ppl: 30.54; xent: 3.42; lr: 0.00007; 3318/3715 tok/s;  17091 sec
[2019-09-08 13:14:47,747 INFO] Step 16900/10000000; acc:  37.97; ppl: 28.83; xent: 3.36; lr: 0.00007; 3282/3713 tok/s;  17139 sec
[2019-09-08 13:15:36,803 INFO] Step 16950/10000000; acc:  37.56; ppl: 29.10; xent: 3.37; lr: 0.00007; 3262/3779 tok/s;  17188 sec
[2019-09-08 13:16:24,908 INFO] Step 17000/10000000; acc:  37.99; ppl: 29.15; xent: 3.37; lr: 0.00007; 3231/3776 tok/s;  17236 sec
[2019-09-08 13:16:29,344 INFO] Saving checkpoint ./transformer_model_step_17000.pt
[2019-09-08 13:17:25,950 INFO] Step 17050/10000000; acc:  37.61; ppl: 28.77; xent: 3.36; lr: 0.00007; 2678/3036 tok/s;  17297 sec
[2019-09-08 13:18:14,520 INFO] Step 17100/10000000; acc:  37.24; ppl: 28.84; xent: 3.36; lr: 0.00007; 3396/3734 tok/s;  17345 sec
[2019-09-08 13:19:03,972 INFO] Step 17150/10000000; acc:  36.73; ppl: 28.76; xent: 3.36; lr: 0.00007; 3321/3764 tok/s;  17395 sec
[2019-09-08 13:19:52,871 INFO] Step 17200/10000000; acc:  37.54; ppl: 28.33; xent: 3.34; lr: 0.00007; 3234/3674 tok/s;  17444 sec
[2019-09-08 13:20:43,621 INFO] Step 17250/10000000; acc:  38.16; ppl: 27.46; xent: 3.31; lr: 0.00007; 3141/3653 tok/s;  17495 sec
[2019-09-08 13:21:32,007 INFO] Step 17300/10000000; acc:  38.18; ppl: 26.83; xent: 3.29; lr: 0.00007; 3372/3730 tok/s;  17543 sec
[2019-09-08 13:22:20,656 INFO] Step 17350/10000000; acc:  38.41; ppl: 26.39; xent: 3.27; lr: 0.00007; 3330/3807 tok/s;  17592 sec
[2019-09-08 13:23:09,196 INFO] Step 17400/10000000; acc:  37.09; ppl: 27.65; xent: 3.32; lr: 0.00007; 3369/3707 tok/s;  17640 sec
[2019-09-08 13:23:56,251 INFO] Step 17450/10000000; acc:  41.72; ppl: 23.69; xent: 3.17; lr: 0.00007; 3289/3785 tok/s;  17687 sec
[2019-09-08 13:24:45,040 INFO] Step 17500/10000000; acc:  38.68; ppl: 25.94; xent: 3.26; lr: 0.00007; 3383/3686 tok/s;  17736 sec
[2019-09-08 13:25:34,146 INFO] Step 17550/10000000; acc:  37.55; ppl: 27.66; xent: 3.32; lr: 0.00007; 3291/3710 tok/s;  17785 sec
[2019-09-08 13:26:21,956 INFO] Step 17600/10000000; acc:  40.94; ppl: 23.68; xent: 3.16; lr: 0.00007; 3297/3756 tok/s;  17833 sec
[2019-09-08 13:27:10,829 INFO] Step 17650/10000000; acc:  37.99; ppl: 26.49; xent: 3.28; lr: 0.00007; 3332/3731 tok/s;  17882 sec
[2019-09-08 13:27:59,932 INFO] Step 17700/10000000; acc:  38.59; ppl: 25.40; xent: 3.23; lr: 0.00007; 3342/3751 tok/s;  17931 sec
[2019-09-08 13:28:49,127 INFO] Step 17750/10000000; acc:  38.53; ppl: 25.68; xent: 3.25; lr: 0.00007; 3331/3807 tok/s;  17980 sec
[2019-09-08 13:29:38,577 INFO] Step 17800/10000000; acc:  38.73; ppl: 25.40; xent: 3.23; lr: 0.00007; 3286/3796 tok/s;  18030 sec
[2019-09-08 13:30:27,313 INFO] Step 17850/10000000; acc:  38.33; ppl: 25.61; xent: 3.24; lr: 0.00007; 3307/3677 tok/s;  18078 sec
[2019-09-08 13:31:16,688 INFO] Step 17900/10000000; acc:  41.09; ppl: 22.42; xent: 3.11; lr: 0.00007; 3263/3798 tok/s;  18128 sec
[2019-09-08 13:32:05,261 INFO] Step 17950/10000000; acc:  38.83; ppl: 25.40; xent: 3.23; lr: 0.00007; 3286/3766 tok/s;  18176 sec
[2019-09-08 13:32:53,440 INFO] Step 18000/10000000; acc:  39.72; ppl: 24.12; xent: 3.18; lr: 0.00007; 3307/3720 tok/s;  18224 sec
[2019-09-08 13:32:57,897 INFO] Saving checkpoint ./transformer_model_step_18000.pt
[2019-09-08 13:33:54,519 INFO] Step 18050/10000000; acc:  39.27; ppl: 24.68; xent: 3.21; lr: 0.00007; 2563/2912 tok/s;  18285 sec
[2019-09-08 13:34:42,431 INFO] Step 18100/10000000; acc:  40.84; ppl: 22.45; xent: 3.11; lr: 0.00007; 3382/3715 tok/s;  18333 sec
[2019-09-08 13:35:31,373 INFO] Step 18150/10000000; acc:  40.00; ppl: 23.47; xent: 3.16; lr: 0.00007; 3235/3738 tok/s;  18382 sec
[2019-09-08 13:36:19,739 INFO] Step 18200/10000000; acc:  40.12; ppl: 23.27; xent: 3.15; lr: 0.00007; 3317/3770 tok/s;  18431 sec
[2019-09-08 13:37:07,124 INFO] Step 18250/10000000; acc:  41.72; ppl: 21.58; xent: 3.07; lr: 0.00007; 3380/3757 tok/s;  18478 sec
[2019-09-08 13:37:55,574 INFO] Step 18300/10000000; acc:  40.45; ppl: 22.88; xent: 3.13; lr: 0.00007; 3149/3744 tok/s;  18527 sec
[2019-09-08 13:38:44,071 INFO] Step 18350/10000000; acc:  40.72; ppl: 22.28; xent: 3.10; lr: 0.00007; 3389/3733 tok/s;  18575 sec
[2019-09-08 13:39:34,458 INFO] Step 18400/10000000; acc:  40.07; ppl: 22.87; xent: 3.13; lr: 0.00007; 3205/3678 tok/s;  18625 sec
[2019-09-08 13:40:22,970 INFO] Step 18450/10000000; acc:  40.44; ppl: 22.12; xent: 3.10; lr: 0.00007; 3323/3676 tok/s;  18674 sec
[2019-09-08 13:41:11,066 INFO] Step 18500/10000000; acc:  40.85; ppl: 21.51; xent: 3.07; lr: 0.00007; 3194/3707 tok/s;  18722 sec
[2019-09-08 13:41:59,745 INFO] Step 18550/10000000; acc:  41.73; ppl: 20.94; xent: 3.04; lr: 0.00007; 3225/3632 tok/s;  18771 sec
[2019-09-08 13:42:48,823 INFO] Step 18600/10000000; acc:  39.50; ppl: 22.79; xent: 3.13; lr: 0.00007; 3339/3722 tok/s;  18820 sec
[2019-09-08 13:43:38,335 INFO] Step 18650/10000000; acc:  40.34; ppl: 21.90; xent: 3.09; lr: 0.00007; 3237/3629 tok/s;  18869 sec
[2019-09-08 13:44:26,918 INFO] Step 18700/10000000; acc:  40.96; ppl: 21.65; xent: 3.08; lr: 0.00007; 3267/3685 tok/s;  18918 sec
[2019-09-08 13:45:15,131 INFO] Step 18750/10000000; acc:  41.19; ppl: 21.17; xent: 3.05; lr: 0.00007; 3271/3636 tok/s;  18966 sec
[2019-09-08 13:46:03,706 INFO] Step 18800/10000000; acc:  42.43; ppl: 20.44; xent: 3.02; lr: 0.00007; 3251/3731 tok/s;  19015 sec
[2019-09-08 13:46:53,006 INFO] Step 18850/10000000; acc:  41.47; ppl: 20.76; xent: 3.03; lr: 0.00007; 3203/3714 tok/s;  19064 sec
[2019-09-08 13:47:41,111 INFO] Step 18900/10000000; acc:  41.05; ppl: 21.44; xent: 3.07; lr: 0.00007; 3356/3686 tok/s;  19112 sec
[2019-09-08 13:48:23,905 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 13:48:48,716 INFO] number of examples: 947346
[2019-09-08 13:49:00,924 INFO] Step 18950/10000000; acc:  41.12; ppl: 21.33; xent: 3.06; lr: 0.00007; 1928/2244 tok/s;  19192 sec
[2019-09-08 13:49:48,810 INFO] Step 19000/10000000; acc:  42.91; ppl: 18.65; xent: 2.93; lr: 0.00007; 3352/3717 tok/s;  19240 sec
[2019-09-08 13:49:53,224 INFO] Saving checkpoint ./transformer_model_step_19000.pt
[2019-09-08 13:50:50,189 INFO] Step 19050/10000000; acc:  44.86; ppl: 16.94; xent: 2.83; lr: 0.00007; 2563/2922 tok/s;  19301 sec
[2019-09-08 13:51:38,246 INFO] Step 19100/10000000; acc:  45.74; ppl: 16.02; xent: 2.77; lr: 0.00007; 3399/3695 tok/s;  19349 sec
[2019-09-08 13:52:26,825 INFO] Step 19150/10000000; acc:  46.14; ppl: 15.81; xent: 2.76; lr: 0.00007; 3197/3744 tok/s;  19398 sec
[2019-09-08 13:53:15,069 INFO] Step 19200/10000000; acc:  46.95; ppl: 14.98; xent: 2.71; lr: 0.00008; 3221/3698 tok/s;  19446 sec
[2019-09-08 13:54:04,011 INFO] Step 19250/10000000; acc:  46.29; ppl: 14.98; xent: 2.71; lr: 0.00008; 3407/3706 tok/s;  19495 sec
[2019-09-08 13:54:52,084 INFO] Step 19300/10000000; acc:  46.62; ppl: 14.85; xent: 2.70; lr: 0.00008; 3281/3745 tok/s;  19543 sec
[2019-09-08 13:55:39,216 INFO] Step 19350/10000000; acc:  49.14; ppl: 13.28; xent: 2.59; lr: 0.00008; 3297/3698 tok/s;  19590 sec
[2019-09-08 13:56:28,441 INFO] Step 19400/10000000; acc:  48.23; ppl: 13.48; xent: 2.60; lr: 0.00008; 3293/3786 tok/s;  19639 sec
[2019-09-08 13:57:16,328 INFO] Step 19450/10000000; acc:  48.92; ppl: 13.59; xent: 2.61; lr: 0.00008; 3128/3730 tok/s;  19687 sec
[2019-09-08 13:58:03,943 INFO] Step 19500/10000000; acc:  50.04; ppl: 12.56; xent: 2.53; lr: 0.00008; 3240/3737 tok/s;  19735 sec
[2019-09-08 13:58:52,925 INFO] Step 19550/10000000; acc:  46.89; ppl: 14.41; xent: 2.67; lr: 0.00008; 3134/3671 tok/s;  19784 sec
[2019-09-08 13:59:41,543 INFO] Step 19600/10000000; acc:  48.68; ppl: 13.10; xent: 2.57; lr: 0.00008; 3146/3830 tok/s;  19833 sec
[2019-09-08 14:00:29,938 INFO] Step 19650/10000000; acc:  48.65; ppl: 12.99; xent: 2.56; lr: 0.00008; 3270/3754 tok/s;  19881 sec
[2019-09-08 14:01:17,939 INFO] Step 19700/10000000; acc:  47.69; ppl: 13.62; xent: 2.61; lr: 0.00008; 3334/3714 tok/s;  19929 sec
[2019-09-08 14:02:06,444 INFO] Step 19750/10000000; acc:  48.43; ppl: 13.07; xent: 2.57; lr: 0.00008; 3317/3715 tok/s;  19977 sec
[2019-09-08 14:02:54,263 INFO] Step 19800/10000000; acc:  48.67; ppl: 13.10; xent: 2.57; lr: 0.00008; 3234/3827 tok/s;  20025 sec
[2019-09-08 14:03:43,646 INFO] Step 19850/10000000; acc:  48.91; ppl: 12.60; xent: 2.53; lr: 0.00008; 3301/3664 tok/s;  20075 sec
[2019-09-08 14:04:31,537 INFO] Step 19900/10000000; acc:  50.18; ppl: 12.07; xent: 2.49; lr: 0.00008; 3217/3758 tok/s;  20123 sec
[2019-09-08 14:05:19,560 INFO] Step 19950/10000000; acc:  48.66; ppl: 12.73; xent: 2.54; lr: 0.00008; 3316/3681 tok/s;  20171 sec
[2019-09-08 14:06:07,452 INFO] Step 20000/10000000; acc:  50.47; ppl: 11.83; xent: 2.47; lr: 0.00008; 3282/3726 tok/s;  20218 sec
[2019-09-08 14:06:07,454 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-08 14:06:09,150 INFO] number of examples: 100000
[2019-09-08 14:13:40,856 INFO] Validation perplexity: 29.0335
[2019-09-08 14:13:40,857 INFO] Validation accuracy: 41.456
[2019-09-08 14:13:45,270 INFO] Saving checkpoint ./transformer_model_step_20000.pt
[2019-09-08 14:14:41,207 INFO] Step 20050/10000000; acc:  49.25; ppl: 12.35; xent: 2.51; lr: 0.00008; 307/342 tok/s;  20732 sec
[2019-09-08 14:15:30,000 INFO] Step 20100/10000000; acc:  51.04; ppl: 11.33; xent: 2.43; lr: 0.00008; 3223/3746 tok/s;  20781 sec
[2019-09-08 14:16:21,577 INFO] Step 20150/10000000; acc:  49.59; ppl: 11.82; xent: 2.47; lr: 0.00008; 3109/3579 tok/s;  20833 sec
[2019-09-08 14:17:09,903 INFO] Step 20200/10000000; acc:  51.21; ppl: 11.17; xent: 2.41; lr: 0.00008; 3202/3741 tok/s;  20881 sec
[2019-09-08 14:17:57,977 INFO] Step 20250/10000000; acc:  50.32; ppl: 11.72; xent: 2.46; lr: 0.00008; 3216/3757 tok/s;  20929 sec
[2019-09-08 14:18:46,425 INFO] Step 20300/10000000; acc:  51.71; ppl: 10.81; xent: 2.38; lr: 0.00008; 3228/3696 tok/s;  20977 sec
[2019-09-08 14:19:34,496 INFO] Step 20350/10000000; acc:  50.34; ppl: 11.38; xent: 2.43; lr: 0.00008; 3439/3706 tok/s;  21025 sec
[2019-09-08 14:20:22,980 INFO] Step 20400/10000000; acc:  50.90; ppl: 11.16; xent: 2.41; lr: 0.00008; 3257/3771 tok/s;  21074 sec
[2019-09-08 14:21:10,862 INFO] Step 20450/10000000; acc:  51.66; ppl: 10.75; xent: 2.38; lr: 0.00008; 3176/3784 tok/s;  21122 sec
[2019-09-08 14:21:58,982 INFO] Step 20500/10000000; acc:  51.68; ppl: 10.66; xent: 2.37; lr: 0.00008; 3388/3730 tok/s;  21170 sec
[2019-09-08 14:22:47,200 INFO] Step 20550/10000000; acc:  51.75; ppl: 10.57; xent: 2.36; lr: 0.00008; 3300/3759 tok/s;  21218 sec
[2019-09-08 14:23:35,792 INFO] Step 20600/10000000; acc:  52.30; ppl: 10.30; xent: 2.33; lr: 0.00008; 3262/3755 tok/s;  21267 sec
[2019-09-08 14:24:23,348 INFO] Step 20650/10000000; acc:  52.45; ppl: 10.41; xent: 2.34; lr: 0.00008; 3274/3711 tok/s;  21314 sec
[2019-09-08 14:25:09,995 INFO] Step 20700/10000000; acc:  51.66; ppl: 10.67; xent: 2.37; lr: 0.00008; 3274/3665 tok/s;  21361 sec
[2019-09-08 14:25:59,102 INFO] Step 20750/10000000; acc:  51.85; ppl: 10.43; xent: 2.35; lr: 0.00008; 3256/3745 tok/s;  21410 sec
[2019-09-08 14:26:47,972 INFO] Step 20800/10000000; acc:  51.02; ppl: 10.85; xent: 2.38; lr: 0.00008; 3265/3633 tok/s;  21459 sec
[2019-09-08 14:27:36,120 INFO] Step 20850/10000000; acc:  52.49; ppl: 10.18; xent: 2.32; lr: 0.00008; 3290/3720 tok/s;  21507 sec
[2019-09-08 14:28:25,521 INFO] Step 20900/10000000; acc:  52.25; ppl: 10.10; xent: 2.31; lr: 0.00008; 3307/3673 tok/s;  21556 sec
[2019-09-08 14:29:13,715 INFO] Step 20950/10000000; acc:  52.07; ppl: 10.27; xent: 2.33; lr: 0.00008; 3236/3653 tok/s;  21605 sec
[2019-09-08 14:30:02,171 INFO] Step 21000/10000000; acc:  51.29; ppl: 10.67; xent: 2.37; lr: 0.00008; 3156/3650 tok/s;  21653 sec
[2019-09-08 14:30:06,615 INFO] Saving checkpoint ./transformer_model_step_21000.pt
[2019-09-08 14:31:04,340 INFO] Step 21050/10000000; acc:  52.27; ppl: 10.24; xent: 2.33; lr: 0.00008; 2517/2830 tok/s;  21715 sec
[2019-09-08 14:31:52,186 INFO] Step 21100/10000000; acc:  53.88; ppl:  9.36; xent: 2.24; lr: 0.00008; 3232/3841 tok/s;  21763 sec
[2019-09-08 14:32:39,441 INFO] Step 21150/10000000; acc:  51.65; ppl: 10.51; xent: 2.35; lr: 0.00008; 3353/3653 tok/s;  21810 sec
[2019-09-08 14:33:27,598 INFO] Step 21200/10000000; acc:  53.70; ppl:  9.47; xent: 2.25; lr: 0.00008; 3244/3756 tok/s;  21859 sec
[2019-09-08 14:34:15,864 INFO] Step 21250/10000000; acc:  52.17; ppl:  9.97; xent: 2.30; lr: 0.00008; 3180/3756 tok/s;  21907 sec
[2019-09-08 14:35:05,337 INFO] Step 21300/10000000; acc:  54.17; ppl:  9.21; xent: 2.22; lr: 0.00008; 3211/3615 tok/s;  21956 sec
[2019-09-08 14:35:53,340 INFO] Step 21350/10000000; acc:  53.42; ppl:  9.40; xent: 2.24; lr: 0.00008; 3368/3758 tok/s;  22004 sec
[2019-09-08 14:36:41,770 INFO] Step 21400/10000000; acc:  54.67; ppl:  8.88; xent: 2.18; lr: 0.00008; 3220/3709 tok/s;  22053 sec
[2019-09-08 14:37:29,896 INFO] Step 21450/10000000; acc:  53.98; ppl:  9.15; xent: 2.21; lr: 0.00008; 3358/3790 tok/s;  22101 sec
[2019-09-08 14:38:18,687 INFO] Step 21500/10000000; acc:  54.66; ppl:  8.71; xent: 2.16; lr: 0.00008; 3143/3724 tok/s;  22150 sec
[2019-09-08 14:39:06,036 INFO] Step 21550/10000000; acc:  55.28; ppl:  8.57; xent: 2.15; lr: 0.00008; 3309/3737 tok/s;  22197 sec
[2019-09-08 14:39:53,529 INFO] Step 21600/10000000; acc:  53.63; ppl:  9.28; xent: 2.23; lr: 0.00008; 3300/3666 tok/s;  22245 sec
[2019-09-08 14:40:41,756 INFO] Step 21650/10000000; acc:  53.90; ppl:  9.13; xent: 2.21; lr: 0.00008; 3304/3669 tok/s;  22293 sec
[2019-09-08 14:41:30,660 INFO] Step 21700/10000000; acc:  54.09; ppl:  8.92; xent: 2.19; lr: 0.00008; 3175/3745 tok/s;  22342 sec
[2019-09-08 14:42:18,683 INFO] Step 21750/10000000; acc:  54.80; ppl:  8.64; xent: 2.16; lr: 0.00008; 3342/3739 tok/s;  22390 sec
[2019-09-08 14:43:07,925 INFO] Step 21800/10000000; acc:  53.63; ppl:  9.18; xent: 2.22; lr: 0.00009; 3080/3734 tok/s;  22439 sec
[2019-09-08 14:43:56,982 INFO] Step 21850/10000000; acc:  54.46; ppl:  8.64; xent: 2.16; lr: 0.00009; 3254/3722 tok/s;  22488 sec
[2019-09-08 14:44:45,361 INFO] Step 21900/10000000; acc:  54.41; ppl:  9.04; xent: 2.20; lr: 0.00009; 3190/3781 tok/s;  22536 sec
[2019-09-08 14:45:33,067 INFO] Step 21950/10000000; acc:  54.05; ppl:  8.79; xent: 2.17; lr: 0.00009; 3193/3731 tok/s;  22584 sec
[2019-09-08 14:46:20,966 INFO] Step 22000/10000000; acc:  54.53; ppl:  8.83; xent: 2.18; lr: 0.00009; 3313/3754 tok/s;  22632 sec
[2019-09-08 14:46:25,375 INFO] Saving checkpoint ./transformer_model_step_22000.pt
[2019-09-08 14:47:23,916 INFO] Step 22050/10000000; acc:  54.49; ppl:  8.69; xent: 2.16; lr: 0.00009; 2585/2832 tok/s;  22695 sec
[2019-09-08 14:48:12,491 INFO] Step 22100/10000000; acc:  55.12; ppl:  8.49; xent: 2.14; lr: 0.00009; 3187/3680 tok/s;  22743 sec
[2019-09-08 14:49:01,491 INFO] Step 22150/10000000; acc:  55.95; ppl:  8.07; xent: 2.09; lr: 0.00009; 3194/3820 tok/s;  22792 sec
[2019-09-08 14:49:49,414 INFO] Step 22200/10000000; acc:  55.55; ppl:  8.29; xent: 2.11; lr: 0.00009; 3284/3733 tok/s;  22840 sec
[2019-09-08 14:50:37,352 INFO] Step 22250/10000000; acc:  55.74; ppl:  8.26; xent: 2.11; lr: 0.00009; 3201/3649 tok/s;  22888 sec
[2019-09-08 14:51:25,433 INFO] Step 22300/10000000; acc:  55.57; ppl:  8.32; xent: 2.12; lr: 0.00009; 3348/3712 tok/s;  22936 sec
[2019-09-08 14:52:14,200 INFO] Step 22350/10000000; acc:  55.98; ppl:  7.99; xent: 2.08; lr: 0.00009; 3212/3702 tok/s;  22985 sec
[2019-09-08 14:52:24,227 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 14:52:48,183 INFO] number of examples: 805546
[2019-09-08 14:53:33,192 INFO] Step 22400/10000000; acc:  43.72; ppl: 18.13; xent: 2.90; lr: 0.00009; 2021/2301 tok/s;  23064 sec
[2019-09-08 14:54:21,598 INFO] Step 22450/10000000; acc:  41.55; ppl: 21.63; xent: 3.07; lr: 0.00009; 3241/3720 tok/s;  23113 sec
[2019-09-08 14:55:11,004 INFO] Step 22500/10000000; acc:  42.41; ppl: 19.33; xent: 2.96; lr: 0.00009; 3387/3752 tok/s;  23162 sec
[2019-09-08 14:56:00,354 INFO] Step 22550/10000000; acc:  42.24; ppl: 19.58; xent: 2.97; lr: 0.00009; 3241/3811 tok/s;  23211 sec
[2019-09-08 14:56:47,589 INFO] Step 22600/10000000; acc:  43.44; ppl: 18.46; xent: 2.92; lr: 0.00009; 3430/3739 tok/s;  23259 sec
[2019-09-08 14:57:35,940 INFO] Step 22650/10000000; acc:  43.32; ppl: 18.24; xent: 2.90; lr: 0.00009; 3275/3732 tok/s;  23307 sec
[2019-09-08 14:58:24,033 INFO] Step 22700/10000000; acc:  43.40; ppl: 17.93; xent: 2.89; lr: 0.00009; 3387/3786 tok/s;  23355 sec
[2019-09-08 14:59:12,575 INFO] Step 22750/10000000; acc:  43.73; ppl: 18.26; xent: 2.90; lr: 0.00009; 3288/3763 tok/s;  23404 sec
[2019-09-08 15:00:00,900 INFO] Step 22800/10000000; acc:  42.98; ppl: 18.51; xent: 2.92; lr: 0.00009; 3429/3746 tok/s;  23452 sec
[2019-09-08 15:00:48,603 INFO] Step 22850/10000000; acc:  46.42; ppl: 15.68; xent: 2.75; lr: 0.00009; 3167/3823 tok/s;  23500 sec
[2019-09-08 15:01:37,380 INFO] Step 22900/10000000; acc:  42.84; ppl: 18.07; xent: 2.89; lr: 0.00009; 3388/3738 tok/s;  23548 sec
[2019-09-08 15:02:25,527 INFO] Step 22950/10000000; acc:  44.00; ppl: 17.31; xent: 2.85; lr: 0.00009; 3430/3752 tok/s;  23597 sec
[2019-09-08 15:03:13,916 INFO] Step 23000/10000000; acc:  44.00; ppl: 17.30; xent: 2.85; lr: 0.00009; 3324/3728 tok/s;  23645 sec
[2019-09-08 15:03:18,332 INFO] Saving checkpoint ./transformer_model_step_23000.pt
[2019-09-08 15:04:15,230 INFO] Step 23050/10000000; acc:  43.75; ppl: 17.36; xent: 2.85; lr: 0.00009; 2666/2959 tok/s;  23706 sec
[2019-09-08 15:05:03,513 INFO] Step 23100/10000000; acc:  44.80; ppl: 16.17; xent: 2.78; lr: 0.00009; 3254/3808 tok/s;  23754 sec
[2019-09-08 15:05:52,359 INFO] Step 23150/10000000; acc:  43.67; ppl: 17.13; xent: 2.84; lr: 0.00009; 3335/3703 tok/s;  23803 sec
[2019-09-08 15:06:40,209 INFO] Step 23200/10000000; acc:  45.47; ppl: 15.98; xent: 2.77; lr: 0.00009; 3271/3683 tok/s;  23851 sec
[2019-09-08 15:07:28,939 INFO] Step 23250/10000000; acc:  44.49; ppl: 16.60; xent: 2.81; lr: 0.00009; 3245/3742 tok/s;  23900 sec
[2019-09-08 15:08:17,582 INFO] Step 23300/10000000; acc:  45.09; ppl: 16.10; xent: 2.78; lr: 0.00009; 3281/3814 tok/s;  23949 sec
[2019-09-08 15:09:06,407 INFO] Step 23350/10000000; acc:  44.20; ppl: 16.81; xent: 2.82; lr: 0.00009; 3267/3773 tok/s;  23997 sec
[2019-09-08 15:09:54,619 INFO] Step 23400/10000000; acc:  44.73; ppl: 16.07; xent: 2.78; lr: 0.00009; 3410/3719 tok/s;  24046 sec
[2019-09-08 15:10:43,749 INFO] Step 23450/10000000; acc:  44.36; ppl: 15.76; xent: 2.76; lr: 0.00009; 3337/3770 tok/s;  24095 sec
[2019-09-08 15:11:33,229 INFO] Step 23500/10000000; acc:  44.52; ppl: 16.08; xent: 2.78; lr: 0.00009; 3269/3757 tok/s;  24144 sec
[2019-09-08 15:12:23,982 INFO] Step 23550/10000000; acc:  44.20; ppl: 16.46; xent: 2.80; lr: 0.00009; 3173/3538 tok/s;  24195 sec
[2019-09-08 15:13:12,220 INFO] Step 23600/10000000; acc:  45.50; ppl: 15.15; xent: 2.72; lr: 0.00009; 3319/3746 tok/s;  24243 sec
[2019-09-08 15:14:00,954 INFO] Step 23650/10000000; acc:  45.78; ppl: 14.62; xent: 2.68; lr: 0.00009; 3303/3837 tok/s;  24292 sec
[2019-09-08 15:14:49,527 INFO] Step 23700/10000000; acc:  44.09; ppl: 16.09; xent: 2.78; lr: 0.00009; 3365/3719 tok/s;  24341 sec
[2019-09-08 15:15:36,431 INFO] Step 23750/10000000; acc:  46.79; ppl: 14.68; xent: 2.69; lr: 0.00009; 3283/3758 tok/s;  24387 sec
[2019-09-08 15:16:25,217 INFO] Step 23800/10000000; acc:  45.87; ppl: 14.84; xent: 2.70; lr: 0.00009; 3414/3709 tok/s;  24436 sec
[2019-09-08 15:17:14,130 INFO] Step 23850/10000000; acc:  44.97; ppl: 15.52; xent: 2.74; lr: 0.00009; 3272/3704 tok/s;  24485 sec
[2019-09-08 15:18:02,540 INFO] Step 23900/10000000; acc:  46.16; ppl: 14.71; xent: 2.69; lr: 0.00009; 3301/3729 tok/s;  24534 sec
[2019-09-08 15:18:50,734 INFO] Step 23950/10000000; acc:  45.83; ppl: 14.82; xent: 2.70; lr: 0.00009; 3386/3740 tok/s;  24582 sec
[2019-09-08 15:19:40,162 INFO] Step 24000/10000000; acc:  44.94; ppl: 15.08; xent: 2.71; lr: 0.00009; 3256/3773 tok/s;  24631 sec
[2019-09-08 15:19:44,578 INFO] Saving checkpoint ./transformer_model_step_24000.pt
[2019-09-08 15:20:41,118 INFO] Step 24050/10000000; acc:  45.18; ppl: 14.90; xent: 2.70; lr: 0.00009; 2749/3046 tok/s;  24692 sec
[2019-09-08 15:21:30,240 INFO] Step 24100/10000000; acc:  45.77; ppl: 14.80; xent: 2.69; lr: 0.00009; 3292/3824 tok/s;  24741 sec
[2019-09-08 15:22:18,906 INFO] Step 24150/10000000; acc:  44.61; ppl: 15.43; xent: 2.74; lr: 0.00009; 3300/3693 tok/s;  24790 sec
[2019-09-08 15:23:08,784 INFO] Step 24200/10000000; acc:  46.78; ppl: 13.75; xent: 2.62; lr: 0.00009; 3222/3764 tok/s;  24840 sec
[2019-09-08 15:23:57,692 INFO] Step 24250/10000000; acc:  45.62; ppl: 14.81; xent: 2.70; lr: 0.00009; 3300/3783 tok/s;  24889 sec
[2019-09-08 15:24:45,656 INFO] Step 24300/10000000; acc:  45.84; ppl: 14.51; xent: 2.67; lr: 0.00009; 3376/3741 tok/s;  24937 sec
[2019-09-08 15:25:34,598 INFO] Step 24350/10000000; acc:  45.36; ppl: 14.92; xent: 2.70; lr: 0.00010; 3201/3675 tok/s;  24986 sec
[2019-09-08 15:26:21,910 INFO] Step 24400/10000000; acc:  47.00; ppl: 14.03; xent: 2.64; lr: 0.00010; 3312/3641 tok/s;  25033 sec
[2019-09-08 15:27:11,020 INFO] Step 24450/10000000; acc:  46.35; ppl: 13.98; xent: 2.64; lr: 0.00010; 3260/3781 tok/s;  25082 sec
[2019-09-08 15:27:59,573 INFO] Step 24500/10000000; acc:  46.32; ppl: 14.01; xent: 2.64; lr: 0.00010; 3295/3761 tok/s;  25131 sec
[2019-09-08 15:28:46,915 INFO] Step 24550/10000000; acc:  47.51; ppl: 13.49; xent: 2.60; lr: 0.00010; 3396/3765 tok/s;  25178 sec
[2019-09-08 15:29:34,993 INFO] Step 24600/10000000; acc:  46.50; ppl: 14.00; xent: 2.64; lr: 0.00010; 3213/3764 tok/s;  25226 sec
[2019-09-08 15:30:23,449 INFO] Step 24650/10000000; acc:  45.99; ppl: 14.29; xent: 2.66; lr: 0.00010; 3292/3696 tok/s;  25274 sec
[2019-09-08 15:31:13,657 INFO] Step 24700/10000000; acc:  46.61; ppl: 13.43; xent: 2.60; lr: 0.00010; 3286/3731 tok/s;  25325 sec
[2019-09-08 15:32:02,200 INFO] Step 24750/10000000; acc:  46.83; ppl: 13.60; xent: 2.61; lr: 0.00010; 3279/3702 tok/s;  25373 sec
[2019-09-08 15:32:50,750 INFO] Step 24800/10000000; acc:  45.43; ppl: 14.15; xent: 2.65; lr: 0.00010; 3264/3649 tok/s;  25422 sec
[2019-09-08 15:33:39,082 INFO] Step 24850/10000000; acc:  48.09; ppl: 12.90; xent: 2.56; lr: 0.00010; 3174/3698 tok/s;  25470 sec
[2019-09-08 15:34:27,838 INFO] Step 24900/10000000; acc:  45.95; ppl: 13.85; xent: 2.63; lr: 0.00010; 3321/3659 tok/s;  25519 sec
[2019-09-08 15:35:17,216 INFO] Step 24950/10000000; acc:  45.92; ppl: 13.82; xent: 2.63; lr: 0.00010; 3299/3673 tok/s;  25568 sec
[2019-09-08 15:36:05,984 INFO] Step 25000/10000000; acc:  47.13; ppl: 13.24; xent: 2.58; lr: 0.00010; 3208/3659 tok/s;  25617 sec
[2019-09-08 15:36:10,389 INFO] Saving checkpoint ./transformer_model_step_25000.pt
[2019-09-08 15:37:07,394 INFO] Step 25050/10000000; acc:  46.49; ppl: 13.71; xent: 2.62; lr: 0.00010; 2579/2872 tok/s;  25678 sec
[2019-09-08 15:37:56,156 INFO] Step 25100/10000000; acc:  47.06; ppl: 13.35; xent: 2.59; lr: 0.00010; 3319/3701 tok/s;  25727 sec
[2019-09-08 15:38:45,020 INFO] Step 25150/10000000; acc:  48.12; ppl: 12.59; xent: 2.53; lr: 0.00010; 3154/3737 tok/s;  25776 sec
[2019-09-08 15:39:33,401 INFO] Step 25200/10000000; acc:  46.88; ppl: 13.35; xent: 2.59; lr: 0.00010; 3365/3679 tok/s;  25824 sec
[2019-09-08 15:40:22,865 INFO] Step 25250/10000000; acc:  46.00; ppl: 14.03; xent: 2.64; lr: 0.00010; 3150/3652 tok/s;  25874 sec
[2019-09-08 15:40:30,785 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 15:40:50,482 INFO] number of examples: 947346
[2019-09-08 15:41:36,163 INFO] Step 25300/10000000; acc:  50.83; ppl: 10.47; xent: 2.35; lr: 0.00010; 2157/2431 tok/s;  25947 sec
[2019-09-08 15:42:24,400 INFO] Step 25350/10000000; acc:  52.63; ppl:  9.44; xent: 2.24; lr: 0.00010; 3244/3722 tok/s;  25995 sec
[2019-09-08 15:43:12,255 INFO] Step 25400/10000000; acc:  53.87; ppl:  8.86; xent: 2.18; lr: 0.00010; 3417/3658 tok/s;  26043 sec
[2019-09-08 15:44:00,804 INFO] Step 25450/10000000; acc:  55.39; ppl:  8.33; xent: 2.12; lr: 0.00010; 3253/3719 tok/s;  26092 sec
[2019-09-08 15:44:49,206 INFO] Step 25500/10000000; acc:  54.84; ppl:  8.51; xent: 2.14; lr: 0.00010; 3196/3745 tok/s;  26140 sec
[2019-09-08 15:45:38,180 INFO] Step 25550/10000000; acc:  55.19; ppl:  8.12; xent: 2.09; lr: 0.00010; 3303/3699 tok/s;  26189 sec
[2019-09-08 15:46:26,343 INFO] Step 25600/10000000; acc:  55.41; ppl:  8.04; xent: 2.08; lr: 0.00010; 3369/3721 tok/s;  26237 sec
[2019-09-08 15:47:13,308 INFO] Step 25650/10000000; acc:  57.27; ppl:  7.42; xent: 2.00; lr: 0.00010; 3314/3700 tok/s;  26284 sec
[2019-09-08 15:48:02,491 INFO] Step 25700/10000000; acc:  56.73; ppl:  7.59; xent: 2.03; lr: 0.00010; 3284/3790 tok/s;  26333 sec
[2019-09-08 15:48:50,613 INFO] Step 25750/10000000; acc:  57.05; ppl:  7.63; xent: 2.03; lr: 0.00010; 3140/3752 tok/s;  26382 sec
[2019-09-08 15:49:38,402 INFO] Step 25800/10000000; acc:  57.06; ppl:  7.53; xent: 2.02; lr: 0.00010; 3271/3747 tok/s;  26429 sec
[2019-09-08 15:50:26,594 INFO] Step 25850/10000000; acc:  57.51; ppl:  7.29; xent: 1.99; lr: 0.00010; 3184/3738 tok/s;  26478 sec
[2019-09-08 15:51:15,585 INFO] Step 25900/10000000; acc:  56.19; ppl:  7.72; xent: 2.04; lr: 0.00010; 3075/3746 tok/s;  26527 sec
[2019-09-08 15:52:04,006 INFO] Step 25950/10000000; acc:  56.84; ppl:  7.34; xent: 1.99; lr: 0.00010; 3317/3734 tok/s;  26575 sec
[2019-09-08 15:52:51,679 INFO] Step 26000/10000000; acc:  57.47; ppl:  7.31; xent: 1.99; lr: 0.00010; 3259/3751 tok/s;  26623 sec
[2019-09-08 15:52:56,103 INFO] Saving checkpoint ./transformer_model_step_26000.pt
[2019-09-08 15:53:53,211 INFO] Step 26050/10000000; acc:  56.31; ppl:  7.56; xent: 2.02; lr: 0.00010; 2600/2950 tok/s;  26684 sec
[2019-09-08 15:54:40,937 INFO] Step 26100/10000000; acc:  56.98; ppl:  7.44; xent: 2.01; lr: 0.00010; 3259/3788 tok/s;  26732 sec
[2019-09-08 15:55:29,989 INFO] Step 26150/10000000; acc:  57.46; ppl:  7.12; xent: 1.96; lr: 0.00010; 3311/3732 tok/s;  26781 sec
[2019-09-08 15:56:18,393 INFO] Step 26200/10000000; acc:  58.27; ppl:  6.97; xent: 1.94; lr: 0.00010; 3196/3696 tok/s;  26829 sec
[2019-09-08 15:57:06,550 INFO] Step 26250/10000000; acc:  57.58; ppl:  7.13; xent: 1.96; lr: 0.00010; 3291/3698 tok/s;  26878 sec
[2019-09-08 15:57:54,804 INFO] Step 26300/10000000; acc:  58.00; ppl:  6.95; xent: 1.94; lr: 0.00010; 3287/3729 tok/s;  26926 sec
[2019-09-08 15:58:41,943 INFO] Step 26350/10000000; acc:  58.41; ppl:  7.05; xent: 1.95; lr: 0.00010; 3313/3738 tok/s;  26973 sec
[2019-09-08 15:59:30,302 INFO] Step 26400/10000000; acc:  58.70; ppl:  6.73; xent: 1.91; lr: 0.00010; 3298/3749 tok/s;  27021 sec
[2019-09-08 16:00:22,118 INFO] Step 26450/10000000; acc:  58.59; ppl:  6.63; xent: 1.89; lr: 0.00010; 3059/3503 tok/s;  27073 sec
[2019-09-08 16:01:10,650 INFO] Step 26500/10000000; acc:  59.79; ppl:  6.46; xent: 1.86; lr: 0.00010; 3197/3773 tok/s;  27122 sec
[2019-09-08 16:01:58,367 INFO] Step 26550/10000000; acc:  58.60; ppl:  6.81; xent: 1.92; lr: 0.00010; 3282/3698 tok/s;  27169 sec
[2019-09-08 16:02:46,987 INFO] Step 26600/10000000; acc:  59.55; ppl:  6.43; xent: 1.86; lr: 0.00010; 3197/3740 tok/s;  27218 sec
[2019-09-08 16:03:35,305 INFO] Step 26650/10000000; acc:  59.45; ppl:  6.45; xent: 1.86; lr: 0.00010; 3380/3712 tok/s;  27266 sec
[2019-09-08 16:04:23,631 INFO] Step 26700/10000000; acc:  59.60; ppl:  6.42; xent: 1.86; lr: 0.00010; 3322/3767 tok/s;  27315 sec
[2019-09-08 16:05:11,578 INFO] Step 26750/10000000; acc:  59.19; ppl:  6.56; xent: 1.88; lr: 0.00010; 3136/3760 tok/s;  27363 sec
[2019-09-08 16:05:59,514 INFO] Step 26800/10000000; acc:  60.44; ppl:  6.17; xent: 1.82; lr: 0.00010; 3351/3741 tok/s;  27410 sec
[2019-09-08 16:06:48,492 INFO] Step 26850/10000000; acc:  59.65; ppl:  6.35; xent: 1.85; lr: 0.00010; 3352/3737 tok/s;  27459 sec
[2019-09-08 16:07:36,802 INFO] Step 26900/10000000; acc:  60.41; ppl:  6.11; xent: 1.81; lr: 0.00011; 3266/3795 tok/s;  27508 sec
[2019-09-08 16:08:24,830 INFO] Step 26950/10000000; acc:  60.55; ppl:  6.09; xent: 1.81; lr: 0.00011; 3274/3699 tok/s;  27556 sec
[2019-09-08 16:09:11,658 INFO] Step 27000/10000000; acc:  60.60; ppl:  6.20; xent: 1.83; lr: 0.00011; 3250/3662 tok/s;  27603 sec
[2019-09-08 16:09:16,086 INFO] Saving checkpoint ./transformer_model_step_27000.pt
[2019-09-08 16:10:13,091 INFO] Step 27050/10000000; acc:  60.11; ppl:  6.26; xent: 1.83; lr: 0.00011; 2543/2900 tok/s;  27664 sec
[2019-09-08 16:11:02,523 INFO] Step 27100/10000000; acc:  60.00; ppl:  6.24; xent: 1.83; lr: 0.00011; 3295/3724 tok/s;  27714 sec
[2019-09-08 16:11:50,462 INFO] Step 27150/10000000; acc:  60.08; ppl:  6.24; xent: 1.83; lr: 0.00011; 3260/3673 tok/s;  27761 sec
[2019-09-08 16:12:39,905 INFO] Step 27200/10000000; acc:  60.99; ppl:  5.98; xent: 1.79; lr: 0.00011; 3314/3638 tok/s;  27811 sec
[2019-09-08 16:13:28,167 INFO] Step 27250/10000000; acc:  60.98; ppl:  6.04; xent: 1.80; lr: 0.00011; 3246/3701 tok/s;  27859 sec
[2019-09-08 16:14:16,766 INFO] Step 27300/10000000; acc:  60.21; ppl:  6.16; xent: 1.82; lr: 0.00011; 3179/3692 tok/s;  27908 sec
[2019-09-08 16:15:04,500 INFO] Step 27350/10000000; acc:  60.94; ppl:  6.11; xent: 1.81; lr: 0.00011; 3257/3695 tok/s;  27955 sec
[2019-09-08 16:15:51,873 INFO] Step 27400/10000000; acc:  60.57; ppl:  6.13; xent: 1.81; lr: 0.00011; 3256/3735 tok/s;  28003 sec
[2019-09-08 16:16:39,801 INFO] Step 27450/10000000; acc:  60.77; ppl:  6.03; xent: 1.80; lr: 0.00011; 3256/3702 tok/s;  28051 sec
[2019-09-08 16:17:27,515 INFO] Step 27500/10000000; acc:  61.33; ppl:  5.88; xent: 1.77; lr: 0.00011; 3351/3733 tok/s;  28098 sec
[2019-09-08 16:18:15,721 INFO] Step 27550/10000000; acc:  60.98; ppl:  5.91; xent: 1.78; lr: 0.00011; 3160/3759 tok/s;  28147 sec
[2019-09-08 16:19:05,900 INFO] Step 27600/10000000; acc:  62.04; ppl:  5.71; xent: 1.74; lr: 0.00011; 3120/3679 tok/s;  28197 sec
[2019-09-08 16:19:53,676 INFO] Step 27650/10000000; acc:  61.72; ppl:  5.71; xent: 1.74; lr: 0.00011; 3357/3691 tok/s;  28245 sec
[2019-09-08 16:20:42,057 INFO] Step 27700/10000000; acc:  62.10; ppl:  5.65; xent: 1.73; lr: 0.00011; 3285/3742 tok/s;  28293 sec
[2019-09-08 16:21:29,813 INFO] Step 27750/10000000; acc:  62.53; ppl:  5.56; xent: 1.72; lr: 0.00011; 3383/3716 tok/s;  28341 sec
[2019-09-08 16:22:18,288 INFO] Step 27800/10000000; acc:  63.24; ppl:  5.36; xent: 1.68; lr: 0.00011; 3160/3737 tok/s;  28389 sec
[2019-09-08 16:23:06,272 INFO] Step 27850/10000000; acc:  63.04; ppl:  5.38; xent: 1.68; lr: 0.00011; 3303/3723 tok/s;  28437 sec
[2019-09-08 16:23:54,308 INFO] Step 27900/10000000; acc:  62.90; ppl:  5.45; xent: 1.70; lr: 0.00011; 3275/3741 tok/s;  28485 sec
[2019-09-08 16:24:41,913 INFO] Step 27950/10000000; acc:  61.48; ppl:  5.82; xent: 1.76; lr: 0.00011; 3274/3631 tok/s;  28533 sec
[2019-09-08 16:25:30,574 INFO] Step 28000/10000000; acc:  62.99; ppl:  5.41; xent: 1.69; lr: 0.00011; 3201/3786 tok/s;  28582 sec
[2019-09-08 16:25:35,006 INFO] Saving checkpoint ./transformer_model_step_28000.pt
[2019-09-08 16:26:32,868 INFO] Step 28050/10000000; acc:  63.02; ppl:  5.38; xent: 1.68; lr: 0.00011; 2621/2870 tok/s;  28644 sec
[2019-09-08 16:27:21,481 INFO] Step 28100/10000000; acc:  62.23; ppl:  5.65; xent: 1.73; lr: 0.00011; 3154/3755 tok/s;  28692 sec
[2019-09-08 16:28:11,438 INFO] Step 28150/10000000; acc:  62.39; ppl:  5.47; xent: 1.70; lr: 0.00011; 3172/3702 tok/s;  28742 sec
[2019-09-08 16:28:59,249 INFO] Step 28200/10000000; acc:  63.21; ppl:  5.51; xent: 1.71; lr: 0.00011; 3214/3812 tok/s;  28790 sec
[2019-09-08 16:29:47,027 INFO] Step 28250/10000000; acc:  62.94; ppl:  5.46; xent: 1.70; lr: 0.00011; 3199/3694 tok/s;  28838 sec
[2019-09-08 16:30:35,204 INFO] Step 28300/10000000; acc:  62.11; ppl:  5.64; xent: 1.73; lr: 0.00011; 3195/3768 tok/s;  28886 sec
[2019-09-08 16:31:23,031 INFO] Step 28350/10000000; acc:  63.16; ppl:  5.36; xent: 1.68; lr: 0.00011; 3396/3664 tok/s;  28934 sec
[2019-09-08 16:32:12,044 INFO] Step 28400/10000000; acc:  63.45; ppl:  5.26; xent: 1.66; lr: 0.00011; 3268/3734 tok/s;  28983 sec
[2019-09-08 16:33:00,291 INFO] Step 28450/10000000; acc:  63.55; ppl:  5.33; xent: 1.67; lr: 0.00011; 3168/3744 tok/s;  29031 sec
[2019-09-08 16:33:48,753 INFO] Step 28500/10000000; acc:  64.14; ppl:  5.12; xent: 1.63; lr: 0.00011; 3233/3753 tok/s;  29080 sec
[2019-09-08 16:34:37,122 INFO] Step 28550/10000000; acc:  64.20; ppl:  5.12; xent: 1.63; lr: 0.00011; 3240/3690 tok/s;  29128 sec
[2019-09-08 16:35:24,978 INFO] Step 28600/10000000; acc:  63.89; ppl:  5.29; xent: 1.67; lr: 0.00011; 3262/3677 tok/s;  29176 sec
[2019-09-08 16:36:13,583 INFO] Step 28650/10000000; acc:  64.41; ppl:  5.12; xent: 1.63; lr: 0.00011; 3272/3682 tok/s;  29225 sec
[2019-09-08 16:36:38,499 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 16:37:03,013 INFO] number of examples: 805546
[2019-09-08 16:37:33,608 INFO] Step 28700/10000000; acc:  54.91; ppl:  8.74; xent: 2.17; lr: 0.00011; 1999/2300 tok/s;  29305 sec
[2019-09-08 16:38:21,998 INFO] Step 28750/10000000; acc:  45.15; ppl: 15.78; xent: 2.76; lr: 0.00011; 3221/3698 tok/s;  29353 sec
[2019-09-08 16:39:11,151 INFO] Step 28800/10000000; acc:  46.88; ppl: 13.70; xent: 2.62; lr: 0.00011; 3373/3746 tok/s;  29402 sec
[2019-09-08 16:40:00,565 INFO] Step 28850/10000000; acc:  46.35; ppl: 13.98; xent: 2.64; lr: 0.00011; 3267/3783 tok/s;  29452 sec
[2019-09-08 16:40:48,558 INFO] Step 28900/10000000; acc:  47.19; ppl: 13.34; xent: 2.59; lr: 0.00011; 3353/3817 tok/s;  29500 sec
[2019-09-08 16:41:36,555 INFO] Step 28950/10000000; acc:  46.69; ppl: 13.54; xent: 2.61; lr: 0.00011; 3389/3707 tok/s;  29548 sec
[2019-09-08 16:42:24,226 INFO] Step 29000/10000000; acc:  47.78; ppl: 12.95; xent: 2.56; lr: 0.00011; 3343/3756 tok/s;  29595 sec
[2019-09-08 16:42:28,635 INFO] Saving checkpoint ./transformer_model_step_29000.pt
[2019-09-08 16:43:25,525 INFO] Step 29050/10000000; acc:  47.60; ppl: 12.88; xent: 2.56; lr: 0.00011; 2664/3004 tok/s;  29657 sec
[2019-09-08 16:44:13,581 INFO] Step 29100/10000000; acc:  47.18; ppl: 13.55; xent: 2.61; lr: 0.00011; 3300/3767 tok/s;  29705 sec
[2019-09-08 16:45:01,985 INFO] Step 29150/10000000; acc:  48.34; ppl: 12.34; xent: 2.51; lr: 0.00011; 3302/3770 tok/s;  29753 sec
[2019-09-08 16:45:50,213 INFO] Step 29200/10000000; acc:  47.53; ppl: 12.96; xent: 2.56; lr: 0.00011; 3281/3766 tok/s;  29801 sec
[2019-09-08 16:46:38,493 INFO] Step 29250/10000000; acc:  47.82; ppl: 12.46; xent: 2.52; lr: 0.00011; 3453/3787 tok/s;  29849 sec
[2019-09-08 16:47:26,703 INFO] Step 29300/10000000; acc:  47.53; ppl: 12.84; xent: 2.55; lr: 0.00011; 3394/3714 tok/s;  29898 sec
[2019-09-08 16:48:15,453 INFO] Step 29350/10000000; acc:  47.53; ppl: 12.88; xent: 2.56; lr: 0.00011; 3302/3715 tok/s;  29946 sec
[2019-09-08 16:49:03,834 INFO] Step 29400/10000000; acc:  48.76; ppl: 11.84; xent: 2.47; lr: 0.00011; 3297/3794 tok/s;  29995 sec
[2019-09-08 16:49:52,467 INFO] Step 29450/10000000; acc:  47.29; ppl: 12.52; xent: 2.53; lr: 0.00012; 3306/3697 tok/s;  30043 sec
[2019-09-08 16:50:41,032 INFO] Step 29500/10000000; acc:  48.43; ppl: 12.09; xent: 2.49; lr: 0.00012; 3259/3705 tok/s;  30092 sec
[2019-09-08 16:51:28,922 INFO] Step 29550/10000000; acc:  49.10; ppl: 11.98; xent: 2.48; lr: 0.00012; 3252/3753 tok/s;  30140 sec
[2019-09-08 16:52:18,153 INFO] Step 29600/10000000; acc:  48.35; ppl: 11.96; xent: 2.48; lr: 0.00012; 3284/3769 tok/s;  30189 sec
[2019-09-08 16:53:06,740 INFO] Step 29650/10000000; acc:  47.72; ppl: 12.45; xent: 2.52; lr: 0.00012; 3252/3770 tok/s;  30238 sec
[2019-09-08 16:53:55,373 INFO] Step 29700/10000000; acc:  49.05; ppl: 11.70; xent: 2.46; lr: 0.00012; 3364/3754 tok/s;  30286 sec
[2019-09-08 16:54:44,415 INFO] Step 29750/10000000; acc:  47.70; ppl: 11.95; xent: 2.48; lr: 0.00012; 3398/3756 tok/s;  30335 sec
[2019-09-08 16:55:33,997 INFO] Step 29800/10000000; acc:  47.94; ppl: 12.03; xent: 2.49; lr: 0.00012; 3290/3744 tok/s;  30385 sec
[2019-09-08 16:56:24,964 INFO] Step 29850/10000000; acc:  47.91; ppl: 12.19; xent: 2.50; lr: 0.00012; 3136/3501 tok/s;  30436 sec
[2019-09-08 16:57:13,192 INFO] Step 29900/10000000; acc:  49.06; ppl: 11.39; xent: 2.43; lr: 0.00012; 3247/3794 tok/s;  30484 sec
[2019-09-08 16:58:02,030 INFO] Step 29950/10000000; acc:  48.65; ppl: 11.34; xent: 2.43; lr: 0.00012; 3375/3787 tok/s;  30533 sec
[2019-09-08 16:58:50,270 INFO] Step 30000/10000000; acc:  48.30; ppl: 11.78; xent: 2.47; lr: 0.00012; 3341/3722 tok/s;  30581 sec
[2019-09-08 16:58:50,273 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-08 16:58:51,957 INFO] number of examples: 100000
[2019-09-08 17:06:13,720 INFO] Validation perplexity: 12.003
[2019-09-08 17:06:13,721 INFO] Validation accuracy: 52.0538
[2019-09-08 17:06:18,131 INFO] Saving checkpoint ./transformer_model_step_30000.pt
[2019-09-08 17:07:13,422 INFO] Step 30050/10000000; acc:  49.18; ppl: 11.46; xent: 2.44; lr: 0.00012; 312/353 tok/s;  31084 sec
[2019-09-08 17:08:01,675 INFO] Step 30100/10000000; acc:  49.84; ppl: 10.96; xent: 2.39; lr: 0.00012; 3385/3775 tok/s;  31133 sec
[2019-09-08 17:08:50,469 INFO] Step 30150/10000000; acc:  48.62; ppl: 11.61; xent: 2.45; lr: 0.00012; 3298/3651 tok/s;  31181 sec
[2019-09-08 17:09:39,120 INFO] Step 30200/10000000; acc:  49.23; ppl: 11.36; xent: 2.43; lr: 0.00012; 3263/3735 tok/s;  31230 sec
[2019-09-08 17:10:27,720 INFO] Step 30250/10000000; acc:  49.37; ppl: 11.13; xent: 2.41; lr: 0.00012; 3379/3802 tok/s;  31279 sec
[2019-09-08 17:11:17,060 INFO] Step 30300/10000000; acc:  47.78; ppl: 11.81; xent: 2.47; lr: 0.00012; 3266/3692 tok/s;  31328 sec
[2019-09-08 17:12:05,801 INFO] Step 30350/10000000; acc:  48.88; ppl: 11.27; xent: 2.42; lr: 0.00012; 3382/3769 tok/s;  31377 sec
[2019-09-08 17:12:54,821 INFO] Step 30400/10000000; acc:  49.00; ppl: 11.17; xent: 2.41; lr: 0.00012; 3340/3831 tok/s;  31426 sec
[2019-09-08 17:13:44,273 INFO] Step 30450/10000000; acc:  48.14; ppl: 11.66; xent: 2.46; lr: 0.00012; 3229/3713 tok/s;  31475 sec
[2019-09-08 17:14:32,839 INFO] Step 30500/10000000; acc:  49.99; ppl: 10.65; xent: 2.37; lr: 0.00012; 3283/3768 tok/s;  31524 sec
[2019-09-08 17:15:22,620 INFO] Step 30550/10000000; acc:  49.46; ppl: 10.89; xent: 2.39; lr: 0.00012; 3306/3786 tok/s;  31574 sec
[2019-09-08 17:16:10,784 INFO] Step 30600/10000000; acc:  48.93; ppl: 11.25; xent: 2.42; lr: 0.00012; 3328/3727 tok/s;  31622 sec
[2019-09-08 17:16:59,534 INFO] Step 30650/10000000; acc:  48.28; ppl: 11.73; xent: 2.46; lr: 0.00012; 3187/3701 tok/s;  31671 sec
[2019-09-08 17:17:47,230 INFO] Step 30700/10000000; acc:  50.04; ppl: 10.88; xent: 2.39; lr: 0.00012; 3334/3652 tok/s;  31718 sec
[2019-09-08 17:18:35,823 INFO] Step 30750/10000000; acc:  49.64; ppl: 10.79; xent: 2.38; lr: 0.00012; 3290/3759 tok/s;  31767 sec
[2019-09-08 17:19:24,495 INFO] Step 30800/10000000; acc:  49.95; ppl: 10.55; xent: 2.36; lr: 0.00012; 3311/3733 tok/s;  31815 sec
[2019-09-08 17:20:12,324 INFO] Step 30850/10000000; acc:  49.93; ppl: 10.76; xent: 2.38; lr: 0.00012; 3357/3788 tok/s;  31863 sec
[2019-09-08 17:21:00,364 INFO] Step 30900/10000000; acc:  49.87; ppl: 10.77; xent: 2.38; lr: 0.00012; 3225/3768 tok/s;  31911 sec
[2019-09-08 17:21:48,405 INFO] Step 30950/10000000; acc:  49.42; ppl: 10.93; xent: 2.39; lr: 0.00012; 3255/3682 tok/s;  31959 sec
[2019-09-08 17:22:38,578 INFO] Step 31000/10000000; acc:  49.55; ppl: 10.51; xent: 2.35; lr: 0.00012; 3361/3685 tok/s;  32010 sec
[2019-09-08 17:22:43,005 INFO] Saving checkpoint ./transformer_model_step_31000.pt
[2019-09-08 17:23:39,506 INFO] Step 31050/10000000; acc:  49.81; ppl: 10.72; xent: 2.37; lr: 0.00012; 2589/2989 tok/s;  32070 sec
[2019-09-08 17:24:28,317 INFO] Step 31100/10000000; acc:  49.02; ppl: 10.78; xent: 2.38; lr: 0.00012; 3220/3672 tok/s;  32119 sec
[2019-09-08 17:25:16,269 INFO] Step 31150/10000000; acc:  50.76; ppl: 10.19; xent: 2.32; lr: 0.00012; 3204/3721 tok/s;  32167 sec
[2019-09-08 17:26:04,853 INFO] Step 31200/10000000; acc:  49.17; ppl: 10.82; xent: 2.38; lr: 0.00012; 3334/3637 tok/s;  32216 sec
[2019-09-08 17:26:54,638 INFO] Step 31250/10000000; acc:  49.41; ppl: 10.42; xent: 2.34; lr: 0.00012; 3325/3696 tok/s;  32266 sec
[2019-09-08 17:27:43,467 INFO] Step 31300/10000000; acc:  49.47; ppl: 10.64; xent: 2.36; lr: 0.00012; 3226/3661 tok/s;  32314 sec
[2019-09-08 17:28:31,569 INFO] Step 31350/10000000; acc:  50.02; ppl: 10.60; xent: 2.36; lr: 0.00012; 3251/3689 tok/s;  32363 sec
[2019-09-08 17:29:19,825 INFO] Step 31400/10000000; acc:  50.09; ppl: 10.45; xent: 2.35; lr: 0.00012; 3354/3639 tok/s;  32411 sec
[2019-09-08 17:30:08,657 INFO] Step 31450/10000000; acc:  51.18; ppl:  9.98; xent: 2.30; lr: 0.00012; 3148/3720 tok/s;  32460 sec
[2019-09-08 17:30:57,528 INFO] Step 31500/10000000; acc:  49.28; ppl: 10.74; xent: 2.37; lr: 0.00012; 3307/3690 tok/s;  32509 sec
[2019-09-08 17:31:46,511 INFO] Step 31550/10000000; acc:  49.43; ppl: 10.72; xent: 2.37; lr: 0.00012; 3252/3699 tok/s;  32557 sec
[2019-09-08 17:32:08,409 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 17:32:33,321 INFO] number of examples: 947346
[2019-09-08 17:33:05,280 INFO] Step 31600/10000000; acc:  53.56; ppl:  8.57; xent: 2.15; lr: 0.00012; 1962/2249 tok/s;  32636 sec
[2019-09-08 17:33:53,719 INFO] Step 31650/10000000; acc:  58.56; ppl:  6.45; xent: 1.86; lr: 0.00012; 3311/3695 tok/s;  32685 sec
[2019-09-08 17:34:42,238 INFO] Step 31700/10000000; acc:  59.61; ppl:  6.16; xent: 1.82; lr: 0.00012; 3271/3682 tok/s;  32733 sec
[2019-09-08 17:35:29,927 INFO] Step 31750/10000000; acc:  61.88; ppl:  5.63; xent: 1.73; lr: 0.00012; 3319/3685 tok/s;  32781 sec
[2019-09-08 17:36:19,119 INFO] Step 31800/10000000; acc:  60.88; ppl:  5.88; xent: 1.77; lr: 0.00012; 3184/3764 tok/s;  32830 sec
[2019-09-08 17:37:07,644 INFO] Step 31850/10000000; acc:  62.20; ppl:  5.47; xent: 1.70; lr: 0.00012; 3300/3701 tok/s;  32879 sec
[2019-09-08 17:37:55,880 INFO] Step 31900/10000000; acc:  62.11; ppl:  5.49; xent: 1.70; lr: 0.00012; 3391/3740 tok/s;  32927 sec
[2019-09-08 17:38:43,291 INFO] Step 31950/10000000; acc:  63.03; ppl:  5.30; xent: 1.67; lr: 0.00012; 3320/3654 tok/s;  32974 sec
[2019-09-08 17:39:31,481 INFO] Step 32000/10000000; acc:  63.40; ppl:  5.24; xent: 1.66; lr: 0.00013; 3292/3796 tok/s;  33022 sec
[2019-09-08 17:39:35,900 INFO] Saving checkpoint ./transformer_model_step_32000.pt
[2019-09-08 17:40:33,494 INFO] Step 32050/10000000; acc:  63.67; ppl:  5.17; xent: 1.64; lr: 0.00013; 2520/2962 tok/s;  33084 sec
[2019-09-08 17:41:20,982 INFO] Step 32100/10000000; acc:  63.30; ppl:  5.30; xent: 1.67; lr: 0.00013; 3197/3743 tok/s;  33132 sec
[2019-09-08 17:42:08,844 INFO] Step 32150/10000000; acc:  64.21; ppl:  5.10; xent: 1.63; lr: 0.00013; 3243/3743 tok/s;  33180 sec
[2019-09-08 17:42:58,097 INFO] Step 32200/10000000; acc:  63.23; ppl:  5.28; xent: 1.66; lr: 0.00013; 3031/3703 tok/s;  33229 sec
[2019-09-08 17:43:46,497 INFO] Step 32250/10000000; acc:  63.85; ppl:  5.05; xent: 1.62; lr: 0.00013; 3284/3812 tok/s;  33277 sec
[2019-09-08 17:44:34,508 INFO] Step 32300/10000000; acc:  64.22; ppl:  5.01; xent: 1.61; lr: 0.00013; 3270/3732 tok/s;  33325 sec
[2019-09-08 17:45:23,014 INFO] Step 32350/10000000; acc:  63.21; ppl:  5.22; xent: 1.65; lr: 0.00013; 3292/3711 tok/s;  33374 sec
[2019-09-08 17:46:11,302 INFO] Step 32400/10000000; acc:  64.29; ppl:  5.06; xent: 1.62; lr: 0.00013; 3261/3784 tok/s;  33422 sec
[2019-09-08 17:46:59,604 INFO] Step 32450/10000000; acc:  64.56; ppl:  4.93; xent: 1.60; lr: 0.00013; 3263/3743 tok/s;  33471 sec
[2019-09-08 17:47:48,257 INFO] Step 32500/10000000; acc:  64.94; ppl:  4.83; xent: 1.57; lr: 0.00013; 3293/3702 tok/s;  33519 sec
[2019-09-08 17:48:36,752 INFO] Step 32550/10000000; acc:  64.48; ppl:  4.94; xent: 1.60; lr: 0.00013; 3206/3689 tok/s;  33568 sec
[2019-09-08 17:49:24,963 INFO] Step 32600/10000000; acc:  64.27; ppl:  4.95; xent: 1.60; lr: 0.00013; 3356/3737 tok/s;  33616 sec
[2019-09-08 17:50:12,002 INFO] Step 32650/10000000; acc:  64.66; ppl:  5.01; xent: 1.61; lr: 0.00013; 3309/3764 tok/s;  33663 sec
[2019-09-08 17:51:00,273 INFO] Step 32700/10000000; acc:  65.51; ppl:  4.72; xent: 1.55; lr: 0.00013; 3236/3720 tok/s;  33711 sec
[2019-09-08 17:51:51,734 INFO] Step 32750/10000000; acc:  66.53; ppl:  4.50; xent: 1.50; lr: 0.00013; 3108/3495 tok/s;  33763 sec
[2019-09-08 17:52:40,664 INFO] Step 32800/10000000; acc:  66.58; ppl:  4.53; xent: 1.51; lr: 0.00013; 3192/3759 tok/s;  33812 sec
[2019-09-08 17:53:28,203 INFO] Step 32850/10000000; acc:  65.57; ppl:  4.75; xent: 1.56; lr: 0.00013; 3321/3697 tok/s;  33859 sec
[2019-09-08 17:54:17,022 INFO] Step 32900/10000000; acc:  66.12; ppl:  4.60; xent: 1.53; lr: 0.00013; 3150/3769 tok/s;  33908 sec
[2019-09-08 17:55:05,499 INFO] Step 32950/10000000; acc:  66.12; ppl:  4.56; xent: 1.52; lr: 0.00013; 3333/3687 tok/s;  33956 sec
[2019-09-08 17:55:53,802 INFO] Step 33000/10000000; acc:  66.04; ppl:  4.61; xent: 1.53; lr: 0.00013; 3328/3747 tok/s;  34005 sec
[2019-09-08 17:55:58,238 INFO] Saving checkpoint ./transformer_model_step_33000.pt
[2019-09-08 17:56:54,974 INFO] Step 33050/10000000; acc:  65.95; ppl:  4.64; xent: 1.54; lr: 0.00013; 2505/2964 tok/s;  34066 sec
[2019-09-08 17:57:43,031 INFO] Step 33100/10000000; acc:  66.48; ppl:  4.51; xent: 1.51; lr: 0.00013; 3330/3763 tok/s;  34114 sec
[2019-09-08 17:58:31,904 INFO] Step 33150/10000000; acc:  67.15; ppl:  4.38; xent: 1.48; lr: 0.00013; 3361/3693 tok/s;  34163 sec
[2019-09-08 17:59:19,832 INFO] Step 33200/10000000; acc:  66.79; ppl:  4.42; xent: 1.49; lr: 0.00013; 3237/3827 tok/s;  34211 sec
[2019-09-08 18:00:07,987 INFO] Step 33250/10000000; acc:  66.71; ppl:  4.46; xent: 1.49; lr: 0.00013; 3366/3688 tok/s;  34259 sec
[2019-09-08 18:00:54,802 INFO] Step 33300/10000000; acc:  67.35; ppl:  4.38; xent: 1.48; lr: 0.00013; 3218/3646 tok/s;  34306 sec
[2019-09-08 18:01:42,803 INFO] Step 33350/10000000; acc:  66.96; ppl:  4.45; xent: 1.49; lr: 0.00013; 3165/3730 tok/s;  34354 sec
[2019-09-08 18:02:31,603 INFO] Step 33400/10000000; acc:  66.75; ppl:  4.45; xent: 1.49; lr: 0.00013; 3323/3753 tok/s;  34403 sec
[2019-09-08 18:03:20,472 INFO] Step 33450/10000000; acc:  66.72; ppl:  4.51; xent: 1.51; lr: 0.00013; 3289/3647 tok/s;  34451 sec
[2019-09-08 18:04:09,624 INFO] Step 33500/10000000; acc:  67.92; ppl:  4.21; xent: 1.44; lr: 0.00013; 3303/3682 tok/s;  34501 sec
[2019-09-08 18:04:57,816 INFO] Step 33550/10000000; acc:  67.23; ppl:  4.40; xent: 1.48; lr: 0.00013; 3223/3638 tok/s;  34549 sec
[2019-09-08 18:05:46,409 INFO] Step 33600/10000000; acc:  67.63; ppl:  4.28; xent: 1.45; lr: 0.00013; 3293/3723 tok/s;  34597 sec
[2019-09-08 18:06:34,674 INFO] Step 33650/10000000; acc:  66.80; ppl:  4.53; xent: 1.51; lr: 0.00013; 3147/3684 tok/s;  34646 sec
[2019-09-08 18:07:21,963 INFO] Step 33700/10000000; acc:  67.11; ppl:  4.46; xent: 1.50; lr: 0.00013; 3259/3689 tok/s;  34693 sec
[2019-09-08 18:08:09,498 INFO] Step 33750/10000000; acc:  67.20; ppl:  4.37; xent: 1.47; lr: 0.00013; 3251/3740 tok/s;  34740 sec
[2019-09-08 18:08:57,804 INFO] Step 33800/10000000; acc:  66.89; ppl:  4.46; xent: 1.50; lr: 0.00013; 3359/3712 tok/s;  34789 sec
[2019-09-08 18:09:45,947 INFO] Step 33850/10000000; acc:  68.49; ppl:  4.19; xent: 1.43; lr: 0.00013; 3121/3792 tok/s;  34837 sec
[2019-09-08 18:10:36,276 INFO] Step 33900/10000000; acc:  68.10; ppl:  4.21; xent: 1.44; lr: 0.00013; 3143/3627 tok/s;  34887 sec
[2019-09-08 18:11:23,852 INFO] Step 33950/10000000; acc:  68.01; ppl:  4.25; xent: 1.45; lr: 0.00013; 3354/3716 tok/s;  34935 sec
[2019-09-08 18:12:11,694 INFO] Step 34000/10000000; acc:  68.37; ppl:  4.19; xent: 1.43; lr: 0.00013; 3299/3773 tok/s;  34983 sec
[2019-09-08 18:12:16,116 INFO] Saving checkpoint ./transformer_model_step_34000.pt
[2019-09-08 18:13:13,837 INFO] Step 34050/10000000; acc:  69.03; ppl:  4.05; xent: 1.40; lr: 0.00013; 2565/2895 tok/s;  35045 sec
[2019-09-08 18:14:02,133 INFO] Step 34100/10000000; acc:  68.95; ppl:  4.05; xent: 1.40; lr: 0.00013; 3290/3712 tok/s;  35093 sec
[2019-09-08 18:14:50,031 INFO] Step 34150/10000000; acc:  69.69; ppl:  3.94; xent: 1.37; lr: 0.00013; 3195/3757 tok/s;  35141 sec
[2019-09-08 18:15:38,116 INFO] Step 34200/10000000; acc:  69.26; ppl:  3.98; xent: 1.38; lr: 0.00013; 3359/3761 tok/s;  35189 sec
[2019-09-08 18:16:25,715 INFO] Step 34250/10000000; acc:  67.73; ppl:  4.32; xent: 1.46; lr: 0.00013; 3205/3594 tok/s;  35237 sec
[2019-09-08 18:17:14,276 INFO] Step 34300/10000000; acc:  68.83; ppl:  4.06; xent: 1.40; lr: 0.00013; 3269/3787 tok/s;  35285 sec
[2019-09-08 18:18:03,002 INFO] Step 34350/10000000; acc:  68.60; ppl:  4.09; xent: 1.41; lr: 0.00013; 3303/3699 tok/s;  35334 sec
[2019-09-08 18:18:50,844 INFO] Step 34400/10000000; acc:  68.84; ppl:  4.14; xent: 1.42; lr: 0.00013; 3263/3717 tok/s;  35382 sec
[2019-09-08 18:19:40,436 INFO] Step 34450/10000000; acc:  68.76; ppl:  4.06; xent: 1.40; lr: 0.00013; 3138/3727 tok/s;  35431 sec
[2019-09-08 18:20:29,241 INFO] Step 34500/10000000; acc:  69.46; ppl:  4.01; xent: 1.39; lr: 0.00013; 3131/3818 tok/s;  35480 sec
[2019-09-08 18:21:17,321 INFO] Step 34550/10000000; acc:  68.66; ppl:  4.11; xent: 1.41; lr: 0.00013; 3231/3708 tok/s;  35528 sec
[2019-09-08 18:22:05,080 INFO] Step 34600/10000000; acc:  68.42; ppl:  4.18; xent: 1.43; lr: 0.00014; 3243/3705 tok/s;  35576 sec
[2019-09-08 18:22:52,973 INFO] Step 34650/10000000; acc:  68.56; ppl:  4.11; xent: 1.41; lr: 0.00014; 3389/3709 tok/s;  35624 sec
[2019-09-08 18:23:41,950 INFO] Step 34700/10000000; acc:  69.20; ppl:  4.00; xent: 1.39; lr: 0.00014; 3230/3689 tok/s;  35673 sec
[2019-09-08 18:24:30,334 INFO] Step 34750/10000000; acc:  69.25; ppl:  4.03; xent: 1.39; lr: 0.00014; 3163/3727 tok/s;  35721 sec
[2019-09-08 18:25:19,216 INFO] Step 34800/10000000; acc:  69.50; ppl:  3.93; xent: 1.37; lr: 0.00014; 3226/3785 tok/s;  35770 sec
[2019-09-08 18:26:07,644 INFO] Step 34850/10000000; acc:  70.52; ppl:  3.77; xent: 1.33; lr: 0.00014; 3232/3701 tok/s;  35819 sec
[2019-09-08 18:26:55,480 INFO] Step 34900/10000000; acc:  70.54; ppl:  3.91; xent: 1.36; lr: 0.00014; 3199/3673 tok/s;  35866 sec
[2019-09-08 18:27:43,591 INFO] Step 34950/10000000; acc:  69.42; ppl:  3.97; xent: 1.38; lr: 0.00014; 3376/3669 tok/s;  35915 sec
[2019-09-08 18:28:22,240 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 18:28:46,755 INFO] number of examples: 805546
[2019-09-08 18:29:03,584 INFO] Step 35000/10000000; acc:  65.93; ppl:  4.81; xent: 1.57; lr: 0.00014; 2013/2326 tok/s;  35995 sec
[2019-09-08 18:29:08,004 INFO] Saving checkpoint ./transformer_model_step_35000.pt
[2019-09-08 18:30:04,230 INFO] Step 35050/10000000; acc:  47.89; ppl: 12.59; xent: 2.53; lr: 0.00014; 2584/2930 tok/s;  36055 sec
[2019-09-08 18:30:53,213 INFO] Step 35100/10000000; acc:  48.70; ppl: 11.64; xent: 2.45; lr: 0.00014; 3296/3707 tok/s;  36104 sec
[2019-09-08 18:31:43,103 INFO] Step 35150/10000000; acc:  48.92; ppl: 11.19; xent: 2.41; lr: 0.00014; 3316/3777 tok/s;  36154 sec
[2019-09-08 18:32:31,299 INFO] Step 35200/10000000; acc:  49.15; ppl: 11.29; xent: 2.42; lr: 0.00014; 3277/3808 tok/s;  36202 sec
[2019-09-08 18:33:19,147 INFO] Step 35250/10000000; acc:  49.40; ppl: 11.06; xent: 2.40; lr: 0.00014; 3386/3703 tok/s;  36250 sec
[2019-09-08 18:34:06,767 INFO] Step 35300/10000000; acc:  49.81; ppl: 10.89; xent: 2.39; lr: 0.00014; 3390/3727 tok/s;  36298 sec
[2019-09-08 18:34:55,474 INFO] Step 35350/10000000; acc:  50.36; ppl: 10.41; xent: 2.34; lr: 0.00014; 3281/3776 tok/s;  36346 sec
[2019-09-08 18:35:44,060 INFO] Step 35400/10000000; acc:  49.60; ppl: 10.95; xent: 2.39; lr: 0.00014; 3282/3804 tok/s;  36395 sec
[2019-09-08 18:36:32,269 INFO] Step 35450/10000000; acc:  50.30; ppl: 10.50; xent: 2.35; lr: 0.00014; 3414/3748 tok/s;  36443 sec
[2019-09-08 18:37:20,716 INFO] Step 35500/10000000; acc:  50.80; ppl: 10.20; xent: 2.32; lr: 0.00014; 3192/3765 tok/s;  36492 sec
[2019-09-08 18:38:09,183 INFO] Step 35550/10000000; acc:  49.68; ppl: 10.68; xent: 2.37; lr: 0.00014; 3388/3801 tok/s;  36540 sec
[2019-09-08 18:38:57,115 INFO] Step 35600/10000000; acc:  49.82; ppl: 10.64; xent: 2.36; lr: 0.00014; 3454/3720 tok/s;  36588 sec
[2019-09-08 18:39:45,872 INFO] Step 35650/10000000; acc:  50.04; ppl: 10.51; xent: 2.35; lr: 0.00014; 3309/3715 tok/s;  36637 sec
[2019-09-08 18:40:34,486 INFO] Step 35700/10000000; acc:  50.96; ppl:  9.97; xent: 2.30; lr: 0.00014; 3313/3750 tok/s;  36685 sec
[2019-09-08 18:41:22,979 INFO] Step 35750/10000000; acc:  50.05; ppl: 10.18; xent: 2.32; lr: 0.00014; 3267/3712 tok/s;  36734 sec
[2019-09-08 18:42:11,794 INFO] Step 35800/10000000; acc:  50.28; ppl: 10.26; xent: 2.33; lr: 0.00014; 3286/3711 tok/s;  36783 sec
[2019-09-08 18:42:59,765 INFO] Step 35850/10000000; acc:  51.26; ppl:  9.82; xent: 2.28; lr: 0.00014; 3309/3728 tok/s;  36831 sec
[2019-09-08 18:43:49,124 INFO] Step 35900/10000000; acc:  50.74; ppl:  9.96; xent: 2.30; lr: 0.00014; 3261/3769 tok/s;  36880 sec
[2019-09-08 18:44:37,131 INFO] Step 35950/10000000; acc:  50.19; ppl: 10.49; xent: 2.35; lr: 0.00014; 3204/3776 tok/s;  36928 sec
[2019-09-08 18:45:26,135 INFO] Step 36000/10000000; acc:  51.36; ppl:  9.60; xent: 2.26; lr: 0.00014; 3354/3796 tok/s;  36977 sec
[2019-09-08 18:45:30,561 INFO] Saving checkpoint ./transformer_model_step_36000.pt
[2019-09-08 18:46:28,508 INFO] Step 36050/10000000; acc:  50.02; ppl: 10.22; xent: 2.32; lr: 0.00014; 2637/2885 tok/s;  37039 sec
[2019-09-08 18:47:18,026 INFO] Step 36100/10000000; acc:  50.36; ppl:  9.87; xent: 2.29; lr: 0.00014; 3331/3746 tok/s;  37089 sec
[2019-09-08 18:48:09,358 INFO] Step 36150/10000000; acc:  49.62; ppl: 10.34; xent: 2.34; lr: 0.00014; 3101/3504 tok/s;  37140 sec
[2019-09-08 18:48:57,936 INFO] Step 36200/10000000; acc:  51.08; ppl:  9.75; xent: 2.28; lr: 0.00014; 3260/3824 tok/s;  37189 sec
[2019-09-08 18:49:46,516 INFO] Step 36250/10000000; acc:  50.88; ppl:  9.74; xent: 2.28; lr: 0.00014; 3369/3730 tok/s;  37237 sec
[2019-09-08 18:50:34,925 INFO] Step 36300/10000000; acc:  51.22; ppl:  9.53; xent: 2.25; lr: 0.00014; 3321/3778 tok/s;  37286 sec
[2019-09-08 18:51:22,938 INFO] Step 36350/10000000; acc:  50.52; ppl:  9.85; xent: 2.29; lr: 0.00014; 3371/3741 tok/s;  37334 sec
[2019-09-08 18:52:10,779 INFO] Step 36400/10000000; acc:  52.81; ppl:  9.11; xent: 2.21; lr: 0.00014; 3306/3769 tok/s;  37382 sec
[2019-09-08 18:52:59,063 INFO] Step 36450/10000000; acc:  51.08; ppl:  9.65; xent: 2.27; lr: 0.00014; 3359/3629 tok/s;  37430 sec
[2019-09-08 18:53:48,304 INFO] Step 36500/10000000; acc:  50.17; ppl:  9.99; xent: 2.30; lr: 0.00014; 3296/3750 tok/s;  37479 sec
[2019-09-08 18:54:36,133 INFO] Step 36550/10000000; acc:  52.70; ppl:  8.92; xent: 2.19; lr: 0.00014; 3330/3770 tok/s;  37527 sec
[2019-09-08 18:55:25,447 INFO] Step 36600/10000000; acc:  50.21; ppl:  9.88; xent: 2.29; lr: 0.00014; 3321/3732 tok/s;  37576 sec
[2019-09-08 18:56:14,431 INFO] Step 36650/10000000; acc:  51.12; ppl:  9.42; xent: 2.24; lr: 0.00014; 3322/3758 tok/s;  37625 sec
[2019-09-08 18:57:03,493 INFO] Step 36700/10000000; acc:  50.64; ppl:  9.67; xent: 2.27; lr: 0.00014; 3358/3813 tok/s;  37674 sec
[2019-09-08 18:57:52,728 INFO] Step 36750/10000000; acc:  50.72; ppl:  9.71; xent: 2.27; lr: 0.00014; 3270/3772 tok/s;  37724 sec
[2019-09-08 18:58:41,376 INFO] Step 36800/10000000; acc:  51.21; ppl:  9.48; xent: 2.25; lr: 0.00014; 3263/3694 tok/s;  37772 sec
[2019-09-08 18:59:31,150 INFO] Step 36850/10000000; acc:  52.53; ppl:  8.75; xent: 2.17; lr: 0.00014; 3304/3813 tok/s;  37822 sec
[2019-09-08 19:00:19,541 INFO] Step 36900/10000000; acc:  50.77; ppl:  9.82; xent: 2.28; lr: 0.00014; 3275/3744 tok/s;  37871 sec
[2019-09-08 19:01:08,028 INFO] Step 36950/10000000; acc:  50.80; ppl:  9.72; xent: 2.27; lr: 0.00014; 3279/3694 tok/s;  37919 sec
[2019-09-08 19:01:56,209 INFO] Step 37000/10000000; acc:  50.78; ppl:  9.74; xent: 2.28; lr: 0.00014; 3248/3680 tok/s;  37967 sec
[2019-09-08 19:02:00,642 INFO] Saving checkpoint ./transformer_model_step_37000.pt
[2019-09-08 19:02:56,981 INFO] Step 37050/10000000; acc:  52.44; ppl:  8.89; xent: 2.18; lr: 0.00014; 2653/2954 tok/s;  38028 sec
[2019-09-08 19:03:45,850 INFO] Step 37100/10000000; acc:  51.70; ppl:  9.11; xent: 2.21; lr: 0.00014; 3287/3750 tok/s;  38077 sec
[2019-09-08 19:04:33,998 INFO] Step 37150/10000000; acc:  51.75; ppl:  9.21; xent: 2.22; lr: 0.00015; 3331/3769 tok/s;  38125 sec
[2019-09-08 19:05:21,621 INFO] Step 37200/10000000; acc:  52.70; ppl:  8.78; xent: 2.17; lr: 0.00015; 3342/3758 tok/s;  38173 sec
[2019-09-08 19:06:09,672 INFO] Step 37250/10000000; acc:  50.83; ppl:  9.73; xent: 2.28; lr: 0.00015; 3118/3699 tok/s;  38221 sec
[2019-09-08 19:06:58,491 INFO] Step 37300/10000000; acc:  52.00; ppl:  8.84; xent: 2.18; lr: 0.00015; 3433/3783 tok/s;  38269 sec
[2019-09-08 19:07:48,961 INFO] Step 37350/10000000; acc:  51.56; ppl:  9.23; xent: 2.22; lr: 0.00015; 3193/3633 tok/s;  38320 sec
[2019-09-08 19:08:37,544 INFO] Step 37400/10000000; acc:  51.79; ppl:  8.97; xent: 2.19; lr: 0.00015; 3244/3692 tok/s;  38369 sec
[2019-09-08 19:09:25,211 INFO] Step 37450/10000000; acc:  52.03; ppl:  9.00; xent: 2.20; lr: 0.00015; 3236/3686 tok/s;  38416 sec
[2019-09-08 19:10:14,201 INFO] Step 37500/10000000; acc:  52.17; ppl:  8.93; xent: 2.19; lr: 0.00015; 3221/3645 tok/s;  38465 sec
[2019-09-08 19:11:03,430 INFO] Step 37550/10000000; acc:  51.26; ppl:  9.02; xent: 2.20; lr: 0.00015; 3366/3728 tok/s;  38514 sec
[2019-09-08 19:11:53,004 INFO] Step 37600/10000000; acc:  51.46; ppl:  9.12; xent: 2.21; lr: 0.00015; 3237/3653 tok/s;  38564 sec
[2019-09-08 19:12:41,439 INFO] Step 37650/10000000; acc:  52.06; ppl:  8.98; xent: 2.19; lr: 0.00015; 3275/3675 tok/s;  38612 sec
[2019-09-08 19:13:29,565 INFO] Step 37700/10000000; acc:  51.96; ppl:  8.97; xent: 2.19; lr: 0.00015; 3287/3633 tok/s;  38661 sec
[2019-09-08 19:14:18,094 INFO] Step 37750/10000000; acc:  53.22; ppl:  8.63; xent: 2.16; lr: 0.00015; 3252/3729 tok/s;  38709 sec
[2019-09-08 19:15:07,265 INFO] Step 37800/10000000; acc:  52.10; ppl:  8.92; xent: 2.19; lr: 0.00015; 3197/3705 tok/s;  38758 sec
[2019-09-08 19:15:55,687 INFO] Step 37850/10000000; acc:  51.32; ppl:  9.16; xent: 2.22; lr: 0.00015; 3341/3695 tok/s;  38807 sec
[2019-09-08 19:16:32,593 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 19:16:52,385 INFO] number of examples: 947346
[2019-09-08 19:17:10,110 INFO] Step 37900/10000000; acc:  53.26; ppl:  8.38; xent: 2.13; lr: 0.00015; 2072/2377 tok/s;  38881 sec
[2019-09-08 19:17:58,430 INFO] Step 37950/10000000; acc:  63.03; ppl:  5.09; xent: 1.63; lr: 0.00015; 3320/3723 tok/s;  38929 sec
[2019-09-08 19:18:46,703 INFO] Step 38000/10000000; acc:  64.78; ppl:  4.85; xent: 1.58; lr: 0.00015; 3235/3729 tok/s;  38978 sec
[2019-09-08 19:18:51,131 INFO] Saving checkpoint ./transformer_model_step_38000.pt
[2019-09-08 19:19:48,413 INFO] Step 38050/10000000; acc:  65.84; ppl:  4.57; xent: 1.52; lr: 0.00015; 2649/2823 tok/s;  39039 sec
[2019-09-08 19:20:37,364 INFO] Step 38100/10000000; acc:  66.28; ppl:  4.55; xent: 1.51; lr: 0.00015; 3174/3775 tok/s;  39088 sec
[2019-09-08 19:21:25,754 INFO] Step 38150/10000000; acc:  67.03; ppl:  4.34; xent: 1.47; lr: 0.00015; 3231/3705 tok/s;  39137 sec
[2019-09-08 19:22:14,357 INFO] Step 38200/10000000; acc:  67.01; ppl:  4.30; xent: 1.46; lr: 0.00015; 3377/3706 tok/s;  39185 sec
[2019-09-08 19:23:02,386 INFO] Step 38250/10000000; acc:  67.99; ppl:  4.18; xent: 1.43; lr: 0.00015; 3294/3694 tok/s;  39233 sec
[2019-09-08 19:23:49,642 INFO] Step 38300/10000000; acc:  68.15; ppl:  4.15; xent: 1.42; lr: 0.00015; 3320/3741 tok/s;  39281 sec
[2019-09-08 19:24:39,226 INFO] Step 38350/10000000; acc:  68.19; ppl:  4.12; xent: 1.42; lr: 0.00015; 3265/3787 tok/s;  39330 sec
[2019-09-08 19:25:26,565 INFO] Step 38400/10000000; acc:  67.94; ppl:  4.26; xent: 1.45; lr: 0.00015; 3157/3734 tok/s;  39378 sec
[2019-09-08 19:26:14,674 INFO] Step 38450/10000000; acc:  68.21; ppl:  4.13; xent: 1.42; lr: 0.00015; 3253/3739 tok/s;  39426 sec
[2019-09-08 19:27:03,650 INFO] Step 38500/10000000; acc:  68.53; ppl:  4.07; xent: 1.40; lr: 0.00015; 3137/3666 tok/s;  39475 sec
[2019-09-08 19:27:52,282 INFO] Step 38550/10000000; acc:  68.52; ppl:  4.06; xent: 1.40; lr: 0.00015; 3116/3835 tok/s;  39523 sec
[2019-09-08 19:28:40,366 INFO] Step 38600/10000000; acc:  68.92; ppl:  3.98; xent: 1.38; lr: 0.00015; 3295/3713 tok/s;  39571 sec
[2019-09-08 19:29:28,779 INFO] Step 38650/10000000; acc:  68.36; ppl:  4.09; xent: 1.41; lr: 0.00015; 3280/3720 tok/s;  39620 sec
[2019-09-08 19:30:17,155 INFO] Step 38700/10000000; acc:  69.30; ppl:  3.93; xent: 1.37; lr: 0.00015; 3334/3715 tok/s;  39668 sec
[2019-09-08 19:31:05,616 INFO] Step 38750/10000000; acc:  68.89; ppl:  4.01; xent: 1.39; lr: 0.00015; 3223/3799 tok/s;  39717 sec
[2019-09-08 19:31:54,764 INFO] Step 38800/10000000; acc:  69.58; ppl:  3.88; xent: 1.36; lr: 0.00015; 3264/3685 tok/s;  39766 sec
[2019-09-08 19:32:42,877 INFO] Step 38850/10000000; acc:  69.50; ppl:  3.93; xent: 1.37; lr: 0.00015; 3201/3710 tok/s;  39814 sec
[2019-09-08 19:33:30,804 INFO] Step 38900/10000000; acc:  69.24; ppl:  3.92; xent: 1.37; lr: 0.00015; 3331/3703 tok/s;  39862 sec
[2019-09-08 19:34:18,885 INFO] Step 38950/10000000; acc:  69.36; ppl:  3.97; xent: 1.38; lr: 0.00015; 3242/3758 tok/s;  39910 sec
[2019-09-08 19:35:06,450 INFO] Step 39000/10000000; acc:  69.92; ppl:  3.86; xent: 1.35; lr: 0.00015; 3330/3652 tok/s;  39957 sec
[2019-09-08 19:35:10,872 INFO] Saving checkpoint ./transformer_model_step_39000.pt
[2019-09-08 19:36:08,650 INFO] Step 39050/10000000; acc:  70.77; ppl:  3.68; xent: 1.30; lr: 0.00015; 2571/2941 tok/s;  40020 sec
[2019-09-08 19:36:59,975 INFO] Step 39100/10000000; acc:  71.43; ppl:  3.56; xent: 1.27; lr: 0.00015; 3069/3579 tok/s;  40071 sec
[2019-09-08 19:37:48,182 INFO] Step 39150/10000000; acc:  70.53; ppl:  3.76; xent: 1.32; lr: 0.00015; 3219/3737 tok/s;  40119 sec
[2019-09-08 19:38:36,466 INFO] Step 39200/10000000; acc:  70.16; ppl:  3.80; xent: 1.33; lr: 0.00015; 3231/3721 tok/s;  40167 sec
[2019-09-08 19:39:24,995 INFO] Step 39250/10000000; acc:  71.22; ppl:  3.63; xent: 1.29; lr: 0.00015; 3239/3745 tok/s;  40216 sec
[2019-09-08 19:40:12,997 INFO] Step 39300/10000000; acc:  70.36; ppl:  3.75; xent: 1.32; lr: 0.00015; 3437/3699 tok/s;  40264 sec
[2019-09-08 19:41:01,474 INFO] Step 39350/10000000; acc:  70.63; ppl:  3.72; xent: 1.31; lr: 0.00015; 3235/3791 tok/s;  40312 sec
[2019-09-08 19:41:49,382 INFO] Step 39400/10000000; acc:  70.49; ppl:  3.74; xent: 1.32; lr: 0.00015; 3213/3757 tok/s;  40360 sec
[2019-09-08 19:42:37,826 INFO] Step 39450/10000000; acc:  71.34; ppl:  3.60; xent: 1.28; lr: 0.00015; 3351/3741 tok/s;  40409 sec
[2019-09-08 19:43:26,013 INFO] Step 39500/10000000; acc:  71.11; ppl:  3.61; xent: 1.28; lr: 0.00015; 3268/3753 tok/s;  40457 sec
[2019-09-08 19:44:14,708 INFO] Step 39550/10000000; acc:  71.56; ppl:  3.54; xent: 1.26; lr: 0.00015; 3289/3753 tok/s;  40506 sec
[2019-09-08 19:45:02,008 INFO] Step 39600/10000000; acc:  71.56; ppl:  3.61; xent: 1.28; lr: 0.00015; 3256/3678 tok/s;  40553 sec
[2019-09-08 19:45:48,839 INFO] Step 39650/10000000; acc:  70.91; ppl:  3.66; xent: 1.30; lr: 0.00015; 3294/3665 tok/s;  40600 sec
[2019-09-08 19:46:38,238 INFO] Step 39700/10000000; acc:  71.18; ppl:  3.62; xent: 1.29; lr: 0.00016; 3257/3712 tok/s;  40649 sec
[2019-09-08 19:47:26,974 INFO] Step 39750/10000000; acc:  71.17; ppl:  3.65; xent: 1.30; lr: 0.00016; 3241/3680 tok/s;  40698 sec
[2019-09-08 19:48:15,212 INFO] Step 39800/10000000; acc:  71.80; ppl:  3.54; xent: 1.26; lr: 0.00016; 3315/3695 tok/s;  40746 sec
[2019-09-08 19:49:04,323 INFO] Step 39850/10000000; acc:  71.87; ppl:  3.56; xent: 1.27; lr: 0.00016; 3259/3633 tok/s;  40795 sec
[2019-09-08 19:49:52,978 INFO] Step 39900/10000000; acc:  71.98; ppl:  3.49; xent: 1.25; lr: 0.00016; 3267/3720 tok/s;  40844 sec
[2019-09-08 19:50:41,224 INFO] Step 39950/10000000; acc:  71.56; ppl:  3.63; xent: 1.29; lr: 0.00016; 3105/3652 tok/s;  40892 sec
[2019-09-08 19:51:28,735 INFO] Step 40000/10000000; acc:  70.79; ppl:  3.73; xent: 1.32; lr: 0.00016; 3309/3689 tok/s;  40940 sec
[2019-09-08 19:51:28,737 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-08 19:51:34,967 INFO] number of examples: 100000
[2019-09-08 19:58:57,166 INFO] Validation perplexity: 12.8477
[2019-09-08 19:58:57,167 INFO] Validation accuracy: 50.2851
[2019-09-08 19:59:01,594 INFO] Saving checkpoint ./transformer_model_step_40000.pt
[2019-09-08 19:59:57,768 INFO] Step 40050/10000000; acc:  71.53; ppl:  3.57; xent: 1.27; lr: 0.00016; 305/352 tok/s;  41449 sec
[2019-09-08 20:00:45,918 INFO] Step 40100/10000000; acc:  70.32; ppl:  3.77; xent: 1.33; lr: 0.00016; 3341/3687 tok/s;  41497 sec
[2019-09-08 20:01:33,914 INFO] Step 40150/10000000; acc:  72.14; ppl:  3.52; xent: 1.26; lr: 0.00016; 3134/3751 tok/s;  41545 sec
[2019-09-08 20:02:22,503 INFO] Step 40200/10000000; acc:  72.41; ppl:  3.41; xent: 1.23; lr: 0.00016; 3269/3762 tok/s;  41593 sec
[2019-09-08 20:03:11,771 INFO] Step 40250/10000000; acc:  71.64; ppl:  3.58; xent: 1.28; lr: 0.00016; 3168/3627 tok/s;  41643 sec
[2019-09-08 20:03:59,705 INFO] Step 40300/10000000; acc:  72.17; ppl:  3.45; xent: 1.24; lr: 0.00016; 3372/3740 tok/s;  41691 sec
[2019-09-08 20:04:48,151 INFO] Step 40350/10000000; acc:  72.15; ppl:  3.46; xent: 1.24; lr: 0.00016; 3280/3716 tok/s;  41739 sec
[2019-09-08 20:05:36,452 INFO] Step 40400/10000000; acc:  72.40; ppl:  3.44; xent: 1.23; lr: 0.00016; 3323/3758 tok/s;  41787 sec
[2019-09-08 20:06:25,183 INFO] Step 40450/10000000; acc:  73.61; ppl:  3.27; xent: 1.19; lr: 0.00016; 3109/3752 tok/s;  41836 sec
[2019-09-08 20:07:12,728 INFO] Step 40500/10000000; acc:  72.78; ppl:  3.37; xent: 1.22; lr: 0.00016; 3368/3718 tok/s;  41884 sec
[2019-09-08 20:08:00,193 INFO] Step 40550/10000000; acc:  72.11; ppl:  3.51; xent: 1.26; lr: 0.00016; 3248/3651 tok/s;  41931 sec
[2019-09-08 20:08:48,508 INFO] Step 40600/10000000; acc:  72.77; ppl:  3.37; xent: 1.22; lr: 0.00016; 3296/3703 tok/s;  41979 sec
[2019-09-08 20:09:37,148 INFO] Step 40650/10000000; acc:  71.97; ppl:  3.49; xent: 1.25; lr: 0.00016; 3229/3751 tok/s;  42028 sec
[2019-09-08 20:10:25,297 INFO] Step 40700/10000000; acc:  72.67; ppl:  3.43; xent: 1.23; lr: 0.00016; 3276/3748 tok/s;  42076 sec
[2019-09-08 20:11:14,412 INFO] Step 40750/10000000; acc:  72.73; ppl:  3.40; xent: 1.22; lr: 0.00016; 3105/3724 tok/s;  42125 sec
[2019-09-08 20:12:03,457 INFO] Step 40800/10000000; acc:  73.02; ppl:  3.36; xent: 1.21; lr: 0.00016; 3246/3745 tok/s;  42174 sec
[2019-09-08 20:12:51,906 INFO] Step 40850/10000000; acc:  72.27; ppl:  3.50; xent: 1.25; lr: 0.00016; 3206/3759 tok/s;  42223 sec
[2019-09-08 20:13:39,182 INFO] Step 40900/10000000; acc:  72.50; ppl:  3.42; xent: 1.23; lr: 0.00016; 3196/3732 tok/s;  42270 sec
[2019-09-08 20:14:27,181 INFO] Step 40950/10000000; acc:  71.89; ppl:  3.53; xent: 1.26; lr: 0.00016; 3349/3729 tok/s;  42318 sec
[2019-09-08 20:15:15,832 INFO] Step 41000/10000000; acc:  72.39; ppl:  3.41; xent: 1.23; lr: 0.00016; 3310/3677 tok/s;  42367 sec
[2019-09-08 20:15:20,254 INFO] Saving checkpoint ./transformer_model_step_41000.pt
[2019-09-08 20:16:17,664 INFO] Step 41050/10000000; acc:  72.53; ppl:  3.43; xent: 1.23; lr: 0.00016; 2503/2933 tok/s;  42429 sec
[2019-09-08 20:17:06,440 INFO] Step 41100/10000000; acc:  73.54; ppl:  3.26; xent: 1.18; lr: 0.00016; 3234/3790 tok/s;  42477 sec
[2019-09-08 20:17:54,618 INFO] Step 41150/10000000; acc:  73.58; ppl:  3.25; xent: 1.18; lr: 0.00016; 3264/3736 tok/s;  42526 sec
[2019-09-08 20:18:42,224 INFO] Step 41200/10000000; acc:  73.86; ppl:  3.28; xent: 1.19; lr: 0.00016; 3171/3617 tok/s;  42573 sec
[2019-09-08 20:19:30,477 INFO] Step 41250/10000000; acc:  72.90; ppl:  3.39; xent: 1.22; lr: 0.00016; 3354/3746 tok/s;  42621 sec
[2019-09-08 20:20:19,606 INFO] Step 41300/10000000; acc:  74.18; ppl:  3.19; xent: 1.16; lr: 0.00016; 3247/3691 tok/s;  42671 sec
[2019-09-08 20:20:23,637 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 20:20:48,188 INFO] number of examples: 805546
[2019-09-08 20:21:38,780 INFO] Step 41350/10000000; acc:  52.20; ppl:  9.48; xent: 2.25; lr: 0.00016; 2017/2270 tok/s;  42750 sec
[2019-09-08 20:22:27,563 INFO] Step 41400/10000000; acc:  50.08; ppl: 10.60; xent: 2.36; lr: 0.00016; 3205/3716 tok/s;  42799 sec
[2019-09-08 20:23:17,382 INFO] Step 41450/10000000; acc:  51.32; ppl:  9.41; xent: 2.24; lr: 0.00016; 3360/3766 tok/s;  42848 sec
[2019-09-08 20:24:06,305 INFO] Step 41500/10000000; acc:  50.63; ppl:  9.88; xent: 2.29; lr: 0.00016; 3265/3807 tok/s;  42897 sec
[2019-09-08 20:24:53,631 INFO] Step 41550/10000000; acc:  51.49; ppl:  9.48; xent: 2.25; lr: 0.00016; 3423/3736 tok/s;  42945 sec
[2019-09-08 20:25:41,749 INFO] Step 41600/10000000; acc:  51.54; ppl:  9.50; xent: 2.25; lr: 0.00016; 3311/3715 tok/s;  42993 sec
[2019-09-08 20:26:30,064 INFO] Step 41650/10000000; acc:  51.81; ppl:  9.10; xent: 2.21; lr: 0.00016; 3345/3753 tok/s;  43041 sec
[2019-09-08 20:27:18,562 INFO] Step 41700/10000000; acc:  51.43; ppl:  9.61; xent: 2.26; lr: 0.00016; 3324/3779 tok/s;  43090 sec
[2019-09-08 20:28:07,103 INFO] Step 41750/10000000; acc:  51.34; ppl:  9.48; xent: 2.25; lr: 0.00016; 3376/3783 tok/s;  43138 sec
[2019-09-08 20:28:54,860 INFO] Step 41800/10000000; acc:  53.62; ppl:  8.59; xent: 2.15; lr: 0.00016; 3178/3774 tok/s;  43186 sec
[2019-09-08 20:29:43,696 INFO] Step 41850/10000000; acc:  50.86; ppl:  9.60; xent: 2.26; lr: 0.00016; 3335/3787 tok/s;  43235 sec
[2019-09-08 20:30:31,772 INFO] Step 41900/10000000; acc:  51.86; ppl:  9.16; xent: 2.21; lr: 0.00016; 3484/3741 tok/s;  43283 sec
[2019-09-08 20:31:20,208 INFO] Step 41950/10000000; acc:  51.70; ppl:  9.19; xent: 2.22; lr: 0.00016; 3336/3720 tok/s;  43331 sec
[2019-09-08 20:32:08,793 INFO] Step 42000/10000000; acc:  52.41; ppl:  8.92; xent: 2.19; lr: 0.00016; 3321/3709 tok/s;  43380 sec
[2019-09-08 20:32:13,215 INFO] Saving checkpoint ./transformer_model_step_42000.pt
[2019-09-08 20:33:09,807 INFO] Step 42050/10000000; acc:  52.16; ppl:  8.78; xent: 2.17; lr: 0.00016; 2557/3016 tok/s;  43441 sec
[2019-09-08 20:33:58,716 INFO] Step 42100/10000000; acc:  52.28; ppl:  8.70; xent: 2.16; lr: 0.00016; 3391/3711 tok/s;  43490 sec
[2019-09-08 20:34:46,511 INFO] Step 42150/10000000; acc:  52.34; ppl:  8.97; xent: 2.19; lr: 0.00016; 3211/3673 tok/s;  43537 sec
[2019-09-08 20:35:35,471 INFO] Step 42200/10000000; acc:  52.14; ppl:  8.90; xent: 2.19; lr: 0.00016; 3294/3746 tok/s;  43586 sec
[2019-09-08 20:36:24,124 INFO] Step 42250/10000000; acc:  52.53; ppl:  8.78; xent: 2.17; lr: 0.00017; 3272/3807 tok/s;  43635 sec
[2019-09-08 20:37:12,804 INFO] Step 42300/10000000; acc:  51.82; ppl:  9.08; xent: 2.21; lr: 0.00017; 3311/3779 tok/s;  43684 sec
[2019-09-08 20:38:01,086 INFO] Step 42350/10000000; acc:  52.77; ppl:  8.56; xent: 2.15; lr: 0.00017; 3382/3726 tok/s;  43732 sec
[2019-09-08 20:38:50,280 INFO] Step 42400/10000000; acc:  52.37; ppl:  8.64; xent: 2.16; lr: 0.00017; 3324/3760 tok/s;  43781 sec
[2019-09-08 20:39:39,669 INFO] Step 42450/10000000; acc:  51.95; ppl:  8.85; xent: 2.18; lr: 0.00017; 3218/3694 tok/s;  43831 sec
[2019-09-08 20:40:30,174 INFO] Step 42500/10000000; acc:  52.07; ppl:  8.89; xent: 2.19; lr: 0.00017; 3163/3627 tok/s;  43881 sec
[2019-09-08 20:41:18,774 INFO] Step 42550/10000000; acc:  52.73; ppl:  8.47; xent: 2.14; lr: 0.00017; 3339/3724 tok/s;  43930 sec
[2019-09-08 20:42:07,448 INFO] Step 42600/10000000; acc:  53.11; ppl:  8.30; xent: 2.12; lr: 0.00017; 3307/3840 tok/s;  43978 sec
[2019-09-08 20:42:56,026 INFO] Step 42650/10000000; acc:  51.62; ppl:  8.84; xent: 2.18; lr: 0.00017; 3386/3689 tok/s;  44027 sec
[2019-09-08 20:43:42,939 INFO] Step 42700/10000000; acc:  54.08; ppl:  8.28; xent: 2.11; lr: 0.00017; 3298/3769 tok/s;  44074 sec
[2019-09-08 20:44:31,659 INFO] Step 42750/10000000; acc:  53.04; ppl:  8.30; xent: 2.12; lr: 0.00017; 3383/3680 tok/s;  44123 sec
[2019-09-08 20:45:20,813 INFO] Step 42800/10000000; acc:  52.27; ppl:  8.64; xent: 2.16; lr: 0.00017; 3292/3724 tok/s;  44172 sec
[2019-09-08 20:46:09,247 INFO] Step 42850/10000000; acc:  53.67; ppl:  8.09; xent: 2.09; lr: 0.00017; 3305/3751 tok/s;  44220 sec
[2019-09-08 20:46:57,556 INFO] Step 42900/10000000; acc:  52.64; ppl:  8.58; xent: 2.15; lr: 0.00017; 3325/3723 tok/s;  44269 sec
[2019-09-08 20:47:46,912 INFO] Step 42950/10000000; acc:  52.62; ppl:  8.40; xent: 2.13; lr: 0.00017; 3307/3767 tok/s;  44318 sec
[2019-09-08 20:48:35,977 INFO] Step 43000/10000000; acc:  52.30; ppl:  8.60; xent: 2.15; lr: 0.00017; 3361/3776 tok/s;  44367 sec
[2019-09-08 20:48:40,407 INFO] Saving checkpoint ./transformer_model_step_43000.pt
[2019-09-08 20:49:37,702 INFO] Step 43050/10000000; acc:  52.87; ppl:  8.33; xent: 2.12; lr: 0.00017; 2630/3045 tok/s;  44429 sec
[2019-09-08 20:50:26,326 INFO] Step 43100/10000000; acc:  51.84; ppl:  8.71; xent: 2.16; lr: 0.00017; 3328/3716 tok/s;  44477 sec
[2019-09-08 20:51:16,334 INFO] Step 43150/10000000; acc:  54.00; ppl:  7.79; xent: 2.05; lr: 0.00017; 3233/3753 tok/s;  44527 sec
[2019-09-08 20:52:04,908 INFO] Step 43200/10000000; acc:  52.55; ppl:  8.55; xent: 2.15; lr: 0.00017; 3300/3762 tok/s;  44576 sec
[2019-09-08 20:52:52,939 INFO] Step 43250/10000000; acc:  52.84; ppl:  8.39; xent: 2.13; lr: 0.00017; 3346/3722 tok/s;  44624 sec
[2019-09-08 20:53:42,068 INFO] Step 43300/10000000; acc:  52.38; ppl:  8.58; xent: 2.15; lr: 0.00017; 3204/3669 tok/s;  44673 sec
[2019-09-08 20:54:29,373 INFO] Step 43350/10000000; acc:  53.63; ppl:  8.13; xent: 2.10; lr: 0.00017; 3333/3704 tok/s;  44720 sec
[2019-09-08 20:55:18,625 INFO] Step 43400/10000000; acc:  53.19; ppl:  8.13; xent: 2.10; lr: 0.00017; 3241/3758 tok/s;  44770 sec
[2019-09-08 20:56:07,012 INFO] Step 43450/10000000; acc:  52.87; ppl:  8.34; xent: 2.12; lr: 0.00017; 3291/3776 tok/s;  44818 sec
[2019-09-08 20:56:54,333 INFO] Step 43500/10000000; acc:  54.69; ppl:  7.76; xent: 2.05; lr: 0.00017; 3392/3749 tok/s;  44865 sec
[2019-09-08 20:57:42,473 INFO] Step 43550/10000000; acc:  52.97; ppl:  8.32; xent: 2.12; lr: 0.00017; 3199/3758 tok/s;  44913 sec
[2019-09-08 20:58:30,977 INFO] Step 43600/10000000; acc:  53.05; ppl:  8.26; xent: 2.11; lr: 0.00017; 3343/3689 tok/s;  44962 sec
[2019-09-08 20:59:21,540 INFO] Step 43650/10000000; acc:  52.90; ppl:  8.13; xent: 2.10; lr: 0.00017; 3252/3718 tok/s;  45013 sec
[2019-09-08 21:00:09,940 INFO] Step 43700/10000000; acc:  53.80; ppl:  7.87; xent: 2.06; lr: 0.00017; 3309/3686 tok/s;  45061 sec
[2019-09-08 21:00:58,617 INFO] Step 43750/10000000; acc:  52.42; ppl:  8.32; xent: 2.12; lr: 0.00017; 3202/3688 tok/s;  45110 sec
[2019-09-08 21:01:46,939 INFO] Step 43800/10000000; acc:  54.56; ppl:  7.70; xent: 2.04; lr: 0.00017; 3207/3695 tok/s;  45158 sec
[2019-09-08 21:02:35,605 INFO] Step 43850/10000000; acc:  52.68; ppl:  8.22; xent: 2.11; lr: 0.00017; 3321/3643 tok/s;  45207 sec
[2019-09-08 21:03:25,162 INFO] Step 43900/10000000; acc:  52.76; ppl:  8.16; xent: 2.10; lr: 0.00017; 3285/3637 tok/s;  45256 sec
[2019-09-08 21:04:13,922 INFO] Step 43950/10000000; acc:  53.90; ppl:  7.91; xent: 2.07; lr: 0.00017; 3244/3690 tok/s;  45305 sec
[2019-09-08 21:05:01,981 INFO] Step 44000/10000000; acc:  53.04; ppl:  8.27; xent: 2.11; lr: 0.00017; 3281/3663 tok/s;  45353 sec
[2019-09-08 21:05:06,394 INFO] Saving checkpoint ./transformer_model_step_44000.pt
[2019-09-08 21:06:04,632 INFO] Step 44050/10000000; acc:  54.15; ppl:  7.89; xent: 2.07; lr: 0.00017; 2563/2879 tok/s;  45416 sec
[2019-09-08 21:06:53,286 INFO] Step 44100/10000000; acc:  54.92; ppl:  7.70; xent: 2.04; lr: 0.00017; 3136/3754 tok/s;  45464 sec
[2019-09-08 21:07:41,810 INFO] Step 44150/10000000; acc:  53.04; ppl:  8.07; xent: 2.09; lr: 0.00017; 3380/3681 tok/s;  45513 sec
[2019-09-08 21:08:31,299 INFO] Step 44200/10000000; acc:  53.19; ppl:  8.17; xent: 2.10; lr: 0.00017; 3133/3661 tok/s;  45562 sec
[2019-09-08 21:08:32,315 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 21:08:59,049 INFO] number of examples: 947346
[2019-09-08 21:09:51,549 INFO] Step 44250/10000000; acc:  65.06; ppl:  4.63; xent: 1.53; lr: 0.00017; 1974/2197 tok/s;  45643 sec
[2019-09-08 21:10:39,749 INFO] Step 44300/10000000; acc:  67.59; ppl:  4.18; xent: 1.43; lr: 0.00017; 3258/3721 tok/s;  45691 sec
[2019-09-08 21:11:27,857 INFO] Step 44350/10000000; acc:  68.62; ppl:  4.03; xent: 1.39; lr: 0.00017; 3422/3664 tok/s;  45739 sec
[2019-09-08 21:12:16,458 INFO] Step 44400/10000000; acc:  69.64; ppl:  3.88; xent: 1.36; lr: 0.00017; 3218/3724 tok/s;  45787 sec
[2019-09-08 21:13:04,624 INFO] Step 44450/10000000; acc:  69.91; ppl:  3.82; xent: 1.34; lr: 0.00017; 3192/3740 tok/s;  45836 sec
[2019-09-08 21:13:53,745 INFO] Step 44500/10000000; acc:  70.33; ppl:  3.69; xent: 1.30; lr: 0.00017; 3349/3688 tok/s;  45885 sec
[2019-09-08 21:14:41,773 INFO] Step 44550/10000000; acc:  71.07; ppl:  3.60; xent: 1.28; lr: 0.00017; 3334/3723 tok/s;  45933 sec
[2019-09-08 21:15:29,091 INFO] Step 44600/10000000; acc:  71.56; ppl:  3.54; xent: 1.26; lr: 0.00017; 3305/3686 tok/s;  45980 sec
[2019-09-08 21:16:18,256 INFO] Step 44650/10000000; acc:  70.68; ppl:  3.66; xent: 1.30; lr: 0.00017; 3282/3796 tok/s;  46029 sec
[2019-09-08 21:17:06,134 INFO] Step 44700/10000000; acc:  71.34; ppl:  3.62; xent: 1.29; lr: 0.00017; 3162/3743 tok/s;  46077 sec
[2019-09-08 21:17:53,838 INFO] Step 44750/10000000; acc:  71.21; ppl:  3.61; xent: 1.28; lr: 0.00017; 3225/3728 tok/s;  46125 sec
[2019-09-08 21:18:42,818 INFO] Step 44800/10000000; acc:  71.96; ppl:  3.47; xent: 1.25; lr: 0.00018; 3185/3743 tok/s;  46174 sec
[2019-09-08 21:19:31,401 INFO] Step 44850/10000000; acc:  71.48; ppl:  3.54; xent: 1.26; lr: 0.00018; 3096/3751 tok/s;  46222 sec
[2019-09-08 21:20:19,914 INFO] Step 44900/10000000; acc:  72.64; ppl:  3.36; xent: 1.21; lr: 0.00018; 3277/3738 tok/s;  46271 sec
[2019-09-08 21:21:07,723 INFO] Step 44950/10000000; acc:  71.55; ppl:  3.52; xent: 1.26; lr: 0.00018; 3308/3726 tok/s;  46319 sec
[2019-09-08 21:21:56,188 INFO] Step 45000/10000000; acc:  72.38; ppl:  3.41; xent: 1.23; lr: 0.00018; 3299/3719 tok/s;  46367 sec
[2019-09-08 21:22:00,611 INFO] Saving checkpoint ./transformer_model_step_45000.pt
[2019-09-08 21:22:58,725 INFO] Step 45050/10000000; acc:  72.09; ppl:  3.47; xent: 1.24; lr: 0.00018; 2486/2943 tok/s;  46430 sec
[2019-09-08 21:23:47,445 INFO] Step 45100/10000000; acc:  72.42; ppl:  3.38; xent: 1.22; lr: 0.00018; 3322/3699 tok/s;  46478 sec
[2019-09-08 21:24:35,858 INFO] Step 45150/10000000; acc:  72.43; ppl:  3.39; xent: 1.22; lr: 0.00018; 3210/3729 tok/s;  46527 sec
[2019-09-08 21:25:23,875 INFO] Step 45200/10000000; acc:  72.65; ppl:  3.37; xent: 1.21; lr: 0.00018; 3301/3674 tok/s;  46575 sec
[2019-09-08 21:26:11,916 INFO] Step 45250/10000000; acc:  72.22; ppl:  3.42; xent: 1.23; lr: 0.00018; 3281/3731 tok/s;  46623 sec
[2019-09-08 21:26:59,425 INFO] Step 45300/10000000; acc:  72.05; ppl:  3.49; xent: 1.25; lr: 0.00018; 3312/3716 tok/s;  46670 sec
[2019-09-08 21:27:47,751 INFO] Step 45350/10000000; acc:  73.54; ppl:  3.25; xent: 1.18; lr: 0.00018; 3246/3740 tok/s;  46719 sec
[2019-09-08 21:28:39,640 INFO] Step 45400/10000000; acc:  74.68; ppl:  3.07; xent: 1.12; lr: 0.00018; 3103/3549 tok/s;  46771 sec
[2019-09-08 21:29:27,990 INFO] Step 45450/10000000; acc:  73.64; ppl:  3.24; xent: 1.17; lr: 0.00018; 3174/3762 tok/s;  46819 sec
[2019-09-08 21:30:15,885 INFO] Step 45500/10000000; acc:  73.08; ppl:  3.31; xent: 1.20; lr: 0.00018; 3267/3723 tok/s;  46867 sec
[2019-09-08 21:31:04,727 INFO] Step 45550/10000000; acc:  74.22; ppl:  3.16; xent: 1.15; lr: 0.00018; 3216/3713 tok/s;  46916 sec
[2019-09-08 21:31:52,891 INFO] Step 45600/10000000; acc:  72.99; ppl:  3.29; xent: 1.19; lr: 0.00018; 3386/3721 tok/s;  46964 sec
[2019-09-08 21:32:41,309 INFO] Step 45650/10000000; acc:  73.12; ppl:  3.26; xent: 1.18; lr: 0.00018; 3335/3759 tok/s;  47012 sec
[2019-09-08 21:33:29,276 INFO] Step 45700/10000000; acc:  73.33; ppl:  3.29; xent: 1.19; lr: 0.00018; 3140/3769 tok/s;  47060 sec
[2019-09-08 21:34:17,384 INFO] Step 45750/10000000; acc:  74.00; ppl:  3.18; xent: 1.16; lr: 0.00018; 3346/3729 tok/s;  47108 sec
[2019-09-08 21:35:05,972 INFO] Step 45800/10000000; acc:  73.74; ppl:  3.17; xent: 1.15; lr: 0.00018; 3325/3738 tok/s;  47157 sec
[2019-09-08 21:35:54,543 INFO] Step 45850/10000000; acc:  74.29; ppl:  3.13; xent: 1.14; lr: 0.00018; 3238/3797 tok/s;  47206 sec
[2019-09-08 21:36:42,283 INFO] Step 45900/10000000; acc:  73.91; ppl:  3.18; xent: 1.16; lr: 0.00018; 3299/3709 tok/s;  47253 sec
[2019-09-08 21:37:28,738 INFO] Step 45950/10000000; acc:  73.91; ppl:  3.21; xent: 1.17; lr: 0.00018; 3280/3621 tok/s;  47300 sec
[2019-09-08 21:38:17,575 INFO] Step 46000/10000000; acc:  74.05; ppl:  3.17; xent: 1.15; lr: 0.00018; 3237/3729 tok/s;  47349 sec
[2019-09-08 21:38:21,972 INFO] Saving checkpoint ./transformer_model_step_46000.pt
[2019-09-08 21:39:20,452 INFO] Step 46050/10000000; acc:  73.77; ppl:  3.19; xent: 1.16; lr: 0.00018; 2565/2894 tok/s;  47411 sec
[2019-09-08 21:40:08,604 INFO] Step 46100/10000000; acc:  74.06; ppl:  3.18; xent: 1.16; lr: 0.00018; 3274/3667 tok/s;  47460 sec
[2019-09-08 21:40:57,756 INFO] Step 46150/10000000; acc:  74.45; ppl:  3.10; xent: 1.13; lr: 0.00018; 3337/3666 tok/s;  47509 sec
[2019-09-08 21:41:46,285 INFO] Step 46200/10000000; acc:  74.33; ppl:  3.15; xent: 1.15; lr: 0.00018; 3204/3700 tok/s;  47557 sec
[2019-09-08 21:42:34,868 INFO] Step 46250/10000000; acc:  74.24; ppl:  3.14; xent: 1.14; lr: 0.00018; 3192/3645 tok/s;  47606 sec
[2019-09-08 21:43:22,693 INFO] Step 46300/10000000; acc:  73.84; ppl:  3.23; xent: 1.17; lr: 0.00018; 3185/3699 tok/s;  47654 sec
[2019-09-08 21:44:10,178 INFO] Step 46350/10000000; acc:  73.51; ppl:  3.24; xent: 1.18; lr: 0.00018; 3286/3797 tok/s;  47701 sec
[2019-09-08 21:44:57,775 INFO] Step 46400/10000000; acc:  73.63; ppl:  3.21; xent: 1.17; lr: 0.00018; 3317/3679 tok/s;  47749 sec
[2019-09-08 21:45:45,748 INFO] Step 46450/10000000; acc:  74.21; ppl:  3.15; xent: 1.15; lr: 0.00018; 3285/3733 tok/s;  47797 sec
[2019-09-08 21:46:33,926 INFO] Step 46500/10000000; acc:  74.76; ppl:  3.09; xent: 1.13; lr: 0.00018; 3190/3770 tok/s;  47845 sec
[2019-09-08 21:47:23,855 INFO] Step 46550/10000000; acc:  74.31; ppl:  3.14; xent: 1.14; lr: 0.00018; 3132/3666 tok/s;  47895 sec
[2019-09-08 21:48:11,912 INFO] Step 46600/10000000; acc:  74.60; ppl:  3.08; xent: 1.12; lr: 0.00018; 3365/3712 tok/s;  47943 sec
[2019-09-08 21:49:00,181 INFO] Step 46650/10000000; acc:  74.51; ppl:  3.09; xent: 1.13; lr: 0.00018; 3294/3710 tok/s;  47991 sec
[2019-09-08 21:49:48,126 INFO] Step 46700/10000000; acc:  74.30; ppl:  3.12; xent: 1.14; lr: 0.00018; 3329/3744 tok/s;  48039 sec
[2019-09-08 21:50:36,916 INFO] Step 46750/10000000; acc:  75.74; ppl:  2.95; xent: 1.08; lr: 0.00018; 3167/3731 tok/s;  48088 sec
[2019-09-08 21:51:24,269 INFO] Step 46800/10000000; acc:  75.59; ppl:  2.95; xent: 1.08; lr: 0.00018; 3322/3739 tok/s;  48135 sec
[2019-09-08 21:52:12,326 INFO] Step 46850/10000000; acc:  74.64; ppl:  3.09; xent: 1.13; lr: 0.00018; 3217/3745 tok/s;  48183 sec
[2019-09-08 21:52:59,890 INFO] Step 46900/10000000; acc:  74.72; ppl:  3.06; xent: 1.12; lr: 0.00018; 3301/3620 tok/s;  48231 sec
[2019-09-08 21:53:48,752 INFO] Step 46950/10000000; acc:  74.80; ppl:  3.04; xent: 1.11; lr: 0.00018; 3251/3739 tok/s;  48280 sec
[2019-09-08 21:54:36,750 INFO] Step 47000/10000000; acc:  74.34; ppl:  3.10; xent: 1.13; lr: 0.00018; 3352/3728 tok/s;  48328 sec
[2019-09-08 21:54:41,180 INFO] Saving checkpoint ./transformer_model_step_47000.pt
[2019-09-08 21:55:40,660 INFO] Step 47050/10000000; acc:  75.05; ppl:  3.05; xent: 1.11; lr: 0.00018; 2416/2864 tok/s;  48392 sec
[2019-09-08 21:56:30,138 INFO] Step 47100/10000000; acc:  75.58; ppl:  2.96; xent: 1.09; lr: 0.00018; 3160/3726 tok/s;  48441 sec
[2019-09-08 21:57:18,201 INFO] Step 47150/10000000; acc:  74.27; ppl:  3.18; xent: 1.16; lr: 0.00018; 3198/3812 tok/s;  48489 sec
[2019-09-08 21:58:06,035 INFO] Step 47200/10000000; acc:  75.03; ppl:  3.02; xent: 1.11; lr: 0.00018; 3208/3693 tok/s;  48537 sec
[2019-09-08 21:58:54,112 INFO] Step 47250/10000000; acc:  74.58; ppl:  3.11; xent: 1.13; lr: 0.00018; 3260/3776 tok/s;  48585 sec
[2019-09-08 21:59:41,997 INFO] Step 47300/10000000; acc:  74.39; ppl:  3.10; xent: 1.13; lr: 0.00018; 3373/3672 tok/s;  48633 sec
[2019-09-08 22:00:30,770 INFO] Step 47350/10000000; acc:  74.62; ppl:  3.05; xent: 1.12; lr: 0.00018; 3279/3725 tok/s;  48682 sec
[2019-09-08 22:01:19,386 INFO] Step 47400/10000000; acc:  75.06; ppl:  3.02; xent: 1.11; lr: 0.00019; 3156/3753 tok/s;  48730 sec
[2019-09-08 22:02:07,944 INFO] Step 47450/10000000; acc:  75.71; ppl:  2.92; xent: 1.07; lr: 0.00019; 3231/3753 tok/s;  48779 sec
[2019-09-08 22:02:55,773 INFO] Step 47500/10000000; acc:  76.01; ppl:  2.94; xent: 1.08; lr: 0.00019; 3241/3662 tok/s;  48827 sec
[2019-09-08 22:03:44,086 INFO] Step 47550/10000000; acc:  75.48; ppl:  3.01; xent: 1.10; lr: 0.00019; 3290/3691 tok/s;  48875 sec
[2019-09-08 22:04:32,682 INFO] Step 47600/10000000; acc:  76.23; ppl:  2.90; xent: 1.06; lr: 0.00019; 3225/3694 tok/s;  48924 sec
[2019-09-08 22:04:50,660 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 22:05:10,470 INFO] number of examples: 805546
[2019-09-08 22:05:48,018 INFO] Step 47650/10000000; acc:  60.81; ppl:  6.04; xent: 1.80; lr: 0.00019; 2116/2428 tok/s;  48999 sec
[2019-09-08 22:06:36,723 INFO] Step 47700/10000000; acc:  51.83; ppl:  9.35; xent: 2.23; lr: 0.00019; 3273/3696 tok/s;  49048 sec
[2019-09-08 22:07:25,609 INFO] Step 47750/10000000; acc:  53.17; ppl:  8.46; xent: 2.14; lr: 0.00019; 3347/3739 tok/s;  49097 sec
[2019-09-08 22:08:15,218 INFO] Step 47800/10000000; acc:  52.35; ppl:  8.70; xent: 2.16; lr: 0.00019; 3248/3803 tok/s;  49146 sec
[2019-09-08 22:09:03,080 INFO] Step 47850/10000000; acc:  53.17; ppl:  8.42; xent: 2.13; lr: 0.00019; 3357/3761 tok/s;  49194 sec
[2019-09-08 22:09:51,118 INFO] Step 47900/10000000; acc:  52.85; ppl:  8.50; xent: 2.14; lr: 0.00019; 3371/3745 tok/s;  49242 sec
[2019-09-08 22:10:38,956 INFO] Step 47950/10000000; acc:  53.03; ppl:  8.34; xent: 2.12; lr: 0.00019; 3377/3746 tok/s;  49290 sec
[2019-09-08 22:11:27,768 INFO] Step 48000/10000000; acc:  53.36; ppl:  8.35; xent: 2.12; lr: 0.00019; 3260/3755 tok/s;  49339 sec
[2019-09-08 22:11:32,195 INFO] Saving checkpoint ./transformer_model_step_48000.pt
[2019-09-08 22:12:28,889 INFO] Step 48050/10000000; acc:  52.51; ppl:  8.72; xent: 2.17; lr: 0.00019; 2670/2982 tok/s;  49400 sec
[2019-09-08 22:13:16,924 INFO] Step 48100/10000000; acc:  54.37; ppl:  7.93; xent: 2.07; lr: 0.00019; 3233/3781 tok/s;  49448 sec
[2019-09-08 22:14:05,263 INFO] Step 48150/10000000; acc:  52.81; ppl:  8.40; xent: 2.13; lr: 0.00019; 3372/3746 tok/s;  49496 sec
[2019-09-08 22:14:53,714 INFO] Step 48200/10000000; acc:  53.28; ppl:  8.17; xent: 2.10; lr: 0.00019; 3427/3787 tok/s;  49545 sec
[2019-09-08 22:15:41,815 INFO] Step 48250/10000000; acc:  53.33; ppl:  8.31; xent: 2.12; lr: 0.00019; 3369/3732 tok/s;  49593 sec
[2019-09-08 22:16:30,696 INFO] Step 48300/10000000; acc:  53.07; ppl:  8.30; xent: 2.12; lr: 0.00019; 3304/3704 tok/s;  49642 sec
[2019-09-08 22:17:19,181 INFO] Step 48350/10000000; acc:  54.04; ppl:  7.77; xent: 2.05; lr: 0.00019; 3291/3810 tok/s;  49690 sec
[2019-09-08 22:18:08,062 INFO] Step 48400/10000000; acc:  52.72; ppl:  8.23; xent: 2.11; lr: 0.00019; 3308/3692 tok/s;  49739 sec
[2019-09-08 22:18:56,393 INFO] Step 48450/10000000; acc:  54.16; ppl:  7.84; xent: 2.06; lr: 0.00019; 3279/3695 tok/s;  49787 sec
[2019-09-08 22:19:44,376 INFO] Step 48500/10000000; acc:  54.21; ppl:  7.99; xent: 2.08; lr: 0.00019; 3238/3745 tok/s;  49835 sec
[2019-09-08 22:20:33,150 INFO] Step 48550/10000000; acc:  53.91; ppl:  7.97; xent: 2.08; lr: 0.00019; 3266/3786 tok/s;  49884 sec
[2019-09-08 22:21:21,733 INFO] Step 48600/10000000; acc:  53.27; ppl:  8.13; xent: 2.10; lr: 0.00019; 3263/3782 tok/s;  49933 sec
[2019-09-08 22:22:10,714 INFO] Step 48650/10000000; acc:  53.78; ppl:  7.87; xent: 2.06; lr: 0.00019; 3391/3739 tok/s;  49982 sec
[2019-09-08 22:22:59,476 INFO] Step 48700/10000000; acc:  53.48; ppl:  7.81; xent: 2.06; lr: 0.00019; 3398/3751 tok/s;  50030 sec
[2019-09-08 22:23:48,978 INFO] Step 48750/10000000; acc:  53.55; ppl:  7.99; xent: 2.08; lr: 0.00019; 3240/3752 tok/s;  50080 sec
[2019-09-08 22:24:39,686 INFO] Step 48800/10000000; acc:  53.09; ppl:  8.14; xent: 2.10; lr: 0.00019; 3158/3520 tok/s;  50131 sec
[2019-09-08 22:25:28,126 INFO] Step 48850/10000000; acc:  54.08; ppl:  7.79; xent: 2.05; lr: 0.00019; 3291/3766 tok/s;  50179 sec
[2019-09-08 22:26:16,946 INFO] Step 48900/10000000; acc:  54.42; ppl:  7.48; xent: 2.01; lr: 0.00019; 3318/3825 tok/s;  50228 sec
[2019-09-08 22:27:05,052 INFO] Step 48950/10000000; acc:  53.31; ppl:  8.00; xent: 2.08; lr: 0.00019; 3390/3698 tok/s;  50276 sec
[2019-09-08 22:27:52,379 INFO] Step 49000/10000000; acc:  54.76; ppl:  7.64; xent: 2.03; lr: 0.00019; 3277/3768 tok/s;  50323 sec
[2019-09-08 22:27:56,799 INFO] Saving checkpoint ./transformer_model_step_49000.pt
[2019-09-08 22:28:53,891 INFO] Step 49050/10000000; acc:  54.63; ppl:  7.53; xent: 2.02; lr: 0.00019; 2666/2940 tok/s;  50385 sec
[2019-09-08 22:29:42,752 INFO] Step 49100/10000000; acc:  54.24; ppl:  7.61; xent: 2.03; lr: 0.00019; 3330/3697 tok/s;  50434 sec
[2019-09-08 22:30:31,350 INFO] Step 49150/10000000; acc:  54.84; ppl:  7.56; xent: 2.02; lr: 0.00019; 3246/3737 tok/s;  50482 sec
[2019-09-08 22:31:19,853 INFO] Step 49200/10000000; acc:  54.20; ppl:  7.66; xent: 2.04; lr: 0.00019; 3399/3771 tok/s;  50531 sec
[2019-09-08 22:32:08,922 INFO] Step 49250/10000000; acc:  53.59; ppl:  7.89; xent: 2.06; lr: 0.00019; 3222/3727 tok/s;  50580 sec
[2019-09-08 22:32:58,112 INFO] Step 49300/10000000; acc:  53.78; ppl:  7.70; xent: 2.04; lr: 0.00019; 3428/3756 tok/s;  50629 sec
[2019-09-08 22:33:47,175 INFO] Step 49350/10000000; acc:  53.98; ppl:  7.72; xent: 2.04; lr: 0.00019; 3297/3836 tok/s;  50678 sec
[2019-09-08 22:34:36,311 INFO] Step 49400/10000000; acc:  53.40; ppl:  7.88; xent: 2.06; lr: 0.00019; 3294/3686 tok/s;  50727 sec
[2019-09-08 22:35:25,474 INFO] Step 49450/10000000; acc:  55.36; ppl:  7.18; xent: 1.97; lr: 0.00019; 3234/3785 tok/s;  50776 sec
[2019-09-08 22:36:14,832 INFO] Step 49500/10000000; acc:  54.30; ppl:  7.64; xent: 2.03; lr: 0.00019; 3273/3780 tok/s;  50826 sec
[2019-09-08 22:37:03,085 INFO] Step 49550/10000000; acc:  54.26; ppl:  7.51; xent: 2.02; lr: 0.00019; 3410/3711 tok/s;  50874 sec
[2019-09-08 22:37:52,111 INFO] Step 49600/10000000; acc:  53.18; ppl:  8.11; xent: 2.09; lr: 0.00019; 3152/3693 tok/s;  50923 sec
[2019-09-08 22:38:39,780 INFO] Step 49650/10000000; acc:  54.80; ppl:  7.55; xent: 2.02; lr: 0.00019; 3354/3662 tok/s;  50971 sec
[2019-09-08 22:39:28,309 INFO] Step 49700/10000000; acc:  55.02; ppl:  7.33; xent: 1.99; lr: 0.00019; 3240/3764 tok/s;  51019 sec
[2019-09-08 22:40:17,112 INFO] Step 49750/10000000; acc:  54.79; ppl:  7.37; xent: 2.00; lr: 0.00019; 3311/3735 tok/s;  51068 sec
[2019-09-08 22:41:04,577 INFO] Step 49800/10000000; acc:  54.88; ppl:  7.46; xent: 2.01; lr: 0.00019; 3366/3759 tok/s;  51116 sec
[2019-09-08 22:41:52,579 INFO] Step 49850/10000000; acc:  54.80; ppl:  7.44; xent: 2.01; lr: 0.00019; 3243/3782 tok/s;  51164 sec
[2019-09-08 22:42:40,958 INFO] Step 49900/10000000; acc:  54.06; ppl:  7.67; xent: 2.04; lr: 0.00019; 3270/3684 tok/s;  51212 sec
[2019-09-08 22:43:31,139 INFO] Step 49950/10000000; acc:  54.58; ppl:  7.29; xent: 1.99; lr: 0.00020; 3297/3714 tok/s;  51262 sec
[2019-09-08 22:44:19,676 INFO] Step 50000/10000000; acc:  54.90; ppl:  7.36; xent: 2.00; lr: 0.00020; 3284/3701 tok/s;  51311 sec
[2019-09-08 22:44:19,679 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-08 22:44:21,351 INFO] number of examples: 100000
[2019-09-08 22:51:50,166 INFO] Validation perplexity: 7.08333
[2019-09-08 22:51:50,167 INFO] Validation accuracy: 59.5102
[2019-09-08 22:51:54,592 INFO] Saving checkpoint ./transformer_model_step_50000.pt
[2019-09-08 22:52:51,562 INFO] Step 50050/10000000; acc:  53.83; ppl:  7.57; xent: 2.02; lr: 0.00020; 307/348 tok/s;  51823 sec
[2019-09-08 22:53:39,551 INFO] Step 50100/10000000; acc:  55.88; ppl:  7.05; xent: 1.95; lr: 0.00020; 3213/3736 tok/s;  51871 sec
[2019-09-08 22:54:28,351 INFO] Step 50150/10000000; acc:  54.02; ppl:  7.56; xent: 2.02; lr: 0.00020; 3284/3624 tok/s;  51919 sec
[2019-09-08 22:55:18,449 INFO] Step 50200/10000000; acc:  54.27; ppl:  7.28; xent: 1.98; lr: 0.00020; 3365/3681 tok/s;  51969 sec
[2019-09-08 22:56:06,917 INFO] Step 50250/10000000; acc:  54.74; ppl:  7.38; xent: 2.00; lr: 0.00020; 3180/3702 tok/s;  52018 sec
[2019-09-08 22:56:55,153 INFO] Step 50300/10000000; acc:  54.97; ppl:  7.38; xent: 2.00; lr: 0.00020; 3266/3682 tok/s;  52066 sec
[2019-09-08 22:57:43,567 INFO] Step 50350/10000000; acc:  54.83; ppl:  7.39; xent: 2.00; lr: 0.00020; 3344/3655 tok/s;  52115 sec
[2019-09-08 22:58:32,339 INFO] Step 50400/10000000; acc:  55.61; ppl:  7.17; xent: 1.97; lr: 0.00020; 3116/3692 tok/s;  52163 sec
[2019-09-08 22:59:21,321 INFO] Step 50450/10000000; acc:  54.68; ppl:  7.28; xent: 1.99; lr: 0.00020; 3348/3712 tok/s;  52212 sec
[2019-09-08 23:00:10,345 INFO] Step 50500/10000000; acc:  54.38; ppl:  7.52; xent: 2.02; lr: 0.00020; 3214/3677 tok/s;  52261 sec
[2019-09-08 23:00:26,187 INFO] Loading dataset from data/data.train.0.pt
[2019-09-08 23:00:51,698 INFO] number of examples: 947346
[2019-09-08 23:01:29,632 INFO] Step 50550/10000000; acc:  62.98; ppl:  5.10; xent: 1.63; lr: 0.00020; 1960/2233 tok/s;  52341 sec
[2019-09-08 23:02:17,921 INFO] Step 50600/10000000; acc:  69.76; ppl:  3.76; xent: 1.33; lr: 0.00020; 3296/3691 tok/s;  52389 sec
[2019-09-08 23:03:06,288 INFO] Step 50650/10000000; acc:  70.83; ppl:  3.65; xent: 1.29; lr: 0.00020; 3311/3675 tok/s;  52437 sec
[2019-09-08 23:03:54,251 INFO] Step 50700/10000000; acc:  71.88; ppl:  3.47; xent: 1.25; lr: 0.00020; 3309/3704 tok/s;  52485 sec
[2019-09-08 23:04:43,377 INFO] Step 50750/10000000; acc:  71.82; ppl:  3.50; xent: 1.25; lr: 0.00020; 3180/3747 tok/s;  52534 sec
[2019-09-08 23:05:31,995 INFO] Step 50800/10000000; acc:  72.66; ppl:  3.34; xent: 1.20; lr: 0.00020; 3295/3707 tok/s;  52583 sec
[2019-09-08 23:06:20,225 INFO] Step 50850/10000000; acc:  72.65; ppl:  3.31; xent: 1.20; lr: 0.00020; 3416/3732 tok/s;  52631 sec
[2019-09-08 23:07:07,462 INFO] Step 50900/10000000; acc:  73.58; ppl:  3.23; xent: 1.17; lr: 0.00020; 3295/3658 tok/s;  52678 sec
[2019-09-08 23:07:56,157 INFO] Step 50950/10000000; acc:  72.72; ppl:  3.32; xent: 1.20; lr: 0.00020; 3280/3780 tok/s;  52727 sec
[2019-09-08 23:08:44,827 INFO] Step 51000/10000000; acc:  73.62; ppl:  3.23; xent: 1.17; lr: 0.00020; 3178/3741 tok/s;  52776 sec
[2019-09-08 23:08:49,240 INFO] Saving checkpoint ./transformer_model_step_51000.pt
[2019-09-08 23:09:45,666 INFO] Step 51050/10000000; acc:  73.05; ppl:  3.30; xent: 1.19; lr: 0.00020; 2508/2945 tok/s;  52837 sec
[2019-09-08 23:10:33,804 INFO] Step 51100/10000000; acc:  73.39; ppl:  3.24; xent: 1.18; lr: 0.00020; 3230/3716 tok/s;  52885 sec
[2019-09-08 23:11:22,952 INFO] Step 51150/10000000; acc:  73.88; ppl:  3.18; xent: 1.16; lr: 0.00020; 3045/3732 tok/s;  52934 sec
[2019-09-08 23:12:11,073 INFO] Step 51200/10000000; acc:  74.20; ppl:  3.10; xent: 1.13; lr: 0.00020; 3305/3784 tok/s;  52982 sec
[2019-09-08 23:12:58,974 INFO] Step 51250/10000000; acc:  74.27; ppl:  3.13; xent: 1.14; lr: 0.00020; 3253/3729 tok/s;  53030 sec
[2019-09-08 23:13:47,723 INFO] Step 51300/10000000; acc:  73.83; ppl:  3.17; xent: 1.15; lr: 0.00020; 3281/3739 tok/s;  53079 sec
[2019-09-08 23:14:35,804 INFO] Step 51350/10000000; acc:  74.31; ppl:  3.12; xent: 1.14; lr: 0.00020; 3254/3787 tok/s;  53127 sec
[2019-09-08 23:15:24,459 INFO] Step 51400/10000000; acc:  74.52; ppl:  3.05; xent: 1.12; lr: 0.00020; 3301/3734 tok/s;  53175 sec
[2019-09-08 23:16:12,967 INFO] Step 51450/10000000; acc:  74.63; ppl:  3.05; xent: 1.12; lr: 0.00020; 3277/3720 tok/s;  53224 sec
[2019-09-08 23:17:01,177 INFO] Step 51500/10000000; acc:  74.75; ppl:  3.05; xent: 1.12; lr: 0.00020; 3208/3680 tok/s;  53272 sec
[2019-09-08 23:17:49,600 INFO] Step 51550/10000000; acc:  74.44; ppl:  3.07; xent: 1.12; lr: 0.00020; 3363/3728 tok/s;  53321 sec
[2019-09-08 23:18:36,628 INFO] Step 51600/10000000; acc:  73.09; ppl:  3.31; xent: 1.20; lr: 0.00020; 3290/3765 tok/s;  53368 sec
[2019-09-08 23:19:24,874 INFO] Step 51650/10000000; acc:  75.75; ppl:  2.94; xent: 1.08; lr: 0.00020; 3254/3725 tok/s;  53416 sec
[2019-09-08 23:20:16,522 INFO] Step 51700/10000000; acc:  76.89; ppl:  2.78; xent: 1.02; lr: 0.00020; 3102/3500 tok/s;  53467 sec
[2019-09-08 23:21:05,071 INFO] Step 51750/10000000; acc:  75.35; ppl:  2.98; xent: 1.09; lr: 0.00020; 3197/3772 tok/s;  53516 sec
[2019-09-08 23:21:52,758 INFO] Step 51800/10000000; acc:  74.95; ppl:  3.03; xent: 1.11; lr: 0.00020; 3289/3682 tok/s;  53564 sec
[2019-09-08 23:22:41,445 INFO] Step 51850/10000000; acc:  75.83; ppl:  2.91; xent: 1.07; lr: 0.00020; 3191/3789 tok/s;  53612 sec
[2019-09-08 23:23:29,762 INFO] Step 51900/10000000; acc:  75.07; ppl:  2.96; xent: 1.09; lr: 0.00020; 3379/3663 tok/s;  53661 sec
[2019-09-08 23:24:18,481 INFO] Step 51950/10000000; acc:  74.98; ppl:  3.00; xent: 1.10; lr: 0.00020; 3303/3768 tok/s;  53709 sec
[2019-09-08 23:25:05,745 INFO] Step 52000/10000000; acc:  75.09; ppl:  3.00; xent: 1.10; lr: 0.00020; 3141/3780 tok/s;  53757 sec
[2019-09-08 23:25:10,169 INFO] Saving checkpoint ./transformer_model_step_52000.pt
[2019-09-08 23:26:07,948 INFO] Step 52050/10000000; acc:  75.23; ppl:  2.96; xent: 1.08; lr: 0.00020; 2594/2912 tok/s;  53819 sec
[2019-09-08 23:26:56,809 INFO] Step 52100/10000000; acc:  75.99; ppl:  2.85; xent: 1.05; lr: 0.00020; 3387/3692 tok/s;  53868 sec
[2019-09-08 23:27:45,024 INFO] Step 52150/10000000; acc:  75.78; ppl:  2.90; xent: 1.06; lr: 0.00020; 3253/3816 tok/s;  53916 sec
[2019-09-08 23:28:32,905 INFO] Step 52200/10000000; acc:  75.79; ppl:  2.91; xent: 1.07; lr: 0.00020; 3296/3684 tok/s;  53964 sec
[2019-09-08 23:29:20,075 INFO] Step 52250/10000000; acc:  75.43; ppl:  2.96; xent: 1.08; lr: 0.00020; 3238/3663 tok/s;  54011 sec
[2019-09-08 23:30:08,183 INFO] Step 52300/10000000; acc:  75.79; ppl:  2.93; xent: 1.07; lr: 0.00020; 3201/3721 tok/s;  54059 sec
[2019-09-08 23:30:57,367 INFO] Step 52350/10000000; acc:  75.73; ppl:  2.90; xent: 1.07; lr: 0.00020; 3290/3738 tok/s;  54108 sec
[2019-09-08 23:31:45,554 INFO] Step 52400/10000000; acc:  75.55; ppl:  2.93; xent: 1.08; lr: 0.00020; 3313/3647 tok/s;  54157 sec
[2019-09-08 23:32:34,945 INFO] Step 52450/10000000; acc:  76.70; ppl:  2.79; xent: 1.03; lr: 0.00020; 3272/3693 tok/s;  54206 sec
[2019-09-08 23:33:23,416 INFO] Step 52500/10000000; acc:  75.77; ppl:  2.93; xent: 1.08; lr: 0.00021; 3248/3631 tok/s;  54254 sec
[2019-09-08 23:34:11,988 INFO] Step 52550/10000000; acc:  76.61; ppl:  2.82; xent: 1.04; lr: 0.00021; 3222/3717 tok/s;  54303 sec
[2019-09-08 23:34:59,930 INFO] Step 52600/10000000; acc:  75.36; ppl:  2.99; xent: 1.10; lr: 0.00021; 3181/3691 tok/s;  54351 sec
[2019-09-08 23:35:47,321 INFO] Step 52650/10000000; acc:  75.26; ppl:  2.98; xent: 1.09; lr: 0.00021; 3303/3693 tok/s;  54398 sec
[2019-09-08 23:36:35,098 INFO] Step 52700/10000000; acc:  75.23; ppl:  2.97; xent: 1.09; lr: 0.00021; 3198/3756 tok/s;  54446 sec
[2019-09-08 23:37:22,873 INFO] Step 52750/10000000; acc:  75.17; ppl:  2.96; xent: 1.09; lr: 0.00021; 3403/3687 tok/s;  54494 sec
[2019-09-08 23:38:11,217 INFO] Step 52800/10000000; acc:  76.52; ppl:  2.85; xent: 1.05; lr: 0.00021; 3171/3782 tok/s;  54542 sec
[2019-09-08 23:39:01,537 INFO] Step 52850/10000000; acc:  76.36; ppl:  2.84; xent: 1.04; lr: 0.00021; 3082/3650 tok/s;  54593 sec
[2019-09-08 23:39:48,990 INFO] Step 52900/10000000; acc:  75.72; ppl:  2.90; xent: 1.06; lr: 0.00021; 3369/3698 tok/s;  54640 sec
[2019-09-08 23:40:37,294 INFO] Step 52950/10000000; acc:  76.12; ppl:  2.87; xent: 1.05; lr: 0.00021; 3285/3786 tok/s;  54688 sec
[2019-09-08 23:41:25,285 INFO] Step 53000/10000000; acc:  76.01; ppl:  2.86; xent: 1.05; lr: 0.00021; 3338/3712 tok/s;  54736 sec
[2019-09-08 23:41:29,691 INFO] Saving checkpoint ./transformer_model_step_53000.pt
[2019-09-08 23:42:27,477 INFO] Step 53050/10000000; acc:  76.95; ppl:  2.77; xent: 1.02; lr: 0.00021; 2509/2884 tok/s;  54798 sec
[2019-09-08 23:43:15,589 INFO] Step 53100/10000000; acc:  77.26; ppl:  2.72; xent: 1.00; lr: 0.00021; 3256/3757 tok/s;  54847 sec
[2019-09-08 23:44:03,368 INFO] Step 53150/10000000; acc:  76.63; ppl:  2.77; xent: 1.02; lr: 0.00021; 3342/3726 tok/s;  54894 sec
[2019-09-08 23:44:51,159 INFO] Step 53200/10000000; acc:  76.03; ppl:  2.90; xent: 1.06; lr: 0.00021; 3223/3626 tok/s;  54942 sec
[2019-09-08 23:45:39,437 INFO] Step 53250/10000000; acc:  76.49; ppl:  2.79; xent: 1.03; lr: 0.00021; 3239/3774 tok/s;  54990 sec
[2019-09-08 23:46:28,678 INFO] Step 53300/10000000; acc:  76.31; ppl:  2.82; xent: 1.04; lr: 0.00021; 3317/3720 tok/s;  55040 sec
[2019-09-08 23:47:16,503 INFO] Step 53350/10000000; acc:  76.72; ppl:  2.84; xent: 1.05; lr: 0.00021; 3207/3703 tok/s;  55087 sec
[2019-09-08 23:48:06,283 INFO] Step 53400/10000000; acc:  76.56; ppl:  2.81; xent: 1.03; lr: 0.00021; 3160/3739 tok/s;  55137 sec
[2019-09-08 23:48:54,535 INFO] Step 53450/10000000; acc:  76.78; ppl:  2.81; xent: 1.03; lr: 0.00021; 3198/3783 tok/s;  55186 sec
[2019-09-08 23:49:42,817 INFO] Step 53500/10000000; acc:  76.30; ppl:  2.83; xent: 1.04; lr: 0.00021; 3223/3700 tok/s;  55234 sec
[2019-09-08 23:50:30,310 INFO] Step 53550/10000000; acc:  75.77; ppl:  2.94; xent: 1.08; lr: 0.00021; 3166/3783 tok/s;  55281 sec
[2019-09-08 23:51:18,722 INFO] Step 53600/10000000; acc:  76.21; ppl:  2.82; xent: 1.04; lr: 0.00021; 3393/3699 tok/s;  55330 sec
[2019-09-08 23:52:07,367 INFO] Step 53650/10000000; acc:  75.97; ppl:  2.84; xent: 1.04; lr: 0.00021; 3295/3697 tok/s;  55378 sec
[2019-09-08 23:52:55,492 INFO] Step 53700/10000000; acc:  76.41; ppl:  2.84; xent: 1.05; lr: 0.00021; 3149/3729 tok/s;  55426 sec
[2019-09-08 23:53:44,401 INFO] Step 53750/10000000; acc:  77.32; ppl:  2.70; xent: 0.99; lr: 0.00021; 3222/3786 tok/s;  55475 sec
[2019-09-08 23:54:32,401 INFO] Step 53800/10000000; acc:  77.41; ppl:  2.72; xent: 1.00; lr: 0.00021; 3243/3688 tok/s;  55523 sec
[2019-09-08 23:55:20,076 INFO] Step 53850/10000000; acc:  76.95; ppl:  2.81; xent: 1.03; lr: 0.00021; 3234/3681 tok/s;  55571 sec
[2019-09-08 23:56:08,589 INFO] Step 53900/10000000; acc:  76.76; ppl:  2.77; xent: 1.02; lr: 0.00021; 3371/3670 tok/s;  55620 sec
[2019-09-08 23:56:41,359 INFO] Loading dataset from data/data.train.1.pt
[2019-09-08 23:56:59,733 INFO] number of examples: 805546
[2019-09-08 23:57:22,399 INFO] Step 53950/10000000; acc:  69.99; ppl:  3.86; xent: 1.35; lr: 0.00021; 2111/2526 tok/s;  55693 sec
[2019-09-08 23:58:10,836 INFO] Step 54000/10000000; acc:  53.04; ppl:  8.59; xent: 2.15; lr: 0.00021; 3299/3687 tok/s;  55742 sec
[2019-09-08 23:58:15,267 INFO] Saving checkpoint ./transformer_model_step_54000.pt
[2019-09-08 23:59:12,263 INFO] Step 54050/10000000; acc:  54.38; ppl:  7.84; xent: 2.06; lr: 0.00021; 2669/2957 tok/s;  55803 sec
[2019-09-09 00:00:02,035 INFO] Step 54100/10000000; acc:  54.11; ppl:  7.72; xent: 2.04; lr: 0.00021; 3286/3782 tok/s;  55853 sec
[2019-09-09 00:00:50,058 INFO] Step 54150/10000000; acc:  54.12; ppl:  7.94; xent: 2.07; lr: 0.00021; 3282/3809 tok/s;  55901 sec
[2019-09-09 00:01:37,967 INFO] Step 54200/10000000; acc:  53.48; ppl:  8.01; xent: 2.08; lr: 0.00021; 3384/3711 tok/s;  55949 sec
[2019-09-09 00:02:25,396 INFO] Step 54250/10000000; acc:  54.82; ppl:  7.56; xent: 2.02; lr: 0.00021; 3405/3736 tok/s;  55996 sec
[2019-09-09 00:03:14,340 INFO] Step 54300/10000000; acc:  54.46; ppl:  7.63; xent: 2.03; lr: 0.00021; 3270/3773 tok/s;  56045 sec
[2019-09-09 00:04:02,978 INFO] Step 54350/10000000; acc:  54.12; ppl:  7.83; xent: 2.06; lr: 0.00021; 3301/3778 tok/s;  56094 sec
[2019-09-09 00:04:50,878 INFO] Step 54400/10000000; acc:  54.88; ppl:  7.54; xent: 2.02; lr: 0.00021; 3373/3760 tok/s;  56142 sec
[2019-09-09 00:05:39,420 INFO] Step 54450/10000000; acc:  54.58; ppl:  7.61; xent: 2.03; lr: 0.00021; 3242/3761 tok/s;  56190 sec
[2019-09-09 00:06:27,904 INFO] Step 54500/10000000; acc:  54.08; ppl:  7.75; xent: 2.05; lr: 0.00021; 3422/3789 tok/s;  56239 sec
[2019-09-09 00:07:15,928 INFO] Step 54550/10000000; acc:  54.54; ppl:  7.63; xent: 2.03; lr: 0.00021; 3412/3717 tok/s;  56287 sec
[2019-09-09 00:08:04,582 INFO] Step 54600/10000000; acc:  54.24; ppl:  7.68; xent: 2.04; lr: 0.00021; 3291/3727 tok/s;  56336 sec
[2019-09-09 00:08:52,996 INFO] Step 54650/10000000; acc:  55.49; ppl:  7.18; xent: 1.97; lr: 0.00021; 3299/3769 tok/s;  56384 sec
[2019-09-09 00:09:41,799 INFO] Step 54700/10000000; acc:  54.45; ppl:  7.41; xent: 2.00; lr: 0.00021; 3321/3712 tok/s;  56433 sec
[2019-09-09 00:10:30,396 INFO] Step 54750/10000000; acc:  54.61; ppl:  7.46; xent: 2.01; lr: 0.00021; 3250/3694 tok/s;  56481 sec
[2019-09-09 00:11:18,402 INFO] Step 54800/10000000; acc:  55.47; ppl:  7.22; xent: 1.98; lr: 0.00021; 3291/3759 tok/s;  56529 sec
[2019-09-09 00:12:07,447 INFO] Step 54850/10000000; acc:  55.08; ppl:  7.28; xent: 1.99; lr: 0.00021; 3275/3759 tok/s;  56578 sec
[2019-09-09 00:12:55,657 INFO] Step 54900/10000000; acc:  54.01; ppl:  7.79; xent: 2.05; lr: 0.00021; 3216/3779 tok/s;  56627 sec
[2019-09-09 00:13:44,613 INFO] Step 54950/10000000; acc:  55.42; ppl:  7.11; xent: 1.96; lr: 0.00021; 3386/3777 tok/s;  56676 sec
[2019-09-09 00:14:33,296 INFO] Step 55000/10000000; acc:  54.68; ppl:  7.33; xent: 1.99; lr: 0.00021; 3392/3742 tok/s;  56724 sec
[2019-09-09 00:14:37,730 INFO] Saving checkpoint ./transformer_model_step_55000.pt
[2019-09-09 00:15:35,187 INFO] Step 55050/10000000; acc:  54.75; ppl:  7.32; xent: 1.99; lr: 0.00022; 2630/2979 tok/s;  56786 sec
[2019-09-09 00:16:26,555 INFO] Step 55100/10000000; acc:  54.12; ppl:  7.45; xent: 2.01; lr: 0.00022; 3137/3514 tok/s;  56838 sec
[2019-09-09 00:17:14,642 INFO] Step 55150/10000000; acc:  55.38; ppl:  7.23; xent: 1.98; lr: 0.00022; 3226/3789 tok/s;  56886 sec
[2019-09-09 00:18:03,786 INFO] Step 55200/10000000; acc:  54.76; ppl:  7.17; xent: 1.97; lr: 0.00022; 3371/3793 tok/s;  56935 sec
[2019-09-09 00:18:51,905 INFO] Step 55250/10000000; acc:  55.16; ppl:  7.19; xent: 1.97; lr: 0.00022; 3352/3743 tok/s;  56983 sec
[2019-09-09 00:19:39,618 INFO] Step 55300/10000000; acc:  55.17; ppl:  7.18; xent: 1.97; lr: 0.00022; 3333/3762 tok/s;  57031 sec
[2019-09-09 00:20:27,790 INFO] Step 55350/10000000; acc:  56.20; ppl:  6.92; xent: 1.93; lr: 0.00022; 3329/3770 tok/s;  57079 sec
[2019-09-09 00:21:16,139 INFO] Step 55400/10000000; acc:  55.20; ppl:  7.17; xent: 1.97; lr: 0.00022; 3321/3631 tok/s;  57127 sec
[2019-09-09 00:22:05,134 INFO] Step 55450/10000000; acc:  54.90; ppl:  7.25; xent: 1.98; lr: 0.00022; 3319/3740 tok/s;  57176 sec
[2019-09-09 00:22:53,298 INFO] Step 55500/10000000; acc:  56.40; ppl:  6.78; xent: 1.91; lr: 0.00022; 3357/3777 tok/s;  57224 sec
[2019-09-09 00:23:42,517 INFO] Step 55550/10000000; acc:  54.34; ppl:  7.49; xent: 2.01; lr: 0.00022; 3276/3692 tok/s;  57273 sec
[2019-09-09 00:24:31,556 INFO] Step 55600/10000000; acc:  55.48; ppl:  6.98; xent: 1.94; lr: 0.00022; 3346/3802 tok/s;  57323 sec
[2019-09-09 00:25:20,639 INFO] Step 55650/10000000; acc:  54.94; ppl:  7.13; xent: 1.96; lr: 0.00022; 3362/3802 tok/s;  57372 sec
[2019-09-09 00:26:09,715 INFO] Step 55700/10000000; acc:  54.95; ppl:  7.22; xent: 1.98; lr: 0.00022; 3257/3749 tok/s;  57421 sec
[2019-09-09 00:26:58,670 INFO] Step 55750/10000000; acc:  55.25; ppl:  7.07; xent: 1.96; lr: 0.00022; 3278/3711 tok/s;  57470 sec
[2019-09-09 00:27:48,411 INFO] Step 55800/10000000; acc:  56.49; ppl:  6.62; xent: 1.89; lr: 0.00022; 3289/3807 tok/s;  57519 sec
[2019-09-09 00:28:36,741 INFO] Step 55850/10000000; acc:  55.01; ppl:  7.28; xent: 1.98; lr: 0.00022; 3284/3754 tok/s;  57568 sec
[2019-09-09 00:29:25,178 INFO] Step 55900/10000000; acc:  54.25; ppl:  7.49; xent: 2.01; lr: 0.00022; 3230/3680 tok/s;  57616 sec
[2019-09-09 00:30:13,290 INFO] Step 55950/10000000; acc:  55.43; ppl:  7.12; xent: 1.96; lr: 0.00022; 3321/3676 tok/s;  57664 sec
[2019-09-09 00:31:01,542 INFO] Step 56000/10000000; acc:  56.22; ppl:  6.76; xent: 1.91; lr: 0.00022; 3288/3738 tok/s;  57713 sec
[2019-09-09 00:31:05,979 INFO] Saving checkpoint ./transformer_model_step_56000.pt
[2019-09-09 00:32:03,122 INFO] Step 56050/10000000; acc:  55.85; ppl:  6.80; xent: 1.92; lr: 0.00022; 2642/2965 tok/s;  57774 sec
[2019-09-09 00:32:51,269 INFO] Step 56100/10000000; acc:  55.51; ppl:  7.01; xent: 1.95; lr: 0.00022; 3336/3786 tok/s;  57822 sec
[2019-09-09 00:33:38,607 INFO] Step 56150/10000000; acc:  56.23; ppl:  6.91; xent: 1.93; lr: 0.00022; 3274/3749 tok/s;  57870 sec
[2019-09-09 00:34:26,782 INFO] Step 56200/10000000; acc:  55.13; ppl:  7.10; xent: 1.96; lr: 0.00022; 3204/3714 tok/s;  57918 sec
[2019-09-09 00:35:16,696 INFO] Step 56250/10000000; acc:  55.86; ppl:  6.76; xent: 1.91; lr: 0.00022; 3354/3704 tok/s;  57968 sec
[2019-09-09 00:36:05,694 INFO] Step 56300/10000000; acc:  55.69; ppl:  6.96; xent: 1.94; lr: 0.00022; 3233/3741 tok/s;  58017 sec
[2019-09-09 00:36:54,557 INFO] Step 56350/10000000; acc:  55.48; ppl:  6.88; xent: 1.93; lr: 0.00022; 3282/3696 tok/s;  58066 sec
[2019-09-09 00:37:41,856 INFO] Step 56400/10000000; acc:  56.44; ppl:  6.80; xent: 1.92; lr: 0.00022; 3192/3682 tok/s;  58113 sec
[2019-09-09 00:38:30,868 INFO] Step 56450/10000000; acc:  55.28; ppl:  6.97; xent: 1.94; lr: 0.00022; 3288/3652 tok/s;  58162 sec
[2019-09-09 00:39:20,361 INFO] Step 56500/10000000; acc:  55.56; ppl:  6.77; xent: 1.91; lr: 0.00022; 3372/3726 tok/s;  58211 sec
[2019-09-09 00:40:09,075 INFO] Step 56550/10000000; acc:  55.83; ppl:  6.84; xent: 1.92; lr: 0.00022; 3220/3679 tok/s;  58260 sec
[2019-09-09 00:40:57,615 INFO] Step 56600/10000000; acc:  55.86; ppl:  6.92; xent: 1.93; lr: 0.00022; 3265/3646 tok/s;  58309 sec
[2019-09-09 00:41:45,770 INFO] Step 56650/10000000; acc:  55.65; ppl:  6.93; xent: 1.94; lr: 0.00022; 3333/3650 tok/s;  58357 sec
[2019-09-09 00:42:34,361 INFO] Step 56700/10000000; acc:  57.25; ppl:  6.55; xent: 1.88; lr: 0.00022; 3238/3736 tok/s;  58405 sec
[2019-09-09 00:43:23,599 INFO] Step 56750/10000000; acc:  55.52; ppl:  6.97; xent: 1.94; lr: 0.00022; 3205/3686 tok/s;  58455 sec
[2019-09-09 00:44:12,038 INFO] Step 56800/10000000; acc:  55.39; ppl:  6.95; xent: 1.94; lr: 0.00022; 3331/3718 tok/s;  58503 sec
[2019-09-09 00:44:41,934 INFO] Loading dataset from data/data.train.0.pt
[2019-09-09 00:45:13,028 INFO] number of examples: 947346
[2019-09-09 00:45:37,318 INFO] Step 56850/10000000; acc:  60.14; ppl:  5.71; xent: 1.74; lr: 0.00022; 1798/2053 tok/s;  58588 sec
[2019-09-09 00:46:25,792 INFO] Step 56900/10000000; acc:  71.22; ppl:  3.52; xent: 1.26; lr: 0.00022; 3290/3716 tok/s;  58637 sec
[2019-09-09 00:47:14,045 INFO] Step 56950/10000000; acc:  72.06; ppl:  3.45; xent: 1.24; lr: 0.00022; 3274/3712 tok/s;  58685 sec
[2019-09-09 00:48:01,977 INFO] Step 57000/10000000; acc:  73.11; ppl:  3.26; xent: 1.18; lr: 0.00022; 3335/3668 tok/s;  58733 sec
[2019-09-09 00:48:06,476 INFO] Saving checkpoint ./transformer_model_step_57000.pt
[2019-09-09 00:49:19,055 INFO] Step 57050/10000000; acc:  73.24; ppl:  3.27; xent: 1.18; lr: 0.00022; 2051/2402 tok/s;  58810 sec
[2019-09-09 00:50:07,026 INFO] Step 57100/10000000; acc:  74.21; ppl:  3.11; xent: 1.13; lr: 0.00022; 3277/3702 tok/s;  58858 sec
[2019-09-09 00:50:55,578 INFO] Step 57150/10000000; acc:  74.13; ppl:  3.09; xent: 1.13; lr: 0.00022; 3400/3735 tok/s;  58907 sec
[2019-09-09 00:51:43,473 INFO] Step 57200/10000000; acc:  74.70; ppl:  3.04; xent: 1.11; lr: 0.00022; 3306/3693 tok/s;  58954 sec
[2019-09-09 00:52:31,276 INFO] Step 57250/10000000; acc:  74.75; ppl:  3.06; xent: 1.12; lr: 0.00022; 3253/3758 tok/s;  59002 sec
[2019-09-09 00:53:20,517 INFO] Step 57300/10000000; acc:  75.05; ppl:  2.98; xent: 1.09; lr: 0.00022; 3226/3782 tok/s;  59051 sec
[2019-09-09 00:54:07,857 INFO] Step 57350/10000000; acc:  74.16; ppl:  3.13; xent: 1.14; lr: 0.00022; 3209/3707 tok/s;  59099 sec
[2019-09-09 00:54:55,491 INFO] Step 57400/10000000; acc:  74.77; ppl:  3.04; xent: 1.11; lr: 0.00022; 3235/3780 tok/s;  59146 sec
[2019-09-09 00:55:44,793 INFO] Step 57450/10000000; acc:  75.64; ppl:  2.92; xent: 1.07; lr: 0.00022; 3073/3687 tok/s;  59196 sec
[2019-09-09 00:56:33,595 INFO] Step 57500/10000000; acc:  75.22; ppl:  2.95; xent: 1.08; lr: 0.00022; 3237/3798 tok/s;  59245 sec
[2019-09-09 00:57:21,588 INFO] Step 57550/10000000; acc:  75.79; ppl:  2.90; xent: 1.06; lr: 0.00022; 3303/3719 tok/s;  59293 sec
[2019-09-09 00:58:09,808 INFO] Step 57600/10000000; acc:  75.48; ppl:  2.94; xent: 1.08; lr: 0.00023; 3277/3754 tok/s;  59341 sec
[2019-09-09 00:58:58,130 INFO] Step 57650/10000000; acc:  76.00; ppl:  2.86; xent: 1.05; lr: 0.00023; 3294/3735 tok/s;  59389 sec
[2019-09-09 00:59:46,244 INFO] Step 57700/10000000; acc:  75.31; ppl:  2.96; xent: 1.09; lr: 0.00023; 3246/3784 tok/s;  59437 sec
[2019-09-09 01:00:35,229 INFO] Step 57750/10000000; acc:  76.43; ppl:  2.80; xent: 1.03; lr: 0.00023; 3262/3686 tok/s;  59486 sec
[2019-09-09 01:01:23,488 INFO] Step 57800/10000000; acc:  75.70; ppl:  2.89; xent: 1.06; lr: 0.00023; 3244/3710 tok/s;  59534 sec
[2019-09-09 01:02:11,578 INFO] Step 57850/10000000; acc:  75.91; ppl:  2.87; xent: 1.06; lr: 0.00023; 3320/3694 tok/s;  59583 sec
[2019-09-09 01:02:58,891 INFO] Step 57900/10000000; acc:  75.00; ppl:  3.01; xent: 1.10; lr: 0.00023; 3299/3763 tok/s;  59630 sec
[2019-09-09 01:03:47,045 INFO] Step 57950/10000000; acc:  76.89; ppl:  2.76; xent: 1.01; lr: 0.00023; 3263/3688 tok/s;  59678 sec
[2019-09-09 01:04:38,392 INFO] Step 58000/10000000; acc:  77.43; ppl:  2.69; xent: 0.99; lr: 0.00023; 3134/3548 tok/s;  59729 sec
[2019-09-09 01:04:42,891 INFO] Saving checkpoint ./transformer_model_step_58000.pt
[2019-09-09 01:05:57,049 INFO] Step 58050/10000000; acc:  77.16; ppl:  2.73; xent: 1.00; lr: 0.00023; 1986/2333 tok/s;  59808 sec
[2019-09-09 01:06:44,977 INFO] Step 58100/10000000; acc:  76.53; ppl:  2.82; xent: 1.04; lr: 0.00023; 3251/3703 tok/s;  59856 sec
[2019-09-09 01:07:33,375 INFO] Step 58150/10000000; acc:  76.93; ppl:  2.76; xent: 1.01; lr: 0.00023; 3204/3747 tok/s;  59904 sec
[2019-09-09 01:08:22,069 INFO] Step 58200/10000000; acc:  76.86; ppl:  2.75; xent: 1.01; lr: 0.00023; 3265/3756 tok/s;  59953 sec
[2019-09-09 01:09:10,207 INFO] Step 58250/10000000; acc:  76.07; ppl:  2.82; xent: 1.04; lr: 0.00023; 3420/3697 tok/s;  60001 sec
[2019-09-09 01:09:58,398 INFO] Step 58300/10000000; acc:  76.34; ppl:  2.81; xent: 1.03; lr: 0.00023; 3147/3764 tok/s;  60049 sec
[2019-09-09 01:10:46,146 INFO] Step 58350/10000000; acc:  76.47; ppl:  2.78; xent: 1.02; lr: 0.00023; 3303/3792 tok/s;  60097 sec
[2019-09-09 01:11:34,921 INFO] Step 58400/10000000; acc:  77.11; ppl:  2.71; xent: 1.00; lr: 0.00023; 3362/3741 tok/s;  60146 sec
[2019-09-09 01:12:23,030 INFO] Step 58450/10000000; acc:  77.00; ppl:  2.72; xent: 1.00; lr: 0.00023; 3275/3756 tok/s;  60194 sec
[2019-09-09 01:13:11,714 INFO] Step 58500/10000000; acc:  77.05; ppl:  2.73; xent: 1.01; lr: 0.00023; 3285/3740 tok/s;  60243 sec
[2019-09-09 01:13:58,950 INFO] Step 58550/10000000; acc:  77.73; ppl:  2.68; xent: 0.99; lr: 0.00023; 3220/3611 tok/s;  60290 sec
[2019-09-09 01:14:46,312 INFO] Step 58600/10000000; acc:  76.81; ppl:  2.79; xent: 1.03; lr: 0.00023; 3244/3699 tok/s;  60337 sec
[2019-09-09 01:15:35,364 INFO] Step 58650/10000000; acc:  77.26; ppl:  2.69; xent: 0.99; lr: 0.00023; 3312/3737 tok/s;  60386 sec
[2019-09-09 01:16:24,105 INFO] Step 58700/10000000; acc:  76.67; ppl:  2.79; xent: 1.03; lr: 0.00023; 3223/3686 tok/s;  60435 sec
[2019-09-09 01:17:12,621 INFO] Step 58750/10000000; acc:  77.57; ppl:  2.65; xent: 0.97; lr: 0.00023; 3361/3697 tok/s;  60484 sec
[2019-09-09 01:18:01,520 INFO] Step 58800/10000000; acc:  77.52; ppl:  2.70; xent: 1.00; lr: 0.00023; 3225/3634 tok/s;  60532 sec
[2019-09-09 01:18:50,220 INFO] Step 58850/10000000; acc:  77.41; ppl:  2.67; xent: 0.98; lr: 0.00023; 3263/3694 tok/s;  60581 sec
[2019-09-09 01:19:38,313 INFO] Step 58900/10000000; acc:  77.15; ppl:  2.74; xent: 1.01; lr: 0.00023; 3163/3659 tok/s;  60629 sec
[2019-09-09 01:20:25,541 INFO] Step 58950/10000000; acc:  76.38; ppl:  2.83; xent: 1.04; lr: 0.00023; 3285/3697 tok/s;  60677 sec
[2019-09-09 01:21:13,259 INFO] Step 59000/10000000; acc:  76.96; ppl:  2.75; xent: 1.01; lr: 0.00023; 3224/3806 tok/s;  60724 sec
[2019-09-09 01:21:17,759 INFO] Saving checkpoint ./transformer_model_step_59000.pt
[2019-09-09 01:22:37,675 INFO] Step 59050/10000000; acc:  76.22; ppl:  2.81; xent: 1.03; lr: 0.00023; 1929/2092 tok/s;  60809 sec
[2019-09-09 01:23:25,279 INFO] Step 59100/10000000; acc:  77.38; ppl:  2.72; xent: 1.00; lr: 0.00023; 3115/3800 tok/s;  60856 sec
[2019-09-09 01:24:13,939 INFO] Step 59150/10000000; acc:  77.74; ppl:  2.63; xent: 0.97; lr: 0.00023; 3310/3746 tok/s;  60905 sec
[2019-09-09 01:25:03,282 INFO] Step 59200/10000000; acc:  76.73; ppl:  2.77; xent: 1.02; lr: 0.00023; 3179/3600 tok/s;  60954 sec
[2019-09-09 01:25:51,359 INFO] Step 59250/10000000; acc:  77.55; ppl:  2.66; xent: 0.98; lr: 0.00023; 3326/3733 tok/s;  61002 sec
[2019-09-09 01:26:40,002 INFO] Step 59300/10000000; acc:  77.40; ppl:  2.68; xent: 0.99; lr: 0.00023; 3266/3742 tok/s;  61051 sec
[2019-09-09 01:27:28,181 INFO] Step 59350/10000000; acc:  77.93; ppl:  2.63; xent: 0.97; lr: 0.00023; 3320/3759 tok/s;  61099 sec
[2019-09-09 01:28:16,705 INFO] Step 59400/10000000; acc:  78.70; ppl:  2.56; xent: 0.94; lr: 0.00023; 3135/3725 tok/s;  61148 sec
[2019-09-09 01:29:04,309 INFO] Step 59450/10000000; acc:  77.79; ppl:  2.64; xent: 0.97; lr: 0.00023; 3367/3726 tok/s;  61195 sec
[2019-09-09 01:29:51,978 INFO] Step 59500/10000000; acc:  77.60; ppl:  2.69; xent: 0.99; lr: 0.00023; 3204/3624 tok/s;  61243 sec
[2019-09-09 01:30:40,322 INFO] Step 59550/10000000; acc:  77.80; ppl:  2.62; xent: 0.96; lr: 0.00023; 3312/3730 tok/s;  61291 sec
[2019-09-09 01:31:29,169 INFO] Step 59600/10000000; acc:  77.07; ppl:  2.70; xent: 0.99; lr: 0.00023; 3268/3746 tok/s;  61340 sec
[2019-09-09 01:32:17,119 INFO] Step 59650/10000000; acc:  77.68; ppl:  2.68; xent: 0.99; lr: 0.00023; 3281/3675 tok/s;  61388 sec
[2019-09-09 01:33:06,637 INFO] Step 59700/10000000; acc:  77.75; ppl:  2.65; xent: 0.97; lr: 0.00023; 3097/3739 tok/s;  61438 sec
[2019-09-09 01:33:55,505 INFO] Step 59750/10000000; acc:  78.35; ppl:  2.60; xent: 0.96; lr: 0.00023; 3183/3797 tok/s;  61486 sec
[2019-09-09 01:34:43,693 INFO] Step 59800/10000000; acc:  76.89; ppl:  2.76; xent: 1.01; lr: 0.00023; 3199/3719 tok/s;  61535 sec
[2019-09-09 01:35:31,009 INFO] Step 59850/10000000; acc:  77.59; ppl:  2.66; xent: 0.98; lr: 0.00023; 3227/3758 tok/s;  61582 sec
[2019-09-09 01:36:18,752 INFO] Step 59900/10000000; acc:  76.85; ppl:  2.75; xent: 1.01; lr: 0.00023; 3411/3698 tok/s;  61630 sec
[2019-09-09 01:37:08,032 INFO] Step 59950/10000000; acc:  77.58; ppl:  2.64; xent: 0.97; lr: 0.00023; 3246/3666 tok/s;  61679 sec
[2019-09-09 01:37:56,426 INFO] Step 60000/10000000; acc:  77.23; ppl:  2.71; xent: 1.00; lr: 0.00023; 3176/3743 tok/s;  61727 sec
[2019-09-09 01:37:56,428 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-09 01:37:58,146 INFO] number of examples: 100000
[2019-09-09 01:45:32,022 INFO] Validation perplexity: 11.6738
[2019-09-09 01:45:32,023 INFO] Validation accuracy: 52.364
[2019-09-09 01:45:36,530 INFO] Saving checkpoint ./transformer_model_step_60000.pt
[2019-09-09 01:46:49,983 INFO] Step 60050/10000000; acc:  78.26; ppl:  2.58; xent: 0.95; lr: 0.00023; 291/347 tok/s;  62261 sec
[2019-09-09 01:47:38,373 INFO] Step 60100/10000000; acc:  78.79; ppl:  2.53; xent: 0.93; lr: 0.00023; 3291/3709 tok/s;  62309 sec
[2019-09-09 01:48:26,314 INFO] Step 60150/10000000; acc:  78.22; ppl:  2.65; xent: 0.98; lr: 0.00023; 3181/3651 tok/s;  62357 sec
[2019-09-09 01:49:14,589 INFO] Step 60200/10000000; acc:  78.10; ppl:  2.61; xent: 0.96; lr: 0.00024; 3340/3726 tok/s;  62406 sec
[2019-09-09 01:50:00,914 INFO] Loading dataset from data/data.train.1.pt
[2019-09-09 01:50:26,271 INFO] number of examples: 805546
[2019-09-09 01:50:35,534 INFO] Step 60250/10000000; acc:  77.56; ppl:  2.67; xent: 0.98; lr: 0.00024; 1986/2252 tok/s;  62487 sec
[2019-09-09 01:51:23,939 INFO] Step 60300/10000000; acc:  54.74; ppl:  7.68; xent: 2.04; lr: 0.00024; 3259/3684 tok/s;  62535 sec
[2019-09-09 01:52:12,775 INFO] Step 60350/10000000; acc:  55.05; ppl:  7.53; xent: 2.02; lr: 0.00024; 3258/3729 tok/s;  62584 sec
[2019-09-09 01:53:02,867 INFO] Step 60400/10000000; acc:  55.27; ppl:  7.11; xent: 1.96; lr: 0.00024; 3319/3767 tok/s;  62634 sec
[2019-09-09 01:53:51,399 INFO] Step 60450/10000000; acc:  54.70; ppl:  7.50; xent: 2.01; lr: 0.00024; 3292/3796 tok/s;  62682 sec
[2019-09-09 01:54:39,056 INFO] Step 60500/10000000; acc:  55.11; ppl:  7.29; xent: 1.99; lr: 0.00024; 3397/3708 tok/s;  62730 sec
[2019-09-09 01:55:26,665 INFO] Step 60550/10000000; acc:  55.98; ppl:  7.10; xent: 1.96; lr: 0.00024; 3346/3740 tok/s;  62778 sec
[2019-09-09 01:56:15,248 INFO] Step 60600/10000000; acc:  55.93; ppl:  6.91; xent: 1.93; lr: 0.00024; 3305/3768 tok/s;  62826 sec
[2019-09-09 01:57:03,802 INFO] Step 60650/10000000; acc:  54.88; ppl:  7.46; xent: 2.01; lr: 0.00024; 3305/3796 tok/s;  62875 sec
[2019-09-09 01:57:52,312 INFO] Step 60700/10000000; acc:  55.32; ppl:  7.24; xent: 1.98; lr: 0.00024; 3431/3750 tok/s;  62923 sec
[2019-09-09 01:58:40,421 INFO] Step 60750/10000000; acc:  57.00; ppl:  6.76; xent: 1.91; lr: 0.00024; 3177/3757 tok/s;  62971 sec
[2019-09-09 01:59:29,048 INFO] Step 60800/10000000; acc:  54.72; ppl:  7.42; xent: 2.00; lr: 0.00024; 3319/3803 tok/s;  63020 sec
[2019-09-09 02:00:16,978 INFO] Step 60850/10000000; acc:  55.58; ppl:  7.07; xent: 1.96; lr: 0.00024; 3480/3722 tok/s;  63068 sec
[2019-09-09 02:01:05,714 INFO] Step 60900/10000000; acc:  55.46; ppl:  7.11; xent: 1.96; lr: 0.00024; 3322/3722 tok/s;  63117 sec
[2019-09-09 02:01:54,357 INFO] Step 60950/10000000; acc:  55.69; ppl:  6.99; xent: 1.94; lr: 0.00024; 3326/3728 tok/s;  63165 sec
[2019-09-09 02:02:42,764 INFO] Step 61000/10000000; acc:  55.79; ppl:  6.90; xent: 1.93; lr: 0.00024; 3254/3730 tok/s;  63214 sec
[2019-09-09 02:02:47,246 INFO] Saving checkpoint ./transformer_model_step_61000.pt
[2019-09-09 02:04:07,098 INFO] Step 61050/10000000; acc:  56.00; ppl:  6.80; xent: 1.92; lr: 0.00024; 1937/2171 tok/s;  63298 sec
[2019-09-09 02:04:54,871 INFO] Step 61100/10000000; acc:  56.02; ppl:  6.91; xent: 1.93; lr: 0.00024; 3247/3688 tok/s;  63346 sec
[2019-09-09 02:05:43,971 INFO] Step 61150/10000000; acc:  55.74; ppl:  6.94; xent: 1.94; lr: 0.00024; 3281/3766 tok/s;  63395 sec
[2019-09-09 02:06:32,145 INFO] Step 61200/10000000; acc:  55.82; ppl:  7.06; xent: 1.95; lr: 0.00024; 3217/3778 tok/s;  63443 sec
[2019-09-09 02:07:21,135 INFO] Step 61250/10000000; acc:  55.86; ppl:  6.87; xent: 1.93; lr: 0.00024; 3346/3781 tok/s;  63492 sec
[2019-09-09 02:08:09,705 INFO] Step 61300/10000000; acc:  56.07; ppl:  6.78; xent: 1.91; lr: 0.00024; 3371/3742 tok/s;  63541 sec
[2019-09-09 02:08:58,926 INFO] Step 61350/10000000; acc:  55.57; ppl:  6.84; xent: 1.92; lr: 0.00024; 3338/3757 tok/s;  63590 sec
[2019-09-09 02:09:48,021 INFO] Step 61400/10000000; acc:  55.44; ppl:  6.99; xent: 1.94; lr: 0.00024; 3235/3672 tok/s;  63639 sec
[2019-09-09 02:10:38,848 INFO] Step 61450/10000000; acc:  55.57; ppl:  6.97; xent: 1.94; lr: 0.00024; 3131/3640 tok/s;  63690 sec
[2019-09-09 02:11:27,321 INFO] Step 61500/10000000; acc:  56.28; ppl:  6.73; xent: 1.91; lr: 0.00024; 3375/3721 tok/s;  63738 sec
[2019-09-09 02:12:16,100 INFO] Step 61550/10000000; acc:  56.39; ppl:  6.63; xent: 1.89; lr: 0.00024; 3300/3822 tok/s;  63787 sec
[2019-09-09 02:13:04,504 INFO] Step 61600/10000000; acc:  55.39; ppl:  6.92; xent: 1.93; lr: 0.00024; 3389/3700 tok/s;  63835 sec
[2019-09-09 02:13:51,746 INFO] Step 61650/10000000; acc:  57.76; ppl:  6.47; xent: 1.87; lr: 0.00024; 3283/3785 tok/s;  63883 sec
[2019-09-09 02:14:40,375 INFO] Step 61700/10000000; acc:  56.20; ppl:  6.65; xent: 1.89; lr: 0.00024; 3383/3681 tok/s;  63931 sec
[2019-09-09 02:15:29,401 INFO] Step 61750/10000000; acc:  55.67; ppl:  6.85; xent: 1.92; lr: 0.00024; 3292/3713 tok/s;  63980 sec
[2019-09-09 02:16:17,386 INFO] Step 61800/10000000; acc:  57.79; ppl:  6.35; xent: 1.85; lr: 0.00024; 3295/3747 tok/s;  64028 sec
[2019-09-09 02:17:06,212 INFO] Step 61850/10000000; acc:  55.48; ppl:  6.89; xent: 1.93; lr: 0.00024; 3332/3742 tok/s;  64077 sec
[2019-09-09 02:17:55,406 INFO] Step 61900/10000000; acc:  56.03; ppl:  6.68; xent: 1.90; lr: 0.00024; 3328/3756 tok/s;  64126 sec
[2019-09-09 02:18:44,520 INFO] Step 61950/10000000; acc:  55.82; ppl:  6.76; xent: 1.91; lr: 0.00024; 3353/3784 tok/s;  64175 sec
[2019-09-09 02:19:33,961 INFO] Step 62000/10000000; acc:  56.27; ppl:  6.64; xent: 1.89; lr: 0.00024; 3283/3808 tok/s;  64225 sec
[2019-09-09 02:19:38,464 INFO] Saving checkpoint ./transformer_model_step_62000.pt
[2019-09-09 02:20:52,413 INFO] Step 62050/10000000; acc:  55.68; ppl:  6.78; xent: 1.91; lr: 0.00024; 2056/2277 tok/s;  64303 sec
[2019-09-09 02:21:42,032 INFO] Step 62100/10000000; acc:  57.63; ppl:  6.25; xent: 1.83; lr: 0.00024; 3258/3794 tok/s;  64353 sec
[2019-09-09 02:22:30,644 INFO] Step 62150/10000000; acc:  55.77; ppl:  6.94; xent: 1.94; lr: 0.00024; 3290/3767 tok/s;  64402 sec
[2019-09-09 02:23:18,894 INFO] Step 62200/10000000; acc:  56.48; ppl:  6.59; xent: 1.89; lr: 0.00024; 3324/3715 tok/s;  64450 sec
[2019-09-09 02:24:07,659 INFO] Step 62250/10000000; acc:  55.76; ppl:  6.87; xent: 1.93; lr: 0.00024; 3211/3651 tok/s;  64499 sec
[2019-09-09 02:24:55,276 INFO] Step 62300/10000000; acc:  57.17; ppl:  6.43; xent: 1.86; lr: 0.00024; 3346/3715 tok/s;  64546 sec
[2019-09-09 02:25:44,396 INFO] Step 62350/10000000; acc:  56.66; ppl:  6.53; xent: 1.88; lr: 0.00024; 3263/3736 tok/s;  64595 sec
[2019-09-09 02:26:32,597 INFO] Step 62400/10000000; acc:  56.51; ppl:  6.62; xent: 1.89; lr: 0.00024; 3294/3772 tok/s;  64644 sec
[2019-09-09 02:27:20,142 INFO] Step 62450/10000000; acc:  57.51; ppl:  6.28; xent: 1.84; lr: 0.00024; 3369/3773 tok/s;  64691 sec
[2019-09-09 02:28:08,471 INFO] Step 62500/10000000; acc:  55.84; ppl:  6.78; xent: 1.91; lr: 0.00024; 3162/3736 tok/s;  64739 sec
[2019-09-09 02:28:56,958 INFO] Step 62550/10000000; acc:  56.62; ppl:  6.49; xent: 1.87; lr: 0.00024; 3389/3726 tok/s;  64788 sec
[2019-09-09 02:29:47,533 INFO] Step 62600/10000000; acc:  56.02; ppl:  6.64; xent: 1.89; lr: 0.00024; 3216/3673 tok/s;  64839 sec
[2019-09-09 02:30:36,026 INFO] Step 62650/10000000; acc:  56.96; ppl:  6.37; xent: 1.85; lr: 0.00024; 3293/3685 tok/s;  64887 sec
[2019-09-09 02:31:24,141 INFO] Step 62700/10000000; acc:  56.21; ppl:  6.59; xent: 1.89; lr: 0.00024; 3225/3699 tok/s;  64935 sec
[2019-09-09 02:32:12,615 INFO] Step 62750/10000000; acc:  57.98; ppl:  6.18; xent: 1.82; lr: 0.00025; 3209/3638 tok/s;  64984 sec
[2019-09-09 02:33:01,838 INFO] Step 62800/10000000; acc:  55.96; ppl:  6.64; xent: 1.89; lr: 0.00025; 3327/3722 tok/s;  65033 sec
[2019-09-09 02:33:51,352 INFO] Step 62850/10000000; acc:  56.68; ppl:  6.45; xent: 1.86; lr: 0.00025; 3241/3622 tok/s;  65082 sec
[2019-09-09 02:34:39,957 INFO] Step 62900/10000000; acc:  56.82; ppl:  6.42; xent: 1.86; lr: 0.00025; 3290/3685 tok/s;  65131 sec
[2019-09-09 02:35:28,223 INFO] Step 62950/10000000; acc:  56.47; ppl:  6.58; xent: 1.88; lr: 0.00025; 3266/3647 tok/s;  65179 sec
[2019-09-09 02:36:16,731 INFO] Step 63000/10000000; acc:  57.51; ppl:  6.32; xent: 1.84; lr: 0.00025; 3260/3726 tok/s;  65228 sec
[2019-09-09 02:36:21,214 INFO] Saving checkpoint ./transformer_model_step_63000.pt
[2019-09-09 02:37:31,913 INFO] Step 63050/10000000; acc:  57.17; ppl:  6.39; xent: 1.86; lr: 0.00025; 2079/2435 tok/s;  65303 sec
[2019-09-09 02:38:20,028 INFO] Step 63100/10000000; acc:  56.32; ppl:  6.55; xent: 1.88; lr: 0.00025; 3354/3703 tok/s;  65351 sec
[2019-09-09 02:39:04,816 INFO] Loading dataset from data/data.train.0.pt
[2019-09-09 02:39:32,222 INFO] number of examples: 947346
[2019-09-09 02:39:42,442 INFO] Step 63150/10000000; acc:  57.35; ppl:  6.31; xent: 1.84; lr: 0.00025; 1884/2160 tok/s;  65433 sec
[2019-09-09 02:40:30,515 INFO] Step 63200/10000000; acc:  71.83; ppl:  3.41; xent: 1.23; lr: 0.00025; 3327/3725 tok/s;  65481 sec
[2019-09-09 02:41:18,746 INFO] Step 63250/10000000; acc:  73.44; ppl:  3.21; xent: 1.17; lr: 0.00025; 3247/3702 tok/s;  65530 sec
[2019-09-09 02:42:06,942 INFO] Step 63300/10000000; acc:  73.61; ppl:  3.18; xent: 1.16; lr: 0.00025; 3396/3695 tok/s;  65578 sec
[2019-09-09 02:42:55,462 INFO] Step 63350/10000000; acc:  74.48; ppl:  3.10; xent: 1.13; lr: 0.00025; 3217/3734 tok/s;  65626 sec
[2019-09-09 02:43:43,792 INFO] Step 63400/10000000; acc:  75.47; ppl:  2.97; xent: 1.09; lr: 0.00025; 3195/3705 tok/s;  65675 sec
[2019-09-09 02:44:32,804 INFO] Step 63450/10000000; acc:  75.00; ppl:  2.96; xent: 1.08; lr: 0.00025; 3395/3716 tok/s;  65724 sec
[2019-09-09 02:45:20,716 INFO] Step 63500/10000000; acc:  76.20; ppl:  2.86; xent: 1.05; lr: 0.00025; 3292/3728 tok/s;  65772 sec
[2019-09-09 02:46:07,906 INFO] Step 63550/10000000; acc:  75.74; ppl:  2.90; xent: 1.06; lr: 0.00025; 3305/3687 tok/s;  65819 sec
[2019-09-09 02:46:57,155 INFO] Step 63600/10000000; acc:  75.61; ppl:  2.87; xent: 1.06; lr: 0.00025; 3293/3799 tok/s;  65868 sec
[2019-09-09 02:47:44,943 INFO] Step 63650/10000000; acc:  75.50; ppl:  2.95; xent: 1.08; lr: 0.00025; 3132/3725 tok/s;  65916 sec
[2019-09-09 02:48:32,689 INFO] Step 63700/10000000; acc:  75.87; ppl:  2.88; xent: 1.06; lr: 0.00025; 3258/3743 tok/s;  65964 sec
[2019-09-09 02:49:21,461 INFO] Step 63750/10000000; acc:  76.62; ppl:  2.80; xent: 1.03; lr: 0.00025; 3155/3676 tok/s;  66012 sec
[2019-09-09 02:50:10,097 INFO] Step 63800/10000000; acc:  75.96; ppl:  2.85; xent: 1.05; lr: 0.00025; 3117/3825 tok/s;  66061 sec
[2019-09-09 02:50:58,516 INFO] Step 63850/10000000; acc:  77.46; ppl:  2.69; xent: 0.99; lr: 0.00025; 3272/3755 tok/s;  66109 sec
[2019-09-09 02:51:46,862 INFO] Step 63900/10000000; acc:  76.86; ppl:  2.76; xent: 1.02; lr: 0.00025; 3304/3721 tok/s;  66158 sec
[2019-09-09 02:52:35,199 INFO] Step 63950/10000000; acc:  76.63; ppl:  2.77; xent: 1.02; lr: 0.00025; 3323/3710 tok/s;  66206 sec
[2019-09-09 02:53:23,021 INFO] Step 64000/10000000; acc:  76.42; ppl:  2.82; xent: 1.04; lr: 0.00025; 3230/3819 tok/s;  66254 sec
[2019-09-09 02:53:27,521 INFO] Saving checkpoint ./transformer_model_step_64000.pt
[2019-09-09 02:54:40,266 INFO] Step 64050/10000000; acc:  77.28; ppl:  2.68; xent: 0.99; lr: 0.00025; 2122/2333 tok/s;  66331 sec
[2019-09-09 02:55:28,322 INFO] Step 64100/10000000; acc:  77.22; ppl:  2.72; xent: 1.00; lr: 0.00025; 3190/3759 tok/s;  66379 sec
[2019-09-09 02:56:16,284 INFO] Step 64150/10000000; acc:  76.97; ppl:  2.72; xent: 1.00; lr: 0.00025; 3320/3698 tok/s;  66427 sec
[2019-09-09 02:57:04,221 INFO] Step 64200/10000000; acc:  76.49; ppl:  2.79; xent: 1.03; lr: 0.00025; 3282/3710 tok/s;  66475 sec
[2019-09-09 02:57:51,769 INFO] Step 64250/10000000; acc:  76.97; ppl:  2.75; xent: 1.01; lr: 0.00025; 3306/3707 tok/s;  66523 sec
[2019-09-09 02:58:40,509 INFO] Step 64300/10000000; acc:  78.00; ppl:  2.61; xent: 0.96; lr: 0.00025; 3233/3743 tok/s;  66571 sec
[2019-09-09 02:59:32,193 INFO] Step 64350/10000000; acc:  78.63; ppl:  2.54; xent: 0.93; lr: 0.00025; 3098/3560 tok/s;  66623 sec
[2019-09-09 03:00:20,612 INFO] Step 64400/10000000; acc:  78.27; ppl:  2.61; xent: 0.96; lr: 0.00025; 3204/3730 tok/s;  66672 sec
[2019-09-09 03:01:08,653 INFO] Step 64450/10000000; acc:  77.19; ppl:  2.69; xent: 0.99; lr: 0.00025; 3239/3764 tok/s;  66720 sec
[2019-09-09 03:01:57,294 INFO] Step 64500/10000000; acc:  78.52; ppl:  2.56; xent: 0.94; lr: 0.00025; 3199/3707 tok/s;  66768 sec
[2019-09-09 03:02:45,204 INFO] Step 64550/10000000; acc:  77.11; ppl:  2.67; xent: 0.98; lr: 0.00025; 3443/3704 tok/s;  66816 sec
[2019-09-09 03:03:33,734 INFO] Step 64600/10000000; acc:  77.56; ppl:  2.65; xent: 0.98; lr: 0.00025; 3261/3762 tok/s;  66865 sec
[2019-09-09 03:04:21,650 INFO] Step 64650/10000000; acc:  77.00; ppl:  2.70; xent: 0.99; lr: 0.00025; 3211/3799 tok/s;  66913 sec
[2019-09-09 03:05:09,865 INFO] Step 64700/10000000; acc:  78.01; ppl:  2.61; xent: 0.96; lr: 0.00025; 3339/3708 tok/s;  66961 sec
[2019-09-09 03:05:58,313 INFO] Step 64750/10000000; acc:  78.32; ppl:  2.56; xent: 0.94; lr: 0.00025; 3319/3750 tok/s;  67009 sec
[2019-09-09 03:06:46,857 INFO] Step 64800/10000000; acc:  78.21; ppl:  2.58; xent: 0.95; lr: 0.00025; 3242/3762 tok/s;  67058 sec
[2019-09-09 03:07:34,429 INFO] Step 64850/10000000; acc:  77.77; ppl:  2.63; xent: 0.97; lr: 0.00025; 3286/3708 tok/s;  67105 sec
[2019-09-09 03:08:20,942 INFO] Step 64900/10000000; acc:  78.27; ppl:  2.59; xent: 0.95; lr: 0.00025; 3281/3656 tok/s;  67152 sec
[2019-09-09 03:09:09,997 INFO] Step 64950/10000000; acc:  78.05; ppl:  2.60; xent: 0.96; lr: 0.00025; 3228/3751 tok/s;  67201 sec
[2019-09-09 03:09:59,004 INFO] Step 65000/10000000; acc:  78.16; ppl:  2.58; xent: 0.95; lr: 0.00025; 3288/3644 tok/s;  67250 sec
[2019-09-09 03:10:03,483 INFO] Saving checkpoint ./transformer_model_step_65000.pt
[2019-09-09 03:11:16,216 INFO] Step 65050/10000000; acc:  77.97; ppl:  2.62; xent: 0.96; lr: 0.00025; 2037/2307 tok/s;  67327 sec
[2019-09-09 03:12:05,583 INFO] Step 65100/10000000; acc:  78.64; ppl:  2.53; xent: 0.93; lr: 0.00025; 3345/3671 tok/s;  67377 sec
[2019-09-09 03:12:53,736 INFO] Step 65150/10000000; acc:  78.62; ppl:  2.56; xent: 0.94; lr: 0.00025; 3213/3656 tok/s;  67425 sec
[2019-09-09 03:13:42,300 INFO] Step 65200/10000000; acc:  78.37; ppl:  2.59; xent: 0.95; lr: 0.00025; 3128/3654 tok/s;  67473 sec
[2019-09-09 03:14:30,001 INFO] Step 65250/10000000; acc:  77.31; ppl:  2.67; xent: 0.98; lr: 0.00025; 3307/3705 tok/s;  67521 sec
[2019-09-09 03:15:17,890 INFO] Step 65300/10000000; acc:  77.64; ppl:  2.65; xent: 0.97; lr: 0.00026; 3219/3835 tok/s;  67569 sec
[2019-09-09 03:16:04,943 INFO] Step 65350/10000000; acc:  77.22; ppl:  2.67; xent: 0.98; lr: 0.00026; 3386/3644 tok/s;  67616 sec
[2019-09-09 03:16:53,316 INFO] Step 65400/10000000; acc:  77.84; ppl:  2.65; xent: 0.97; lr: 0.00026; 3191/3772 tok/s;  67664 sec
[2019-09-09 03:17:41,589 INFO] Step 65450/10000000; acc:  78.90; ppl:  2.50; xent: 0.92; lr: 0.00026; 3248/3741 tok/s;  67713 sec
[2019-09-09 03:18:31,181 INFO] Step 65500/10000000; acc:  77.84; ppl:  2.62; xent: 0.96; lr: 0.00026; 3150/3626 tok/s;  67762 sec
[2019-09-09 03:19:18,932 INFO] Step 65550/10000000; acc:  78.15; ppl:  2.57; xent: 0.94; lr: 0.00026; 3387/3752 tok/s;  67810 sec
[2019-09-09 03:20:07,503 INFO] Step 65600/10000000; acc:  78.64; ppl:  2.54; xent: 0.93; lr: 0.00026; 3241/3702 tok/s;  67858 sec
[2019-09-09 03:20:55,625 INFO] Step 65650/10000000; acc:  78.27; ppl:  2.58; xent: 0.95; lr: 0.00026; 3337/3788 tok/s;  67907 sec
[2019-09-09 03:21:44,343 INFO] Step 65700/10000000; acc:  79.68; ppl:  2.43; xent: 0.89; lr: 0.00026; 3144/3725 tok/s;  67955 sec
[2019-09-09 03:22:31,528 INFO] Step 65750/10000000; acc:  78.72; ppl:  2.52; xent: 0.92; lr: 0.00026; 3312/3752 tok/s;  68003 sec
[2019-09-09 03:23:18,977 INFO] Step 65800/10000000; acc:  78.13; ppl:  2.59; xent: 0.95; lr: 0.00026; 3314/3657 tok/s;  68050 sec
[2019-09-09 03:24:07,234 INFO] Step 65850/10000000; acc:  78.78; ppl:  2.52; xent: 0.92; lr: 0.00026; 3286/3677 tok/s;  68098 sec
[2019-09-09 03:24:56,152 INFO] Step 65900/10000000; acc:  78.58; ppl:  2.53; xent: 0.93; lr: 0.00026; 3201/3771 tok/s;  68147 sec
[2019-09-09 03:25:44,403 INFO] Step 65950/10000000; acc:  78.25; ppl:  2.56; xent: 0.94; lr: 0.00026; 3316/3708 tok/s;  68195 sec
[2019-09-09 03:26:33,547 INFO] Step 66000/10000000; acc:  78.82; ppl:  2.54; xent: 0.93; lr: 0.00026; 3084/3725 tok/s;  68245 sec
[2019-09-09 03:26:38,053 INFO] Saving checkpoint ./transformer_model_step_66000.pt
[2019-09-09 03:28:01,600 INFO] Step 66050/10000000; acc:  79.06; ppl:  2.48; xent: 0.91; lr: 0.00026; 1808/2079 tok/s;  68333 sec
[2019-09-09 03:28:49,926 INFO] Step 66100/10000000; acc:  77.68; ppl:  2.68; xent: 0.98; lr: 0.00026; 3191/3781 tok/s;  68381 sec
[2019-09-09 03:29:37,745 INFO] Step 66150/10000000; acc:  78.91; ppl:  2.49; xent: 0.91; lr: 0.00026; 3205/3736 tok/s;  68429 sec
[2019-09-09 03:30:25,527 INFO] Step 66200/10000000; acc:  77.67; ppl:  2.65; xent: 0.97; lr: 0.00026; 3295/3762 tok/s;  68477 sec
[2019-09-09 03:31:13,812 INFO] Step 66250/10000000; acc:  78.07; ppl:  2.56; xent: 0.94; lr: 0.00026; 3378/3670 tok/s;  68525 sec
[2019-09-09 03:32:02,465 INFO] Step 66300/10000000; acc:  78.43; ppl:  2.55; xent: 0.93; lr: 0.00026; 3182/3685 tok/s;  68573 sec
[2019-09-09 03:32:51,338 INFO] Step 66350/10000000; acc:  79.01; ppl:  2.49; xent: 0.91; lr: 0.00026; 3203/3816 tok/s;  68622 sec
[2019-09-09 03:33:39,476 INFO] Step 66400/10000000; acc:  79.09; ppl:  2.47; xent: 0.90; lr: 0.00026; 3277/3732 tok/s;  68670 sec
[2019-09-09 03:34:27,357 INFO] Step 66450/10000000; acc:  79.47; ppl:  2.49; xent: 0.91; lr: 0.00026; 3213/3649 tok/s;  68718 sec
[2019-09-09 03:35:15,706 INFO] Step 66500/10000000; acc:  78.81; ppl:  2.53; xent: 0.93; lr: 0.00026; 3316/3713 tok/s;  68767 sec
[2019-09-09 03:36:04,428 INFO] Step 66550/10000000; acc:  79.95; ppl:  2.41; xent: 0.88; lr: 0.00026; 3207/3693 tok/s;  68815 sec
[2019-09-09 03:36:16,385 INFO] Loading dataset from data/data.train.1.pt
[2019-09-09 03:36:36,818 INFO] number of examples: 805546
[2019-09-09 03:37:20,023 INFO] Step 66600/10000000; acc:  61.50; ppl:  5.50; xent: 1.70; lr: 0.00026; 2117/2395 tok/s;  68891 sec
[2019-09-09 03:38:08,546 INFO] Step 66650/10000000; acc:  55.66; ppl:  7.26; xent: 1.98; lr: 0.00026; 3248/3721 tok/s;  68940 sec
[2019-09-09 03:38:57,848 INFO] Step 66700/10000000; acc:  56.86; ppl:  6.59; xent: 1.89; lr: 0.00026; 3370/3751 tok/s;  68989 sec
[2019-09-09 03:39:47,302 INFO] Step 66750/10000000; acc:  56.07; ppl:  6.87; xent: 1.93; lr: 0.00026; 3241/3800 tok/s;  69038 sec
[2019-09-09 03:40:34,662 INFO] Step 66800/10000000; acc:  56.39; ppl:  6.77; xent: 1.91; lr: 0.00026; 3423/3749 tok/s;  69086 sec
[2019-09-09 03:41:22,840 INFO] Step 66850/10000000; acc:  56.15; ppl:  6.89; xent: 1.93; lr: 0.00026; 3283/3728 tok/s;  69134 sec
[2019-09-09 03:42:11,125 INFO] Step 66900/10000000; acc:  56.26; ppl:  6.71; xent: 1.90; lr: 0.00026; 3390/3784 tok/s;  69182 sec
[2019-09-09 03:42:59,650 INFO] Step 66950/10000000; acc:  56.37; ppl:  6.86; xent: 1.93; lr: 0.00026; 3277/3759 tok/s;  69231 sec
[2019-09-09 03:43:47,836 INFO] Step 67000/10000000; acc:  55.89; ppl:  6.94; xent: 1.94; lr: 0.00026; 3445/3749 tok/s;  69279 sec
[2019-09-09 03:43:52,338 INFO] Saving checkpoint ./transformer_model_step_67000.pt
[2019-09-09 03:45:12,448 INFO] Step 67050/10000000; acc:  58.19; ppl:  6.35; xent: 1.85; lr: 0.00026; 1788/2153 tok/s;  69363 sec
[2019-09-09 03:46:01,084 INFO] Step 67100/10000000; acc:  55.78; ppl:  6.84; xent: 1.92; lr: 0.00026; 3377/3751 tok/s;  69412 sec
[2019-09-09 03:46:49,507 INFO] Step 67150/10000000; acc:  56.34; ppl:  6.69; xent: 1.90; lr: 0.00026; 3438/3754 tok/s;  69460 sec
[2019-09-09 03:47:37,619 INFO] Step 67200/10000000; acc:  56.26; ppl:  6.83; xent: 1.92; lr: 0.00026; 3311/3739 tok/s;  69509 sec
[2019-09-09 03:48:26,657 INFO] Step 67250/10000000; acc:  56.50; ppl:  6.65; xent: 1.89; lr: 0.00026; 3347/3703 tok/s;  69558 sec
[2019-09-09 03:49:14,875 INFO] Step 67300/10000000; acc:  57.12; ppl:  6.45; xent: 1.86; lr: 0.00026; 3270/3795 tok/s;  69606 sec
[2019-09-09 03:50:04,014 INFO] Step 67350/10000000; acc:  55.97; ppl:  6.64; xent: 1.89; lr: 0.00026; 3343/3708 tok/s;  69655 sec
[2019-09-09 03:50:51,580 INFO] Step 67400/10000000; acc:  57.65; ppl:  6.37; xent: 1.85; lr: 0.00026; 3252/3686 tok/s;  69703 sec
[2019-09-09 03:51:40,515 INFO] Step 67450/10000000; acc:  56.33; ppl:  6.70; xent: 1.90; lr: 0.00026; 3238/3726 tok/s;  69751 sec
[2019-09-09 03:52:29,183 INFO] Step 67500/10000000; acc:  57.01; ppl:  6.53; xent: 1.88; lr: 0.00026; 3280/3813 tok/s;  69800 sec
[2019-09-09 03:53:18,094 INFO] Step 67550/10000000; acc:  56.07; ppl:  6.72; xent: 1.90; lr: 0.00026; 3277/3764 tok/s;  69849 sec
[2019-09-09 03:54:06,427 INFO] Step 67600/10000000; acc:  57.10; ppl:  6.49; xent: 1.87; lr: 0.00026; 3373/3724 tok/s;  69897 sec
[2019-09-09 03:54:55,455 INFO] Step 67650/10000000; acc:  56.77; ppl:  6.34; xent: 1.85; lr: 0.00026; 3341/3767 tok/s;  69946 sec
[2019-09-09 03:55:44,985 INFO] Step 67700/10000000; acc:  56.61; ppl:  6.53; xent: 1.88; lr: 0.00026; 3285/3749 tok/s;  69996 sec
[2019-09-09 03:56:35,894 INFO] Step 67750/10000000; acc:  56.29; ppl:  6.66; xent: 1.90; lr: 0.00026; 3138/3528 tok/s;  70047 sec
[2019-09-09 03:57:24,207 INFO] Step 67800/10000000; acc:  57.18; ppl:  6.35; xent: 1.85; lr: 0.00026; 3320/3739 tok/s;  70095 sec




^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A                                         [2019-09-09 03:58:13,023 INFO] Step 67850/10000000; acc:  57.39; ppl:  6.20; xent: 1.82; lr: 0.00027; 3297/3839 tok/s;  70144 sec
[2019-09-09 03:59:01,506 INFO] Step 67900/10000000; acc:  56.18; ppl:  6.64; xent: 1.89; lr: 0.00027; 3364/3724 tok/s;  70192 sec
[2019-09-09 03:59:48,495 INFO] Step 67950/10000000; acc:  57.75; ppl:  6.39; xent: 1.85; lr: 0.00027; 3293/3740 tok/s;  70239 sec
[2019-09-09 04:00:37,240 INFO] Step 68000/10000000; acc:  57.66; ppl:  6.18; xent: 1.82; lr: 0.00027; 3402/3721 tok/s;  70288 sec
[2019-09-09 04:00:41,732 INFO] Saving checkpoint ./transformer_model_step_68000.pt
[2019-09-09 04:02:03,307 INFO] Step 68050/10000000; acc:  56.80; ppl:  6.38; xent: 1.85; lr: 0.00027; 1881/2103 tok/s;  70374 sec
[2019-09-09 04:02:51,640 INFO] Step 68100/10000000; acc:  57.64; ppl:  6.26; xent: 1.83; lr: 0.00027; 3278/3731 tok/s;  70423 sec
[2019-09-09 04:03:40,009 INFO] Step 68150/10000000; acc:  57.22; ppl:  6.31; xent: 1.84; lr: 0.00027; 3398/3739 tok/s;  70471 sec
[2019-09-09 04:04:29,335 INFO] Step 68200/10000000; acc:  56.54; ppl:  6.46; xent: 1.87; lr: 0.00027; 3237/3771 tok/s;  70520 sec
[2019-09-09 04:05:18,447 INFO] Step 68250/10000000; acc:  57.02; ppl:  6.29; xent: 1.84; lr: 0.00027; 3418/3778 tok/s;  70569 sec
[2019-09-09 04:06:07,531 INFO] Step 68300/10000000; acc:  57.23; ppl:  6.34; xent: 1.85; lr: 0.00027; 3285/3827 tok/s;  70619 sec
[2019-09-09 04:06:56,418 INFO] Step 68350/10000000; acc:  56.18; ppl:  6.55; xent: 1.88; lr: 0.00027; 3307/3698 tok/s;  70667 sec
[2019-09-09 04:07:46,112 INFO] Step 68400/10000000; acc:  58.04; ppl:  6.01; xent: 1.79; lr: 0.00027; 3236/3766 tok/s;  70717 sec
[2019-09-09 04:08:35,092 INFO] Step 68450/10000000; acc:  56.97; ppl:  6.42; xent: 1.86; lr: 0.00027; 3280/3790 tok/s;  70766 sec
[2019-09-09 04:09:23,001 INFO] Step 68500/10000000; acc:  57.29; ppl:  6.26; xent: 1.83; lr: 0.00027; 3405/3721 tok/s;  70814 sec
[2019-09-09 04:10:11,882 INFO] Step 68550/10000000; acc:  56.81; ppl:  6.49; xent: 1.87; lr: 0.00027; 3175/3686 tok/s;  70863 sec
[2019-09-09 04:10:59,557 INFO] Step 68600/10000000; acc:  57.51; ppl:  6.29; xent: 1.84; lr: 0.00027; 3312/3634 tok/s;  70911 sec
[2019-09-09 04:11:48,402 INFO] Step 68650/10000000; acc:  57.75; ppl:  6.13; xent: 1.81; lr: 0.00027; 3247/3785 tok/s;  70959 sec
[2019-09-09 04:12:37,088 INFO] Step 68700/10000000; acc:  57.45; ppl:  6.17; xent: 1.82; lr: 0.00027; 3310/3744 tok/s;  71008 sec
[2019-09-09 04:13:24,601 INFO] Step 68750/10000000; acc:  57.69; ppl:  6.21; xent: 1.83; lr: 0.00027; 3397/3758 tok/s;  71056 sec
[2019-09-09 04:14:12,528 INFO] Step 68800/10000000; acc:  57.56; ppl:  6.23; xent: 1.83; lr: 0.00027; 3223/3792 tok/s;  71104 sec
[2019-09-09 04:15:01,009 INFO] Step 68850/10000000; acc:  56.92; ppl:  6.39; xent: 1.85; lr: 0.00027; 3267/3672 tok/s;  71152 sec
[2019-09-09 04:15:51,285 INFO] Step 68900/10000000; acc:  57.40; ppl:  6.07; xent: 1.80; lr: 0.00027; 3284/3730 tok/s;  71202 sec
[2019-09-09 04:16:39,876 INFO] Step 68950/10000000; acc:  57.70; ppl:  6.16; xent: 1.82; lr: 0.00027; 3273/3697 tok/s;  71251 sec
[2019-09-09 04:17:28,577 INFO] Step 69000/10000000; acc:  56.65; ppl:  6.31; xent: 1.84; lr: 0.00027; 3265/3651 tok/s;  71300 sec
[2019-09-09 04:17:33,050 INFO] Saving checkpoint ./transformer_model_step_69000.pt
[2019-09-09 04:18:53,628 INFO] Step 69050/10000000; acc:  58.41; ppl:  6.03; xent: 1.80; lr: 0.00027; 1819/2116 tok/s;  71385 sec
[2019-09-09 04:19:42,256 INFO] Step 69100/10000000; acc:  57.18; ppl:  6.23; xent: 1.83; lr: 0.00027; 3295/3629 tok/s;  71433 sec
[2019-09-09 04:20:31,690 INFO] Step 69150/10000000; acc:  57.06; ppl:  6.20; xent: 1.83; lr: 0.00027; 3289/3665 tok/s;  71483 sec
[2019-09-09 04:21:20,561 INFO] Step 69200/10000000; acc:  57.88; ppl:  6.05; xent: 1.80; lr: 0.00027; 3242/3694 tok/s;  71532 sec
[2019-09-09 04:22:08,569 INFO] Step 69250/10000000; acc:  57.47; ppl:  6.25; xent: 1.83; lr: 0.00027; 3256/3649 tok/s;  71580 sec
[2019-09-09 04:22:57,164 INFO] Step 69300/10000000; acc:  57.92; ppl:  6.10; xent: 1.81; lr: 0.00027; 3337/3704 tok/s;  71628 sec
[2019-09-09 04:23:46,171 INFO] Step 69350/10000000; acc:  58.31; ppl:  6.00; xent: 1.79; lr: 0.00027; 3149/3723 tok/s;  71677 sec
[2019-09-09 04:24:34,477 INFO] Step 69400/10000000; acc:  57.41; ppl:  6.18; xent: 1.82; lr: 0.00027; 3357/3685 tok/s;  71725 sec
[2019-09-09 04:25:23,816 INFO] Step 69450/10000000; acc:  56.78; ppl:  6.36; xent: 1.85; lr: 0.00027; 3162/3654 tok/s;  71775 sec
[2019-09-09 04:25:32,803 INFO] Loading dataset from data/data.train.0.pt
[2019-09-09 04:26:00,118 INFO] number of examples: 947346
[2019-09-09 04:26:44,969 INFO] Step 69500/10000000; acc:  69.26; ppl:  3.78; xent: 1.33; lr: 0.00027; 1952/2197 tok/s;  71856 sec
[2019-09-09 04:27:33,198 INFO] Step 69550/10000000; acc:  74.07; ppl:  3.12; xent: 1.14; lr: 0.00027; 3250/3719 tok/s;  71904 sec
[2019-09-09 04:28:21,228 INFO] Step 69600/10000000; acc:  74.65; ppl:  3.04; xent: 1.11; lr: 0.00027; 3399/3662 tok/s;  71952 sec
[2019-09-09 04:29:09,607 INFO] Step 69650/10000000; acc:  75.41; ppl:  2.94; xent: 1.08; lr: 0.00027; 3272/3715 tok/s;  72001 sec
[2019-09-09 04:29:58,299 INFO] Step 69700/10000000; acc:  75.56; ppl:  2.96; xent: 1.09; lr: 0.00027; 3193/3749 tok/s;  72049 sec
[2019-09-09 04:30:47,187 INFO] Step 69750/10000000; acc:  76.42; ppl:  2.80; xent: 1.03; lr: 0.00027; 3274/3718 tok/s;  72098 sec
[2019-09-09 04:31:35,148 INFO] Step 69800/10000000; acc:  76.41; ppl:  2.80; xent: 1.03; lr: 0.00027; 3380/3706 tok/s;  72146 sec
[2019-09-09 04:32:22,376 INFO] Step 69850/10000000; acc:  76.99; ppl:  2.72; xent: 1.00; lr: 0.00027; 3323/3691 tok/s;  72193 sec
[2019-09-09 04:33:11,407 INFO] Step 69900/10000000; acc:  76.29; ppl:  2.80; xent: 1.03; lr: 0.00027; 3285/3786 tok/s;  72242 sec
[2019-09-09 04:33:59,718 INFO] Step 69950/10000000; acc:  76.77; ppl:  2.78; xent: 1.02; lr: 0.00027; 3151/3747 tok/s;  72291 sec
[2019-09-09 04:34:47,365 INFO] Step 70000/10000000; acc:  76.49; ppl:  2.79; xent: 1.03; lr: 0.00027; 3239/3767 tok/s;  72338 sec
[2019-09-09 04:34:47,367 INFO] Loading dataset from data/data.valid.0.pt
[2019-09-09 04:34:49,080 INFO] number of examples: 100000
[2019-09-09 04:42:12,399 INFO] Validation perplexity: 7.17606
[2019-09-09 04:42:12,399 INFO] Validation accuracy: 59.1494
[2019-09-09 04:42:16,836 INFO] Saving checkpoint ./transformer_model_step_70000.pt
[2019-09-09 04:43:17,023 INFO] Step 70050/10000000; acc:  77.30; ppl:  2.70; xent: 0.99; lr: 0.00027; 304/351 tok/s;  72848 sec
[2019-09-09 04:44:06,174 INFO] Step 70100/10000000; acc:  77.25; ppl:  2.70; xent: 0.99; lr: 0.00027; 3045/3754 tok/s;  72897 sec
[2019-09-09 04:44:54,566 INFO] Step 70150/10000000; acc:  78.04; ppl:  2.59; xent: 0.95; lr: 0.00027; 3332/3741 tok/s;  72946 sec
[2019-09-09 04:45:42,058 INFO] Step 70200/10000000; acc:  77.45; ppl:  2.67; xent: 0.98; lr: 0.00027; 3252/3744 tok/s;  72993 sec
[2019-09-09 04:46:30,858 INFO] Step 70250/10000000; acc:  77.80; ppl:  2.63; xent: 0.97; lr: 0.00027; 3272/3749 tok/s;  73042 sec
[2019-09-09 04:47:18,586 INFO] Step 70300/10000000; acc:  77.28; ppl:  2.70; xent: 0.99; lr: 0.00027; 3275/3788 tok/s;  73090 sec
[2019-09-09 04:48:07,556 INFO] Step 70350/10000000; acc:  78.09; ppl:  2.59; xent: 0.95; lr: 0.00027; 3310/3724 tok/s;  73139 sec
[2019-09-09 04:48:55,702 INFO] Step 70400/10000000; acc:  77.90; ppl:  2.61; xent: 0.96; lr: 0.00028; 3225/3729 tok/s;  73187 sec
[2019-09-09 04:49:44,024 INFO] Step 70450/10000000; acc:  78.24; ppl:  2.59; xent: 0.95; lr: 0.00028; 3275/3654 tok/s;  73235 sec
[2019-09-09 04:50:32,400 INFO] Step 70500/10000000; acc:  77.75; ppl:  2.63; xent: 0.97; lr: 0.00028; 3273/3743 tok/s;  73283 sec
[2019-09-09 04:51:19,323 INFO] Step 70550/10000000; acc:  76.51; ppl:  2.78; xent: 1.02; lr: 0.00028; 3340/3763 tok/s;  73330 sec
[2019-09-09 04:52:07,860 INFO] Step 70600/10000000; acc:  78.97; ppl:  2.50; xent: 0.92; lr: 0.00028; 3264/3738 tok/s;  73379 sec
[2019-09-09 04:52:59,389 INFO] Step 70650/10000000; acc:  80.29; ppl:  2.37; xent: 0.86; lr: 0.00028; 3081/3507 tok/s;  73430 sec
[2019-09-09 04:53:47,876 INFO] Step 70700/10000000; acc:  78.29; ppl:  2.57; xent: 0.94; lr: 0.00028; 3227/3766 tok/s;  73479 sec
[2019-09-09 04:54:35,639 INFO] Step 70750/10000000; acc:  78.19; ppl:  2.58; xent: 0.95; lr: 0.00028; 3264/3697 tok/s;  73527 sec
[2019-09-09 04:55:24,300 INFO] Step 70800/10000000; acc:  79.12; ppl:  2.47; xent: 0.90; lr: 0.00028; 3184/3754 tok/s;  73575 sec
[2019-09-09 04:56:12,576 INFO] Step 70850/10000000; acc:  78.15; ppl:  2.56; xent: 0.94; lr: 0.00028; 3382/3705 tok/s;  73624 sec
[2019-09-09 04:57:01,089 INFO] Step 70900/10000000; acc:  78.31; ppl:  2.54; xent: 0.93; lr: 0.00028; 3338/3767 tok/s;  73672 sec
^CTraceback (most recent call last):
  File "train.py", line 200, in <module>
    main(opt)
  File "train.py", line 86, in main
    single_main(opt, 0)
  File "/home/srijans/.train/onmt/train_single.py", line 143, in main
    valid_steps=opt.valid_steps)
  File "/home/srijans/.train/onmt/trainer.py", line 243, in train
    report_stats)
  File "/home/srijans/.train/onmt/trainer.py", line 369, in _gradient_accumulation
    trunc_size=trunc_size)
  File "/home/srijans/.train/onmt/utils/loss.py", line 164, in __call__
    for shard in shards(shard_state, shard_size):
  File "/home/srijans/.train/onmt/utils/loss.py", line 338, in shards
    torch.autograd.backward(inputs, grads)
  File "/home/srijans/env/lib/python3.5/site-packages/torch/autograd/__init__.py", line 93, in backward
    allow_unreachable=True)  # allow_unreachable flag
KeyboardInterrupt
^C^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A
(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~/.train[00m$ python  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -accum_count 2          -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorrot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 1000         -world_size 1 -gpu_ranks 0  -valid_batch_size 8[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cls ../[K
[K
[K
[K
[K[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kcd .train/[12@mv screenlog.0[C[C[C[C[C[C[C[C[4P. env/bin/activatels[K transformer_model/[Kpython  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -accum_count 2          -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorrot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 1 -gpu_ranks 0  -valid_batch_size 16 -traiin_from ./transformer_model/[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C4096
[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_gloro[26Pt         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 2 -gpu_ranks 0 1
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[2P1 -gpu_ranks 0[20P[C[C[C[C[C[C[C[C[C[C[C[C[K         -world_size 4 -gpu_ranks 0 1 [K[A[A[C[C[C[C[C200000  -max_generator_batches 2 -dropout 0.1         -batch_size 4096 -batch_type tokens -normalization tokens  -accum_count 2         -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 8000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot [2P[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cscreen -ls[K
[K
[K
[K
[K[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cmkdir transformer_modells[Kpython preprocess.py -train_src data/src-train.txt -train_tgt data/tgt-train.txt -valid_src datta/src-valid.txt -valid_tgt data/tgt-valid.txt -save_data data/data[C[C[C[C[C[C[C[C[C[C[4P.txt -valid_tgt data/tgt-val[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Awc -l data/src-train.txt [K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cls data/[K[7@cp temp/*[C[C[C[C[C[C[2Prm data/*.txtgit checkout -- data/[2Pmv data/*.txt temp/git checkout -- data/[8Prm data/*.txtcp temp/* data/[7Pls[C[C[C[C[C[Cwc -l data/src-train.txt python preprocess.py -train_src data/src-train.txt -train_tgt data/tgt-train.txt -valid_src datta/src-val.txt -valid_tgt data/tgt-val.txt -save_data data/data[C[C[C[C[C[C[C[C[C[C[4@id.txt -valid_tgt data/tgt-valid[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Als[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cmkdir transformer_model[13Pscreen -lspython  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 200000  -max_generator_batches 2 -dropout 0.1         -batch_size 4096 -batch_type tokens -normalization tokens  -accum_count 2         -ooptim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 8000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot          -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 4 -gpu_ranks 0[A[A[C[C[C[C[C10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 4096 -batch_type tokens -normalization tokens  -accum_count 2         -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 8000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_gloro[2@t [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C 1 [K   -gpu_ranks 0[20@      -world_size 1 [C[C[C[C[C[C[C[C[C[C[C[C2 -gpu_ranks 0 1[A[A2048
[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C0 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 1 -gpu_ranks 0  -valid_batch_size 16 -traiin_from ./transformer_model/[A[A[A[A[A(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~/.train[00m$ ls[K
[K
[K
[K
[K
[K[A[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C transformer_model/[K. env/bin/activatemv screenlog.0 .train/[12Pcd[C[C[C[C[C[C[C[Cls[K ../python  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -accum_count 2          -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorrot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 1000         -world_size 1 -gpu_ranks 0  -valid_batch_size 8[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[K
[K
[K
[K
[K[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Apython  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -accum_count 2          -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorrot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 1000         -world_size 1 -gpu_ranks 0  -valid_batch_size 8[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cls ../[K
[K
[K
[K
[K[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kcd .train/[12@mv screenlog.0[C[C[C[C[C[C[C[C[4P. env/bin/activatels[K transformer_model/[Kpython  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -accum_count 2          -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorrot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 1 -gpu_ranks 0  -valid_batch_size 16 -traiin_from ./transformer_model/[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C4096
[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_gloro[26Pt         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 2 -gpu_ranks 0 1
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[2P1 -gpu_ranks 0[20P[C[C[C[C[C[C[C[C[C[C[C[C[K         -world_size 4 -gpu_ranks 0 1 [K[A[A[C[C[C[C[C200000  -max_generator_batches 2 -dropout 0.1         -batch_size 4096 -batch_type tokens -normalization tokens  -accum_count 2         -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 8000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot [2P[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cscreen -ls[K
[K
[K
[K
[K[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cpython  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 200000  -max_generator_batches 2 -dropout 0.1         -batch_size 4096 -batch_type tokens -normalization tokens  -accum_count 2         -ooptim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 8000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot          -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 4 -gpu_ranks 0[A[A[C[C[C[C[C10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 4096 -batch_type tokens -normalization tokens  -accum_count 2         -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 8000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_gloro[2@t [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C 1 [K   -gpu_ranks 0[20@      -world_size 1 [C[C[C[C[C[C[C[C[C[C[C[C2 -gpu_ranks 0 1[A[A2048
[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C0 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 10000         -world_size 1 -gpu_ranks 0  -valid_batch_size 16 -traiin_from ./transformer_model/[A[A[A[A[A(env) [01;32msrijans@abzuser-virtual-machine[00m:[01;34m~/.train[00m$ ls[K
[K
[K
[K
[K
[K[A[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C transformer_model/[K. env/bin/activatemv screenlog.0 .train/[12Pcd[C[C[C[C[C[C[C[Cls[K ../python  train.py -data data/data -save_model  ./transformer_model  -layers 6 -rnn_size 512 -worrd_vec_size 512 -transformer_ff 2048 -heads 8          -encoder_type transformer -decoder_type transformer -position_encoding         -train_stteps 10000000  -max_generator_batches 2 -dropout 0.1         -batch_size 2048 -batch_type tokens -normalization tokens  -accum_count 2          -optim adam -adam_beta2 0.998 -decay_method noam -warmup_steps 80000 -learning_rate 2         -max_grad_norm 0 -param_init 0  -param_init_glorrot         -label_smoothing 0.1 -valid_steps 10000 -save_checkpoint_steps 1000         -world_size 1 -gpu_ranks 0  -valid_batch_size 8[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[A[K
[K
[K
[K
[K[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C